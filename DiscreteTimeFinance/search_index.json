[[["index.html","Pt1.html"],"Lecture I 01/10/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 01/10/2024 Lecture I 01/10/2024 1. Single-Period Market Models Single period market models are the most elementary market models. The beginning of the period is usually denoted by the time t=0 and the end of the period by time t=1 . At time t=0 stock prices, bond prices,possibly prices of other financial assets or specific financial values are recorded and the financial agent can choose his investment, often a portfolio of stocks and bond. At time t=1 prices are recorded again and the financial agent obtains a payoff corresponding to the value of his portfolio at time t=1 . Single period models are unrealistic in a way, that in reality trading takes place over many periods, but they allow us to illustrate and understand many of the important economic and mathematical principles in Financial Mathematics without being mathematically to complex and challenging. We will later see, that more realistic multi period models can indeed be obtained by the concatenation of many single period models. Single period models are therefore the building blocks of more complicated models. Single period market models are the atoms of Financial Mathematics. Within this chapter, we assume that we have a finite sample space \\displaystyle\\boxed{\\Omega:=\\{\\omega_{1},\\omega_{2},...,\\omega_{k}\\}.} We think of the samples \\omega_{i} as possible states of the world at time t=1 . The prices of the financial assets we are modeling in a single period model, depend on the state of the world at time t=1 and therefore on the \\omega_{i} ’s. The exact state of world at time t=1 is unknown at time t=0 . We cannot foresee the future. We assume however that we are given information about the probabilities of the various states. More precisely we assume that we have a probability measure \\mathbb{P} on \\Omega with \\mathbb{P}(\\omega)>0 for all \\omega\\in\\Omega . This probability measure represents the beliefs of the agent. Different agents may have different beliefs and therefore different \\mathbb{P} ’s. However in the following we choose one agent who is in a way a representative agent. 1.1. The most elementary market model The most elementary but still interesting market model occurs when we assume that \\Omega contains only two states. We denote these two states by \\omega_{1}=H and \\omega_{2}=T . We think of the state at time t=1 as determined by the toss of a coin, which can result in Head or Tail, \\displaystyle\\boxed{\\Omega=\\{H,T\\}.} The result of the coin toss is not known at time t=0 and is therefore considered as random. We do not assume that the coin is a fair coin, i.e. that H and T have the same probability, but that there is a number 0<p<1 s.t. \\displaystyle\\boxed{\\mathbb{P}(H)=p,\\quad\\mathbb{P}(T)=1-p.} We consider a model, which consists of one stock and a money market account. If we speak of one stock, we actually mean one type of stock, for example Coca Cola, and agents can buy or sell arbitrary many shares of this stock. For the money market account we think of a savings account. The money market account pays a deterministic (non random) interest rate r>0 . This means that one pound invested into the money market account at time t=0 yields a return of 1+r pounds at time t=1 . The price of the stock at time t=0 is known and denoted by S_{0} . The price of the stock at time t=1 depends on the state of the world and can therefore take the two values S_{1}(H) and S_{1}(T) , depending whether the coin toss results in H or T . It is not known at time t=0 and therefore considered to be random. S_{1} is a random variable, taking the value S_{1}(H) with probability p and the value S_{1}(T) with probability 1-p . We define \\displaystyle\\boxed{u:=\\frac{S_{1}(H)}{S_{0}},d:=\\frac{S_{1}(T)}{S_{0}}.} We assume that 0<d<u . This means that the stock price can either go up or down, but in any case remains positive. The stock can then be represented by the following diagram: To complete our first market model we still need trading strategies. The agents in this model are allowed to invest in the money market account and the stock. We represent such an investment by a pair (x,\\phi) where x gives the total initial investment in pounds at time t=0 and \\phi denotes the numbers of shares bought at time t=0 . Given the investment strategy (x,\\phi) , the agent then invests the remaining money x-\\phi S_{0} in the money market account. We assume that \\phi can take any possible value, i.e. \\phi\\in\\mathbb{R} . This allows for example short selling as well as taking arbitrary high credits. At the end of this section we will give some remarks on the significance of these assumptions. The value of the investment strategy (x,\\phi) at time t=0 is clearly x , the initial investment. The agent has to pay x pounds in order to buy the trading strategy (x,\\phi) . Within the period, meaning between time t=0 and time t=1 the agent does nothing but waiting until time t=1 . The value of the trading strategy at time t=1 is given by its payoff. The payoff however depends on the value of the stock at time t=1 and is therefore random. In fact it can take two values: V(x,\\phi)(H)=(x-\\phi S_{0})(1+r)+\\phi S_{1}(H) if the coin toss results in H or V(x,\\phi)(T)=(x-\\phi S_{0})(1+r)+\\phi S_{1}(T) if the coin toss results in T . We combine these two equations in the following definition. Definition 1.1.1. The value process of the trading strategy (x,\\phi) in our elementary market model is given by (V_{0}(x,\\phi),V_{1}(x,\\phi)) where V_{0}(x,\\phi)=x and V_{1} is the random variable \\displaystyle\\boxed{V_{1}(x,\\phi)=(x-\\phi S_{0})(1+r)+\\phi S_{1}.} An essential feature of an efficient market is that if a trading strategy can turn nothing into something, then it must also run the risk of loss. Definition 1.1.2. An arbitrage is a trading strategy that begins with no money, has zero probability of losing money, and has a positive probability of making money. This definition is mathematically not precise. It does not refer to the specific model we are using, but it gives the basic idea of an arbitrage in words. A more mathematical definition is the following: Definition 1.1.3. A trading strategy (x,\\phi) in our elementary market model is called an arbitrage, if (1)​ x=V_{0}(x,\\phi)=0 (i.e. the trading strategy needs no initial investment) (2)​ V_{1}(x,\\phi)\\geq 0 (i.e. there is no risk of losing money) (3)​ \\mathbb{E}(V_{1}(x,\\phi))=pV_{1}(x,\\phi)(H)+(1-p)V_{1}(x,\\phi)(T)>0 (i.e. a strictly positive payoff is expected). A mathematical model that admits arbitrage cannot be used for analysis. Wealth can be generated from nothing in such a model. Real markets sometimes exhibit arbitrage, but this is necessarily fleeting; as soon as someone discovers it, trading takes actions that remove it. We say that a model is arbitrage free, if there is no arbitrage in the model. To rule out arbitrage in our elementary model we must assume that d<1+r<u , as we will see now: If d\\geq(1+r) , then the following strategy is an arbitrage: •​begin with zero wealth and at time zero borrow S_{0} from the money market in order to buy one share of the stock. Even in the worst case of a tail on the coin toss, i.e. S_{1}=S_{0}d , the stock at time one will be worth S_{0}d\\geq S_{0}(1+r) , enough to pay off the money market debt and the stock has a positive probability of being worth strictly more since u>d\\geq 1+r , i.e. S_{0}u>S_{0}(1+r) . If u\\leq 1+r , then the following strategy is an arbitrage: •​sell one share of the stock short and invest the proceeds S_{0} in the money market Even in the best case for the stock, i.e. S_{1}=S_{0}u the cost S_{1} of replacing it at time one will be less than or equal to the value S_{0}(1+r) of the money market investment, and since d<u\\leq 1+r , there is a positive probability that the cost of replacing the stock will be strictly less than the value of the money market investment. We have therefore shown: \\boxed{\\text{No arbitrage }\\Rightarrow d<1+r<u.} The converse is also true: \\boxed{d<1+r<u\\Rightarrow\\text{No arbitrage.}} The proof of this is left as an exercise. It will also follow from the coming discussion in Section 1.2. However, from this we get our first proposition: Proposition 1.1.4. The elementary single period market model discussed above is arbitrage free, if and only if d<1+r<u . Let us now introduce other financial assets into our elementary market model: Definition 1.1.5. A European call option is a contract which gives its buyer the right (but not the obligation) to buy a good at a future time T for a price K . The good, the maturity time T and the strike price K are specified in the contract. Definition 1.1.6. A European put option is a contract which gives its buyer the right (but not the obligation) to sell a good at a future time T for a price K . The good, the maturity time T and the strike price K are specified in the contract. We will consider such European options in all of our financial market models, which we are going to discuss in this lecture. European call and put options are frequently traded on financial markets. A central question will always be: What price should such a European call/put option have? Within our elementary market model we do not have too many choices. First, we assume that the good is the stock, and second that the maturity time is T=1 , the end of the period. This is the only nontrivial maturity time. The owner of a European call option can do the following: •​if the stock price S_{1} at time 1 is higher than K , buy the stock at time t=1 for the price K from the seller of the option and immediately sell it on the market for the market price S_{1} , leading to a profit of S_{1}-K . •​if the stock price at time 1 is lower than K , then it doesn’t make sense to buy the stock for the price K from the seller, if the agent can buy it for a cheaper price on the market. In this case the agent can also do simply nothing, leading to a payoff of 0 . This argumentation shows, that a European call option is equivalent to an asset which has a payoff at time T=1 of \\max(S_{1}-K,0). This payoff is what the option is worth at time t=1 . Still the question is, how much the option is worth at time t=0 ? We will answer this question in the remaining part of this section, by applying the replication principle. To do this, we consider a more general option, which is of the type h(S_{1}) , where h:\\mathbb{R}\\to\\mathbb{R} is a function. Please note that since S_{1} is random, h(S_{1}) is also random. The European call option from above, is then given by choosing the function h(x):=\\max(x-K,0) . (What function should be taken for a European put option?) There are many other possible choices for h leading to different options. We will discuss some of them in a later section. The replication principle says the following: Replication principle: If it is possible to find a trading strategy which perfectly replicates the option, meaning that the trading strategy guarantees exactly the same payoff as the option at maturity time, then the price of this trading strategy must coincide with the price of the option. What would it be, if the replication principle did not hold? Assume that the price of the option is higher than the price of a replicating strategy. Then, with zero initial investment, one could sell the option and buy the replicating strategy. Since one earns more from selling the option than paying for the replication strategy, one has a positive amount of money at hand at time t=0 . This money can then be used to invest into the savings account (or another riskless asset). At maturity, one may have to pay the obligation from the option, but the replicating strategy which one owns will pay exactly for this obligation. On the other hand, one obtains a strictly positive payoff at maturity time of the option from the money invested in the savings account. This is an arbitrage. If the price of the option were lower than the price of the replicating strategy then a similar strategy as above, where the option is bought and the replicating strategy is sold short would lead to an arbitrage. We therefore see that under the assumption that there is no arbitrage in the market the price of the replicating strategy is the only possible price for the option. Let us formulate these ideas more precisely in the elementary model. Definition 1.1.7. A replicating strategy or hedge for the option h(S_{1}) in the elementary single period market model is a trading strategy (x,\\phi) which satisfies V_{1}(x,\\phi)=h(S_{1}) , which is equivalent to \\displaystyle(x-\\phi S_{0})(1+r)+\\phi S_{1}(H) \\displaystyle= \\displaystyle h(S_{1}(H)), (1.1.1) \\displaystyle(x-\\phi S_{0})(1+r)+\\phi S_{1}(T) \\displaystyle= \\displaystyle h(S_{1}(T)). (1.1.2) The following proposition follows from the argumentation above: Proposition 1.1.8. Let h(S_{1}) be an option in the elementary single period market model, and let (x,\\phi) be a replicating strategy for h(S_{1}) , then x is the only price for the option at time t=0 which does not introduce arbitrage. Previous page Next page"],[["index.html","Pt10.html"],"Lecture X 03/12/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 03/12/2024 Lecture X 03/12/2024 3.5. The Capital Asset Pricing Model For the rest of this section we impose the following assumption: \\boxed{\\text{The market model is complete, i.e. there exists one risk neutral measure }\\mathbb{Q}.} We will also assume that \\mathbb{Q}\\neq\\mathbb{P} and denote by L the state price density L(\\omega)=\\frac{\\mathbb{Q}(\\omega)}{\\mathbb{P}(\\omega)}. In order to obtain a classical result, which is called the Capital Asset Pricing Model, we will translate the mean variance problem into an optimal portfolio problem which we can solve with the methods from Section 3.1. We will do it in two steps. Consider first the following problem: \\boxed{\\begin{split}\\text{minimise}\\quad&\\operatorname{Var}(V_{1})\\\\ \\text{subject to}\\quad&\\mathbb{E}(V_{1})=x(1+\\rho)\\\\ &V_{0}=x.\\end{split}} In this problem the constraints identify the set of all time t=1 values corresponding to trading strategies that can be implemented with a total initial investment of x and which have a mean of x(1+\\rho) . We claim that this problem is equivalent to the original minimum variance problem. In fact, \\hat{V}_{1} is a solution of the latter problem if and only if \\hat{R}=\\frac{(\\hat{V}_{1}-x)}{x} is a solution of the original mean variance problem. We leave the details as an exercise. Let us now introduce a new problem which under special choice of the parameter \\beta is equivalent to the previous one, but has the form of a standard optimal portfolio problem: \\boxed{\\begin{split}\\text{maximise}\\quad&\\mathbb{E}\\left(-\\frac{1}{2}V_{1}^{2}% +\\beta V_{1}\\right)\\\\ \\text{subject to}\\quad&V_{0}=x.\\end{split}} The function u(x)=-\\frac{1}{2}x^{2}+\\beta x is not a utility function in the strict sense as defined in Definition 3.1.1. However, its second derivative is clearly negative and the function is therefore concave. One can show that in this special case this is enough in order to make the methods discussed in Section 3.1 work. We have u^{\\prime}(x)=-x+\\beta and by coincidence I(x)=-x+\\beta as well. We solve equation (3.1.9) from Section 3.1 to obtain the value for the Lagrange multiplier: \\lambda=-\\frac{(x(1+r)-\\beta)(1+r))}{\\mathbb{E}_{\\mathbb{Q}}(L)}. Substituting this value into equation (3.1.8) we obtain the optimal wealth \\hat{V}_{1}=\\frac{\\beta}{\\mathbb{E}_{\\mathbb{Q}}(L)}\\big{(}\\mathbb{E}_{\\mathbb% {Q}}(L)-L\\big{)}+x(1+r)\\frac{L}{\\mathbb{E}_{\\mathbb{Q}}(L)}. (3.5.1) Then (there is no mistake, try to find all the differences) \\mathbb{E}(\\hat{V}_{1})=\\frac{\\beta}{\\mathbb{E}_{\\mathbb{Q}}(L)}\\big{(}\\mathbb% {E}_{\\mathbb{Q}}(L)-1\\big{)}+x(1+r)\\frac{1}{\\mathbb{E}_{\\mathbb{Q}}(L)}. (3.5.2) We now want this optimal wealth to satisfy the first constraint of the first, i.e. \\mathbb{E}(\\hat{V}_{1})=x(1+\\rho). (3.5.3) Using (3.5.2) this translates into \\frac{\\beta}{\\mathbb{E}_{\\mathbb{Q}}(L)}\\big{(}\\mathbb{E}_{\\mathbb{Q}}(L)-1% \\big{)}+x(1+r)\\frac{1}{\\mathbb{E}_{\\mathbb{Q}}(L)}=x(1+\\rho). Since by our assumptions \\mathbb{Q}\\neq\\mathbb{P} , we have \\mathbb{E}_{\\mathbb{Q}}L>1 (this is also left as an exercise). Solving the above equation for \\beta gives \\beta=\\frac{x[(1+\\rho)\\mathbb{E}_{\\mathbb{Q}}(L)-(1+r)]}{\\mathbb{E}_{\\mathbb{Q% }}(L)-1}. (3.5.4) With this choice of \\beta the solution \\hat{V}_{1} of the second problem satisfies the constraints in the first problem. We will now show that it is in fact a solution of the first problem. If V_{1} is any other random variable which satisfies the constraints in the first problem then in particular \\mathbb{E}(V_{1})=x(1+\\rho)=\\mathbb{E}(\\hat{V}_{1}) and therefore \\mathbb{E}\\left(-\\frac{1}{2}\\hat{V}_{1}^{2}+\\beta\\hat{V}_{1}\\right)\\geq\\mathbb% {E}\\left(-\\frac{1}{2}V^{2}_{1}+\\beta V_{1}\\right). It is equivalent to \\mathbb{E}\\left(\\frac{1}{2}\\hat{V}^{2}_{1}\\right)\\leq\\mathbb{E}\\left(\\frac{1}{% 2}V^{2}_{1}\\right) and, consequently, to Var(\\hat{V}_{1})\\leq Var(V_{1}). On the other hand, reversing the argument above, we can see that a solution of this probem is also a solution of of the original problem. These two problems are therefore equivalent, provided \\beta and \\rho are related by equation (3.5.4). Now we come to the most complicated part of this section leading to the famous results of CAPM. Substituting \\beta from equation (3.5.4) into equation (3.5.1) gives \\displaystyle\\hat{V}_{1} \\displaystyle= \\displaystyle\\frac{x[(1+\\rho)\\mathbb{E}_{\\mathbb{Q}}(L)-(1+r)]}{(\\mathbb{E}_{% \\mathbb{Q}}(L)-1)\\mathbb{E}_{\\mathbb{Q}}(L)}(\\mathbb{E}_{\\mathbb{Q}}(L)-L)+x(1% +r)\\frac{L}{\\mathbb{E}_{\\mathbb{Q}}(L)} \\displaystyle= \\displaystyle\\left(\\frac{x(1+r)}{\\mathbb{E}_{\\mathbb{Q}}(L)-1}+\\frac{x(\\rho-r)% }{\\mathbb{E}_{\\mathbb{Q}}(L)-1}-\\frac{x(1+r)}{\\mathbb{E}_{\\mathbb{Q}}(L)(% \\mathbb{E}_{\\mathbb{Q}}(L)-1)}\\right)(\\mathbb{E}_{\\mathbb{Q}}(L)-L) \\displaystyle+\\,x(1+r)\\frac{L}{\\mathbb{E}_{\\mathbb{Q}}(L)} \\displaystyle= \\displaystyle\\left(\\frac{x(1+r)\\mathbb{E}_{\\mathbb{Q}}(L)-x(1+r)}{\\mathbb{E}_{% \\mathbb{Q}}(L)(\\mathbb{E}_{\\mathbb{Q}}(L)-1)}+\\frac{x(\\rho-r)}{\\mathbb{E}_{% \\mathbb{Q}}(L)-1}\\right)(\\mathbb{E}_{\\mathbb{Q}}(L)-L) \\displaystyle+\\,x(1+r)\\frac{L}{\\mathbb{E}_{\\mathbb{Q}}(L)} \\displaystyle= \\displaystyle\\left(\\frac{x(1+r)}{\\mathbb{E}_{\\mathbb{Q}}(L)}+\\frac{x(\\rho-r)}{% \\mathbb{E}_{\\mathbb{Q}}(L)-1}\\right)(\\mathbb{E}_{\\mathbb{Q}}(L)-L)+x(1+r)\\frac% {L}{\\mathbb{E}_{\\mathbb{Q}}(L)} \\displaystyle= \\displaystyle x(1+r)-\\frac{x(1+r)L}{\\mathbb{E}_{\\mathbb{Q}}(L)}+\\frac{x(\\rho-r% )}{\\mathbb{E}_{\\mathbb{Q}}(L)-1}(\\mathbb{E}_{\\mathbb{Q}}(L)-L)+\\frac{x(1+r)L}{% \\mathbb{E}_{\\mathbb{Q}}(L)} \\displaystyle= \\displaystyle x(1+r)+\\frac{x(\\rho-r)}{\\mathbb{E}_{\\mathbb{Q}}(L)-1}(\\mathbb{E}% _{\\mathbb{Q}}(L)-L). The equivalence of the first problem and the Markowitz problem implies \\displaystyle\\hat{R} \\displaystyle= \\displaystyle\\frac{\\hat{V}_{1}-x}{x}=r+\\frac{x(\\rho-r)}{\\mathbb{E}_{\\mathbb{Q}% }(L)-1}(\\mathbb{E}_{\\mathbb{Q}}(L)-L) \\displaystyle= \\displaystyle\\frac{r(\\mathbb{E}_{\\mathbb{Q}}(L)-1)}{\\mathbb{E}_{\\mathbb{Q}}(L)% -1}+\\frac{\\rho\\mathbb{E}_{\\mathbb{Q}}(L)-r\\mathbb{E}_{\\mathbb{Q}}(L)}{\\mathbb{% E}_{\\mathbb{Q}}(L)-1}-\\frac{\\rho-r}{\\mathbb{E}_{\\mathbb{Q}}(L)-1}L \\displaystyle= \\displaystyle\\frac{\\rho\\mathbb{E}_{\\mathbb{Q}}(L)-r}{\\mathbb{E}_{\\mathbb{Q}}(L% )-1}-\\frac{\\rho-r}{\\mathbb{E}_{\\mathbb{Q}}(L)-1}L. We have therefore proved the following proposition: Proposition 3.5.1. Let \\hat{R} be the return of a trading strategy which has the minimum variance among all other portfolios with expected returns equal to \\rho . Then \\boxed{\\begin{split}\\hat{R}&=&\\frac{\\rho\\mathbb{E}_{\\mathbb{Q}}(L)-r}{\\mathbb{% E}_{\\mathbb{Q}}(L)-1}-\\frac{\\rho-r}{\\mathbb{E}_{\\mathbb{Q}}(L)-1}L.\\end{split}} The interesting point in the last proposition is that the solution \\hat{R} of the mean variance problem is an affine function of the state price density. Recall now the formula (3.2.4) from the preciding section which states a relationship between the expected return of such an affine function and an arbitrary return. Clearly the solution \\hat{R} of the mean variance problem is attainable and we therefore have proved the following theorem, which is a main result in the Capital Asset Pricing Model (CAPM): Theorem 3.5.2. (CAPM) If \\hat{R} is a solution to the mean variance problem (Problem 1) for \\rho\\geq r and if R is the return corresponding to an arbitrary trading strategy, then \\boxed{\\mathbb{E}(R)-r=\\frac{Cov(R,\\hat{R})}{var(\\hat{R})}(\\mathbb{E}(\\hat{R})% -r).} Proof. The proof of Theorem 1.4.1 follows directly from the discussion above and formula (3.2.4). ∎ Pricing So far it is not clear why the CAPM is referred to as a pricing model. Assume we have a contingent claim X with the maturity time t=1 for which we want to compute a price x at time t=0 . The return of the contingent claim is R=\\frac{X-x}{x}. Substituting this into the equation of Theorem 3.5.2 gives \\frac{\\mathbb{E}(X)-x}{x}-r=\\frac{Cov(X,\\hat{R})}{x\\cdot Var(\\hat{R})}(\\mathbb% {E}(\\hat{R})-r) Solving for x gives \\boxed{\\displaystyle x=\\frac{\\mathbb{E}(X)-\\frac{Cov(X,\\hat{R})}{Var(\\hat{R})}% (\\mathbb{E}(\\hat{R})-r)}{1+r}.} How does this pricing formula relate to the one we developed in the previous section? Prices computed using the capital asset pricing model are in general not arbitrage free prices. The prices include the subjective probability measures \\mathbb{P} , which is a handicap, since this measure is in general neither known, nor can it be computed. It is also unrealistic to assume that all agents have the same subjective probabilities and that all agents are mean-variance minimisers. We should however see it as a complement or alternative to the methods discussed in the previous section. Previous page Next page"],[["index.html","Pt2.html"],"Lecture II 08/10/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 08/10/2024 Lecture II 08/10/2024 One way to find a price for an option is therefore to look for a replicating strategy and take the initial investment for this replicating strategy as the price. How to find the replicating strategy and does it always exist? Equations (\\ref{eqn01:1}) and (\\ref{eqn01:2}) represent a system of two linear equations with two unknown variables x and \\phi . If we manage to solve it, the result will be the sougth for replicating strategy. Solving for \\phi is easy. We subtract (\\ref{eqn01:2}) from (\\ref{eqn01:1}) and obtain \\phi=\\frac{h(S_{1}(H))-h(S_{1}(T))}{S_{1}(H)-S_{1}(T)}. (1.1.3) We can now substitute this value for \\phi and solve for x . The formula (1.1.3) is often called the Delta hedging formula. Although we have computed the replicating strategy, we would like to take an opportunity to introduce in this simple setting a method that is suitable for more complicated models. We will use this new method often when dealing with more than two states of the market. Let us rewrite equations (\\ref{eqn01:1}) and (\\ref{eqn01:2}) in a different form: \\displaystyle x+\\phi\\left(\\frac{1}{1+r}S_{1}(H)-S_{0}\\right) \\displaystyle= \\displaystyle\\frac{1}{1+r}h(S_{1}(H)), (1.1.4) \\displaystyle x+\\phi\\left(\\frac{1}{1+r}S_{1}(T)-S_{0}\\right) \\displaystyle= \\displaystyle\\frac{1}{1+r}h(S_{1}(T)). (1.1.5) Now we define \\tilde{p}:=\\frac{1+r-d}{u-d}. (1.1.6) It follows from the assumption d<1+r<u that 0<\\tilde{p}<1 . We have \\displaystyle 1-\\tilde{p} \\displaystyle= \\displaystyle 1-\\frac{1+r-d}{u-d} \\displaystyle= \\displaystyle\\frac{u-d-(1+r-d)}{u-d} \\displaystyle= \\displaystyle\\frac{u-1-r}{u-d}. For this choice of \\tilde{p} we have \\displaystyle\\frac{1}{1+r}\\left(\\tilde{p}S_{1}(H)+(1-\\tilde{p})S_{1}(T)\\right) \\displaystyle= \\displaystyle\\frac{\\frac{1+r-d}{u-d}S_{0}u+\\frac{u-1-r}{u-d}S_{0}d}{1+r} \\displaystyle= \\displaystyle S_{0}\\frac{(1+r-d)u+(u-(1+r))d)}{(u-d)(1+r)} \\displaystyle= \\displaystyle S_{0}. Let us multiply equation (\\ref{eqn01:4}) by \\tilde{p} and equation (\\ref{eqn01:5}) by 1-\\tilde{p} . By adding them we obtain x+\\phi\\Big{(}\\frac{1}{1+r}\\big{(}\\tilde{p}S_{1}(H)+(1-\\tilde{p})S_{1}(T)\\big{)% }-S_{0}\\Big{)}=\\frac{1}{1+r}\\Big{(}\\tilde{p}\\,h\\big{(}S_{1}(H)\\big{)}+(1-% \\tilde{p})h\\big{(}S_{1}(T)\\big{)}\\Big{)}, which by the choice of \\tilde{p} and the equation above is equivalent to \\boxed{x=\\frac{1}{1+r}\\Big{(}\\tilde{p}\\,h\\big{(}S_{1}(H)\\big{)}+(1-\\tilde{p})h% \\big{(}S_{1}(T)\\big{)}\\Big{)}.} (1.1.7) Either from (1.1.3) or from (1.1.7) we see that under the condition u>d (we assumed it at the very beginning) we can always find a replicating strategy for an option in our elementary single period market model. Models which have this property are called complete. We will soon see, that there are also models which are not complete and where the technique of pricing by the replication principle does not work. It is interesting to note, that the price x for the option computed above, does not depend on the probabilities p and 1-p . In particular it does not coincide with the discounted expectation of the payoff of the option using the probability measure \\mathbb{P} , i.e. in general x\\neq\\mathbb{E}_{\\mathbb{P}}\\left(\\frac{1}{1+r}h(S_{T})\\right)=\\frac{1}{1+r}% \\Big{(}p\\,h\\big{(}S_{1}(H)\\big{)}+(1-p)h\\big{(}S_{1}(T)\\big{)}\\Big{)}. The latter equation is only true if p=\\tilde{p} and hence also 1-p=1-\\tilde{p} , or if h(S_{1}(H))=h(S_{1}(T)) i.e. the payoff of the option is deterministic (non random). This however is hardly the case in reality. On the other hand, if we define another measure \\tilde{\\mathbb{P}} on the underlying probability space \\Omega=\\{H,T\\} by \\tilde{\\mathbb{P}}(H)=\\tilde{p},\\tilde{\\mathbb{P}}(T)=1-\\tilde{p} then by taking expectations under the measure \\tilde{\\mathbb{P}} instead of \\mathbb{P} we conclude from equation (1.1.7) that \\boxed{\\displaystyle x=\\mathbb{E}_{\\mathbb{\\tilde{P}}}\\left(\\frac{1}{1+r}h(S_{% T})\\right).} (1.1.8) The measure \\mathbb{\\tilde{P}} is often called a risk neutral measure, since under this measure the option price depends only on the expectation of the payoff, not on its riskiness. Such measures will play a major role in the once we move on to more complicated models. As we will see risk neutral measures, also called equivalent martingale measures, will enable us to compute prices for options in complete and incomplete markets. Notice that formula (1.1.3), that is the first pricing method we described, is inherently related to the replication principle which is not applicable in incomplete markets. We devote the rest of this section to examples. Example 1.1.9. Assume the parameters in our elementary market model are the following: r=\\frac{1}{3} , S_{0}=1 , u=2 , d=\\frac{1}{2} , p=\\frac{3}{4} . We want to compute the price of a European call option with the strike price K=1 and the maturity time t=1 . In this case \\tilde{p}=\\frac{1+\\frac{1}{3}-\\frac{1}{2}}{2-\\frac{1}{2}}=\\frac{5}{9} and we obtain the price of the option x as x=\\frac{1}{1+\\frac{1}{3}}\\cdot\\left(\\frac{5}{9}(2-1)+\\frac{4}{9}0\\right)=\\frac% {15}{36}. Again, the example shows that the value of the probability p is completely irrelevant for the computation of the price of the option. Only the risk neutral probability \\tilde{p} matters. We can also verify that the number computer with p instead of \\tilde{p} is different: \\frac{1}{1+\\frac{1}{3}}\\cdot\\left(\\frac{3}{4}(2-1)+\\frac{1}{4}0\\right)=\\frac{9% }{16}. ∎ Example 1.1.10. Using the same parameters as in the previous example, we compute the price of a European put option, which has the following payoff h(S_{1}):=\\max(K-S_{1},0). The price of the European put is then given by x=\\frac{1}{1+\\frac{1}{3}}\\cdot\\left(\\frac{5}{9}0+\\frac{4}{9}\\cdot(1-\\frac{1}{2% })\\right)=\\frac{6}{36}=\\frac{1}{6} ∎ There is an interesting relationship between the European call considered in Example 1.1.9 and the European put considered in Example 1.1.10. Clearly \\frac{15}{36}-\\frac{1}{6}=\\frac{1}{4}=1-\\frac{1}{1+\\frac{1}{3}} or in words \\mbox{ price of call }-\\mbox{ price of put }=S_{0}-\\frac{1}{1+r}K. (1.1.9) This relationship not only holds for the special parameters chosen in the Examples but is true in general whenever the underlying model is arbitrage free. Formula (1.1.9) is called the Put-Call parity. 1.2. A general single period market model We will now consider a general single period market model, in which an agent is allowed to invest in a money market account (i.e. savings account) and a finite number of stocks S^{1},...,S^{n} . The price of the i -th stock at time t=0 , resp. t=1 , is denoted by S_{0}^{i} , resp. S_{1}^{i} . The money market account is modelled in exactly the same way as in Section 1.1. The prices of the stocks at time t=0 are known but the prices at time t=1 are not known at time t=0 and are considered to be random. We assume that the world at time t=1 can take up one of k states \\omega_{1},...,\\omega_{k} which we all put together into a set \\Omega , i.e. \\boxed{\\Omega:=\\{\\omega_{1},...,\\omega_{k}\\}.} We assume that there is a probability measure \\mathbb{P} defined on \\Omega . This measure tells us about the likelihood \\mathbb{P}(\\omega_{i}) of the world being in the the i -th state at time t=1 (as seen from time t=0 ). The stock prices S_{1}^{i} can therefore be considered as random variables \\boxed{S_{1}^{i}:\\Omega\\to\\mathbb{R}.} Then S_{1}^{i}(\\omega) denotes the price of the i -th stock at time t=1 if the world is in state \\omega\\in\\Omega at time t=1 . For technical reasons, we assume that each state at time t=1 is possible, i.e. \\mathbb{P}(\\omega)>0\\mbox{ for all }\\omega\\in\\Omega. Notice that we can always remove from \\Omega the states of the world that have probability of ocurring equal zero (i.e. they are impossible) and consequently we obtain a model that satisfies the above requirement. Let us now formally define the trading strategies which our agents are going to use. Definition 1.2.1. A trading strategy for an agent in our general single period market model is a pair (x,\\phi) , where x is the initial total investment at time t=0 and \\phi=(\\phi^{1},...,\\phi^{n})\\in\\mathbb{R}^{n} is an n -dimensional vector specifying the number of shares \\phi^{i} of the i -th stock that we own at t=0 . Given a trading strategy (x,\\phi) as above, we always assume that the rest of the money: x-\\sum_{i=1}^{n}\\phi^{i}S_{0}^{i} is invested in the money market account. As in Section 1.1 we define the value process corresponding to a trading strategy. Definition 1.2.2. The value process of the trading strategy (x,\\phi) in our general single period market model is given by (V_{0}(x,\\phi),V_{1}(x,\\phi)) , where V_{0}(x,\\phi)=x and V_{1}(x,\\phi) is the random variable \\boxed{V_{1}(x,\\phi)=\\left(x-\\sum_{i=1}^{n}\\phi^{i}S_{0}^{i}\\right)(1+r)+\\sum_% {i=1}^{n}\\phi^{i}S_{1}^{i}.} (1.2.1) It is often useful to consider an additional process, the so called gains process G(x,\\phi) , which in a single period market model consists only of one random variable which is defined by \\boxed{G(x,\\phi):=\\left(x-\\sum_{i=1}^{n}\\phi^{i}S_{0}^{i}\\right)r+\\sum_{i=1}^{% n}\\phi^{i}\\Delta S^{i}.} In this equation \\Delta S^{i} represents the change in price of the i -th stock, i.e. \\boxed{\\Delta S^{i}:=S_{1}^{i}-S_{0}^{i}.} (1.2.2) As the name indicates, G represents the gains (or losses) the agent obtains from his investment. A simple calculation gives V_{1}(x,\\phi)=V_{0}(x,\\phi)+G(x,\\phi). (1.2.3) Note that this is an equation of random variables, meaning that this equation holds in any possible state the world might attend at time t=1 , i.e. for all \\omega\\in\\Omega . Equation (1.2.3) says that any change in the value of the trading strategy must be due to a gain or loss in the investment and not, for example, due to the addition of funds from outside sources. It is often convenient to study the prices of the stocks in relation to the money market account. For this reason we introduce the discounted stock prices \\hat{S}_{t}^{i} defined as follows: \\boxed{\\begin{aligned} \\hat{S}_{0}^{i}&:=S_{0}^{i},\\\\ \\hat{S}_{1}^{i}&:=\\frac{1}{1+r}S_{1}^{i},\\end{aligned}\\qquad i=1,\\ldots,n.} We also define the discounted value process corresponding to the trading strategy (x,\\phi) via \\boxed{\\begin{aligned} \\hat{V}_{0}(x,\\phi)&:=x\\\\ \\hat{V}_{1}(x,\\phi)&:=(x-\\sum_{i=1}^{n}\\phi^{i}S_{0}^{i})+\\sum_{i=1}^{n}\\phi^{% i}\\hat{S}_{1}^{i}\\end{aligned}} as well as the discounted gains process \\hat{G}(x,\\phi) via \\boxed{\\hat{G}(x,\\phi):=\\sum_{i=1}^{n}\\phi^{i}\\Delta\\hat{S}^{i}} (1.2.4) with \\Delta\\hat{S}^{i}=\\hat{S}^{i}_{1}-\\hat{S}^{i}_{0} . The verification of the following two equations is left as an exercise: \\hat{V}_{t}=\\frac{V_{t}}{B_{t}} (1.2.5) for t\\in\\{0,1\\} with B_{0}=1 and B_{1}=1+r as well as \\hat{V}_{1}(x,\\phi)=\\hat{V}_{0}(x,\\phi)+\\hat{G}(x,\\phi). (1.2.6) Example 1.2.3. We consider the following model featuring two stocks S^{1} and S^{2} as well as the states \\Omega=\\{\\omega_{1},\\omega_{2},\\omega_{3}\\} . The prices of the stocks at time t=0 are given by S^{1}_{0}=5 and S^{2}_{0}=10 respectively. At time t=1 the prices depend on the state \\omega and are given by the following table: \\omega_{1} \\omega_{2} \\omega_{3} S_{1}^{1} \\frac{60}{9} \\frac{60}{9} \\frac{40}{9} S_{1}^{2} \\frac{40}{3} \\frac{80}{9} \\frac{80}{9} We assume that the interest rate r is equal to \\frac{1}{9} . Let us consider a trading strategy (x,\\phi) , with \\phi=(\\phi^{1},\\phi^{2})\\in\\mathbb{R}^{2}. Then V_{1}(x,\\phi)=(x-\\phi^{1}\\cdot 5-\\phi^{2}\\cdot 10)(1+\\frac{1}{9})+\\phi^{1}S_{1% }^{1}+\\phi^{2}S_{1}^{2} and depending on the state of the world: \\displaystyle V_{1}(x,\\phi)(\\omega_{1}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})(1+\\frac{1}{9})+\\frac{60}{9}\\phi^{1}+% \\frac{40}{3}\\phi^{2} \\displaystyle V_{1}(x,\\phi)(\\omega_{2}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})(1+\\frac{1}{9})+\\frac{60}{9}\\phi^{1}+% \\frac{80}{9}\\phi^{2} \\displaystyle V_{1}(x,\\phi)(\\omega_{3}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})(1+\\frac{1}{9})+\\frac{40}{9}\\phi^{1}+% \\frac{80}{9}\\phi^{2} The increments \\Delta S^{i} are given by the following table \\omega_{1} \\omega_{2} \\omega_{3} \\Delta S^{1} \\frac{5}{3} \\frac{5}{3} -\\frac{5}{9} \\Delta S^{2} \\frac{10}{3} -\\frac{10}{9} -\\frac{10}{9} and the gains process G by \\displaystyle G(x,\\phi)(\\omega_{1}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})\\frac{1}{9}+\\frac{5}{3}\\phi^{1}+\\frac{10% }{3}\\phi^{2} \\displaystyle G(x,\\phi)(\\omega_{2}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})\\frac{1}{9}+\\frac{5}{3}\\phi^{1}-\\frac{10% }{9}\\phi^{2} \\displaystyle G(x,\\phi)(\\omega_{3}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})\\frac{1}{9}-\\frac{5}{9}\\phi^{1}-\\frac{10% }{9}\\phi^{2} The discounted prices of the stock at time t=1 : \\omega_{1} \\omega_{2} \\omega_{3} \\hat{S}_{1}^{1} 6 6 4 \\hat{S}_{1}^{2} 12 8 8 The discounted value process at time t=1 : \\displaystyle\\hat{V}_{1}(x,\\phi)(\\omega_{1}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})+6\\phi^{1}+4\\phi^{2} \\displaystyle\\hat{V}_{1}(x,\\phi)(\\omega_{2}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})+6\\phi^{1}+8\\phi^{2} \\displaystyle\\hat{V}_{1}(x,\\phi)(\\omega_{3}) \\displaystyle=(x-5\\phi^{1}-10\\phi^{2})+4\\phi^{1}+8\\phi^{2} The increments of the discounted stock prices \\Delta\\hat{S}^{i} : \\omega_{1} \\omega_{2} \\omega_{3} \\Delta\\hat{S}_{1}^{1} 1 1 -1 \\Delta\\hat{S}_{1}^{2} 2 -2 -2 The discounted gains process \\hat{G} : \\displaystyle\\hat{G}(x,\\phi)(\\omega_{1}) \\displaystyle=1\\phi^{1}+2\\phi^{2} \\displaystyle\\hat{G}(x,\\phi)(\\omega_{2}) \\displaystyle=1\\phi^{1}-2\\phi^{2} \\displaystyle\\hat{G}(x,\\phi)(\\omega_{3}) \\displaystyle=-1\\phi^{1}-2\\phi^{2} ∎ Given the definition of the value process (1.2.1) in the general single period market model, the definition of an arbitrage in this model looks almost the same as in Definition 1.1.2: Definition 1.2.4. A trading strategy (x,\\phi) in our general single period market model is called an arbitrage, if (1)​ x=V_{0}(x,\\phi)=0 (2)​ V_{1}(x,\\phi)\\geq 0 (3)​ \\mathbb{E}(V_{1}(x,\\phi))=\\sum_{i=1}^{k}\\mathbb{P}(\\omega_{i})V_{1}(x,\\phi)(% \\omega_{i})>0 Here V_{1}(x,\\phi) is given by equation (1.2.1). The following remark is often very helpful: Remark 1.2.5. Condition 3. in Definition 1.2.4 is equivalent to: (3’)​There exists \\omega\\in\\Omega such that V_{1}(x,\\phi)(\\omega)>0 . The definition of an arbitrage can also be formulated with the discounted value process or with the discounted gains process. The following proposition gives us such a statement. Proposition 1.2.6. A trading strategy (x,\\phi) in the general single period market model is an arbitrage if and only if one of the following two equivalent conditions hold: • (1)​ x=\\hat{V}_{0}(x,\\phi)=0 (2)​ \\hat{V}_{1}(x,\\phi)\\geq 0 (3)​ \\mathbb{E}(\\hat{V}_{1}(x,\\phi))>0 or equivalently: there exists \\omega\\in\\Omega s.t. \\hat{V}_{1}(x,\\phi)(\\omega)>0 . • (1)​ x=\\hat{V}_{0}(x,\\phi)=0 (2)​ \\hat{G}(x,\\phi)\\geq 0 (3)​ \\mathbb{E}(\\hat{G}(x,\\phi))>0 or equivalently: there exists \\omega\\in\\Omega s.t. \\hat{G}(x,\\phi)(\\omega)>0 . Previous page Next page"],[["index.html","Pt3.html"],"Lecture III 15/10/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 15/10/2024 Lecture III 15/10/2024 We are now coming back to the subject of risk neutral measures which we shortly mentioned in Section 1.1. Definition 1.2.7. A measure \\tilde{\\mathbb{P}} on \\Omega is called a risk neutral probability measure for our general single period market model if (1)​ \\tilde{\\mathbb{P}}(\\omega)>0 for all \\omega\\in\\Omega , (2)​ \\mathbb{E}_{\\tilde{\\mathbb{P}}}(\\Delta\\hat{S}^{i})=0 for i=1,\\ldots,n . Another way of formulating the second condition in Definition 1.2.7 is: \\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\frac{1}{1+r}S_{1}^{i}\\right)=S_{0}^{i}. Notice that when \\Omega consists of only two elements and there is only one tradable stock ( n=1 ) Definition 1.2.7 is consistent with what we called a risk neutral measure in Section 1.1. We also mentioned before that risk neutral measures are closely related to arbitrage and pricing of options. The following theorem, apparently contrary to its title, addresses first of these questions: Theorem 1.2.8. Fundamental Theorem of Asset Pricing: In the general single period market model, there are no arbitrages if and only if there exist a risk neutral measure. The proof of this theorem is essentially geometric and requires some preparation. First of all it is very useful to think of random variables on \\Omega as vectors in the k dimensional euclidean space \\mathbb{R}^{k} . This is possible by the following identification: \\boxed{X\\Leftrightarrow(X(\\omega_{1}),X(\\omega_{2}),...,X(\\omega_{k}))^{\\top}% \\in\\mathbb{R}^{k}} The identification means that every random variable can be interpreted as a vector in \\mathbb{R}^{k} and, vice versa, every vector in \\mathbb{R}^{k} defines a random variable on \\Omega . We can therefore identify the set of random variables on \\Omega with the set \\mathbb{R}^{k} . A probability measure \\mathbb{Q} on \\Omega can as well be identified with a vector in \\mathbb{R}^{k} . The identification is formally identical to the one above: \\boxed{\\mathbb{Q}\\Leftrightarrow(\\mathbb{Q}(\\omega_{1}),\\mathbb{Q}(\\omega_{2})% ,...,\\mathbb{Q}(\\omega_{k}))\\in\\mathbb{R}^{k}} The difference to the situation above, when we identify random variables with vectors, is that probability measures yield vectors (X_{1},...,X_{k})\\in\\mathbb{R}^{k} with the following two properties: (1)​ X_{i}\\geq 0 for all i=1,...,k (2)​ \\sum_{i=1}^{k}X_{i}=1 . These two properties follow from the properties \\mathbb{Q}(\\omega)\\geq 0 for all \\omega\\in\\Omega , \\mathbb{Q}(\\Omega)=1 and \\mathbb{Q}(A\\cup B)=\\mathbb{Q}(A)+\\mathbb{Q}(B) for disjoint sets A and B , which every probability measure has to satisfy. The subset of \\mathbb{R}^{k} consisting of the vectors with properties 1. and 2. above is often called the standard simplex in \\mathbb{R}^{k} . Although every vector in \\mathbb{R}^{k} defines a probability measure, we can identify the set of probability measures on \\Omega with the standard simplex in \\mathbb{R}^{k} . In the following we will always use this identification, writing X for the vector representing the random variable X and \\mathbb{Q} for the vector representing the probability measure \\mathbb{Q} . Using this interpretation we can for example write the expectation value of a random variable with respect to a probability measure \\mathbb{Q} on \\Omega as a scalar product in the euclidean space \\mathbb{R}^{k} as follows: \\boxed{\\mathbb{E}_{\\mathbb{Q}}(X)=\\sum_{i=1}^{k}X(\\omega_{i})\\mathbb{Q}(\\omega% _{i})=\\langle X,\\mathbb{Q}\\rangle,} where \\langle\\cdot,\\cdot\\rangle denotes the standard scalar product in \\mathbb{R}^{k} . Let us now consider the following set: \\boxed{\\mathbb{W}=\\{X\\in\\mathbb{R}^{k}|X=\\hat{G}(x,\\phi)\\mbox{ for some % trading strategy }(x,\\phi)\\}.} (1.2.7) One should think of the elements of \\mathbb{W} as the possible discounted values at time t=1 of trading strategies starting with an initial investment x=0 . Note that \\mathbb{W} is a linear subspace of \\mathbb{R}^{k} . Next we consider the set \\boxed{\\mathbb{A}=\\{X\\in\\mathbb{R}^{k}|X\\geq 0,X\\neq 0\\}.} (1.2.8) This is the nonnegative orthant in \\mathbb{R}^{k} , since by X\\geq 0 for a vector X we mean that each coordinate of X is greater or equal to zero. So with the help of the above notation we can write the no-arbitrage property differently: \\boxed{\\mbox{ no arbitrage }\\Leftrightarrow\\mathbb{W}\\cap\\mathbb{A}=\\emptyset.} (1.2.9) The elements in \\mathbb{W}\\cap\\mathbb{A} are exactly the discounted values of the arbitrages at time t=1 . Let us now consider the orthogonal complement of \\mathbb{W} which is given by \\boxed{\\mathbb{W}^{\\bot}=\\{Y\\in\\mathbb{R}^{k}\\,|\\,\\langle X,Y\\rangle=0\\mbox{ % for all }X\\in\\mathbb{W}\\}.} (1.2.10) Furthermore we define \\boxed{\\mathcal{P}^{+}=\\{X\\in\\mathbb{R}^{k}|\\sum_{i=1}^{k}X_{i}=1,X_{i}>0\\}.} (1.2.11) This set can be identified with the set of probability measures on \\Omega which satisfy property (1) from Definition 1.2.7. We have the following lemma: Lemma 1.2.9. A measure \\tilde{\\mathbb{P}} is a risk neutral probability measure on \\Omega if and only if \\tilde{\\mathbb{P}}\\in\\mathcal{P}^{+}\\cap\\mathbb{W}^{\\bot} . Proof. Since there is \"if and only if\" in the statement of the lemma we have to prove two assertions: (a)​If a measure \\tilde{\\mathbb{P}} is a risk neutral probability measure on \\Omega then \\tilde{\\mathbb{P}}\\in\\mathcal{P}^{+}\\cap\\mathbb{W}^{\\bot} . (b)​If \\tilde{\\mathbb{P}}\\in\\mathcal{P}^{+}\\cap\\mathbb{W}^{\\bot} then the measure \\tilde{\\mathbb{P}} is a risk neutral probability measure on \\Omega . We start with (a). It is indicated by saying: assume first that \\tilde{\\mathbb{P}} is a risk neutral probability measure on \\Omega . Then by property 1. in Definition 1.2.7 \\tilde{\\mathbb{P}}\\in\\mathcal{P}^{+} . Using property 2. in Definition 1.2.7 as well as the definition of the discounted gains process \\hat{G}(x,\\phi) in (1.2.4) we have for X=\\hat{G}(x,\\phi)\\in\\mathbb{W} \\langle X,\\tilde{\\mathbb{P}}\\rangle=\\mathbb{E}_{\\tilde{\\mathbb{P}}}(\\hat{G}(x,% \\phi))=\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\sum_{i=1}^{k}\\phi^{i}\\Delta\\hat{S% }^{i}\\right)=\\sum_{i=1}^{k}\\phi^{i}\\underbrace{\\mathbb{E}_{\\tilde{\\mathbb{P}}}% \\left(\\Delta\\hat{S}^{i}\\right)}_{=0}=0 and therefore \\tilde{\\mathbb{P}}\\in\\mathbb{W}^{\\bot} . Together with the first part this gives \\tilde{\\mathbb{P}}\\in\\mathcal{P}^{+}\\cap\\mathbb{W}^{\\bot} . On the other hand if \\tilde{\\mathbb{P}} is an arbitrary vector in \\mathcal{P}^{+}\\cap\\mathbb{W}^{\\bot} (we are now proving (b)!) then \\tilde{\\mathbb{P}} defines a probability measure satisfying condition (1) in Definition 1.2.7. For a given i=1,..,n consider the trading strategy \"buy one share of the asset i \", i.e. the strategy (x,\\phi) with x=S_{0}^{i} and \\phi=(0,...,0,1,0,...0) with the sole 1 is in the i -th position. The discounted gains process of this strategy clearly satisfies \\hat{G}(x,\\phi)=\\Delta\\hat{S}^{i} . By definition \\hat{G}(x,\\phi)\\in\\mathbb{W} and since \\tilde{\\mathbb{P}}\\in\\mathbb{W}^{\\bot} we have 0=\\langle\\hat{G}(x,\\phi),\\tilde{\\mathbb{P}}\\rangle=\\mathbb{E}_{\\tilde{\\mathbb{% P}}}\\left(\\Delta\\hat{S}^{i}\\right). Therefore \\tilde{\\mathbb{P}} also satisfies condition (2) in Definition 1.2.7, which completes the proof. ∎ For the next proof, we will use a well known result from geometry, namely the separating hyperplane theorem. Recall that a set A is called convex if and only if x,y\\in A implies that \\alpha x+(1-\\alpha)y\\in A for any 0\\leq\\alpha\\leq 1 . Theorem 1.2.10. Let A\\subset\\mathbb{R}^{k} be convex and compact, \\mathbb{H}\\ni 0 a hyperplane in \\mathbb{R}^{k} , and A\\bigcap\\mathbb{H}=\\emptyset . Then there exists a vector v\\in\\mathbb{R}^{k} such that v\\perp\\mathbb{H} and \\min(\\langle v,z\\rangle:z\\in A)>0 . Proof. See for example [3, Section 3.1]. ∎ In 2 dimensions, the above theorem can be interpreted as seen in Figure 1. An example of the separating hyperplane theorem in 2 dimensions. Note that Figure 1. An example of the separating hyperplane theorem in 2 dimensions. Note that v does not have to lie in A , it just has to satisfy that \\langle v,w\\rangle>0 for all x\\in A . Definition 1.2.11. We denote by \\mathbb{M}=\\mathbb{W}^{\\bot}\\cap\\mathcal{P}^{+} the set of risk neutral measures. We are now ready to prove Theorem 1.2.8. Proof of Theorem 1.2.8. Notice that in the statement of the theorem there is \"if and only if\", so we have to prove two assertions as in Lemma 1.2.9. Assume first that the no arbitrage condition holds. Let us define the set \\mathbb{A}^{+}=\\{X\\in\\mathbb{A}|\\langle X,\\mathbb{P}\\rangle=1\\} It is a closed, bounded and convex subset of \\mathbb{R}^{k} . Since \\mathbb{A}^{+}\\subset\\mathbb{A} it follows from (1.2.9) that \\mbox{ no arbitrage }\\Rightarrow\\mathbb{W}\\cap\\mathbb{A}^{+}=\\emptyset. By the separating hyperplane theorem, there exists a vector Y\\in\\mathbb{W}^{\\bot} , s.t. \\langle X,Y\\rangle>0\\mbox{ for all }X\\in\\mathbb{A}^{+}. (1.2.12) For each i=1,...,k define the vector X^{i} as a vector in \\mathbb{R}^{k} whose i -th coordinate is equal to 1/\\mathbb{P}(\\omega_{i}) and the remaining components are zero. Then \\langle X^{i},\\mathbb{P}\\rangle=\\frac{1}{\\mathbb{P}(\\omega_{i})}\\mathbb{P}(% \\omega_{i})=1 and hence X^{i}\\in\\mathbb{A}^{+} . Denoting with Y_{i} the i -th component of Y it then follows from (1.2.12), that 0<\\langle X^{i},Y\\rangle=\\frac{1}{\\mathbb{P}(\\omega_{i})}Y_{i} and therefore Y(\\omega_{i})=Y_{i}>0 for all i=1,..,k . Let us now define \\mathbb{Q} by \\mathbb{Q}(\\omega_{i})=\\frac{Y(\\omega_{i})}{Y(\\omega_{1})+...+Y(\\omega_{k})}. Clearly, \\mathbb{Q}\\in\\mathcal{P}^{+} . Since \\mathbb{Q} is merely a scalar multiple of Y and \\mathbb{W}^{\\bot} is a vectorspace it follows that \\mathbb{Q}\\in\\mathbb{W}^{\\bot} . Therefore \\mathbb{Q}\\in\\mathcal{P}^{+}\\cap\\mathbb{W}^{\\bot} and by Lemma 1.2.9 we have that \\mathbb{Q} is a risk neutral measure on \\Omega . We have therefore shown, that the condition no arbitrage implies the existence of a risk neutral measure. Let us now show the converse. We assume there exists a risk neutral measure \\mathbb{Q} . Let (x,\\phi) be an arbitrary trading strategy. As in the proof of Lemma 1.2.9 \\mathbb{E}_{{\\mathbb{Q}}}(\\hat{G}(x,\\phi))=\\mathbb{E}_{{\\mathbb{Q}}}\\left(\\sum% _{i=1}^{k}\\phi^{i}\\Delta\\hat{S}^{i}\\right)=\\sum_{i=1}^{k}\\phi^{i}\\mathbb{E}_{{% \\mathbb{Q}}}\\left(\\Delta\\hat{S}^{i}\\right)=0. If we assume that \\hat{G}(x,\\phi)\\geq 0 then the last equation clearly implies that \\hat{G}(x,\\phi)(\\omega)=0 for all \\omega\\in\\Omega . Hence by Proposition 1.2.6 there cannot be any trading strategy that is an arbitrage. ∎ Example 1.2.12. We continue with example 1.2.3. Recall the increments of the discounted prices: \\omega_{1} \\omega_{2} \\omega_{3} \\Delta\\hat{S}^{1} 1 1 -1 \\Delta\\hat{S}^{2} 2 -2 -2 By definition of \\mathbb{W} and \\hat{G}(x,\\phi)=\\phi^{1}\\Delta\\hat{S}^{1}+\\phi^{2}\\Delta\\hat{S}^{2} it therefore follows that \\mathbb{W}=\\left\\{\\left(\\begin{array}[]{c}\\phi^{1}+2\\phi^{2}\\\\ \\phi^{1}-2\\phi^{2}\\\\ -\\phi^{1}-2\\phi^{2}\\end{array}\\right)\\Big{|}\\phi^{1},\\phi^{2}\\in\\mathbb{R}% \\right\\}. Note that for any vector X\\in\\mathbb{W} we have X_{1}+X_{3}=0 , where X_{i} once again denotes the i -th coordinate of the vector X . On the other hand, whenever we have a vector X\\in\\mathbb{R}^{3} s.t. X_{1}+X_{3}=0 , we can choose \\phi^{1}=\\frac{1}{2}(X_{1}+X_{2}) and \\phi^{2}=\\frac{1}{4}(X_{1}-X_{2}) and obtain X=\\left(\\begin{array}[]{c}X_{1}\\\\ X_{2}\\\\ X_{3}\\end{array}\\right)=\\left(\\begin{array}[]{c}\\phi^{1}+2\\phi^{2}\\\\ \\phi^{1}-2\\phi^{2}\\\\ -\\phi^{1}-2\\phi^{2}\\end{array}\\right). Hence \\mathbb{W}=\\{X\\in\\mathbb{R}^{3}|X_{1}+X_{3}=0\\}. It is then easy to see that the orthogonal complement of \\mathbb{W} is given by \\mathbb{W}^{\\bot}=\\{Y\\in\\mathbb{R}^{3}|Y=(\\lambda,0,\\lambda)^{T},\\ \\lambda\\in% \\mathbb{R}\\}, which clearly implies that \\mathbb{W}^{\\bot}\\cap\\mathcal{P}^{+}=\\emptyset and therefore there is no risk neutral measure for this model. By Theorem 1.2.8 there must be an arbitrage strategy in the model. By comparing \\mathbb{W} and \\mathbb{A} we can see that \\mathbb{W}\\cap\\mathbb{A}=\\{X\\in\\mathbb{R}^{3}|X_{1}=X_{3}=0,X_{2}>0\\}. Let us compute an arbitrage strategy: we start with any positive number X_{2}>0 . Since \\left(\\begin{array}[]{c}0\\\\ X_{2}\\\\ 0\\end{array}\\right)\\in\\mathbb{W}\\cap\\mathbb{A} we know that there must be a trading strategy (x,\\phi) s.t \\hat{G}(x,\\phi)=\\left(\\begin{array}[]{c}0\\\\ X_{2}\\\\ 0\\end{array}\\right). We compute it by solving the following system of linear equations: \\displaystyle\\phi^{1}+2\\phi^{2} \\displaystyle= \\displaystyle\\hat{G}(x,\\phi)(\\omega_{1})=0 \\displaystyle\\phi^{1}-2\\phi^{2} \\displaystyle= \\displaystyle\\hat{G}(x,\\phi)(\\omega_{2})=X_{2} \\displaystyle-\\phi^{1}-2\\phi^{2} \\displaystyle= \\displaystyle\\hat{G}(x,\\phi)(\\omega_{3})=0 where the last equation above is redundant (when multiplied by -1 it is identical to the first one). The solution is: \\phi^{1}=\\frac{X_{2}}{2},\\quad\\phi^{2}=-\\frac{X_{2}}{4}. These numbers tell us how many shares we ought to buy in order to obtain the arbitrage. We still need to know how much money we have to invest in the money market account. This is easy. Since the arbitrage starts with an initial total investment of zero, we must invest 0-\\phi^{1}S^{1}_{0}-\\phi^{2}S^{2}_{0}=-\\frac{X_{2}}{2}\\cdot 5-(-\\frac{X_{2}}{4% })\\cdot 10=0 in the money market. The arbitrage we computed is therefore a strategy which only invests in the risky assets, i.e the stocks. ∎ We now come back to the question: what should the price of an option in our model be? In Section 1.1 we considered options of the type h(S_{1}) , where h is a payoff profile, a function of a single stock S_{1} at time t=1 . In our general model we have more than one stock and the payoff profiles may look more complicated. For this reason we generalise our definition of an option. We call this more general product contingent claim. Definition 1.2.13. A contingent claim in the general single period market model is a random variable X on \\Omega representing a payoff at time t=1 . To price a contingent claim, we may follow the same approach as taken in Section 1.1 and apply the replication principle. Proposition 1.2.14. Let X be a contingent claim in our general single period market model, and let (x,\\phi) be a hedging strategy for X , i.e. a trading strategy which satisfies V_{1}(x,\\phi)=X . The only price of X which complies with the no arbitrage principle is V_{0}(x,\\phi) , which by definition is equal to x . The proof of this proposition follows along the same argumentation as in Section 1.1. A crucial difference to the elementary single period model as discussed in Section 1.1 is however that in the general single period market model a replicating strategy might not exist. This can happen when there are more effective sources of randomness than there are stocks to invest in. Let us consider the following example that represents an elementary version of a so called stochastic volatility model. Example 1.2.15. We consider the following market model. It consists of two tradeable assets, one money market account B_{t} and one stock S_{t} ( t=0,1 ), as well as third object which we call the volatility v . The volatility determines whether the stock price can make big jumps or small jumps. In this model the volatility is assumed to be random, or in other words stochastic. Such models are called stochastic volatility models. To be a bit more precise, we assume that our state space consists of 4 states, \\Omega:=\\{\\omega_{1},\\omega_{2},\\omega_{3},\\omega_{4}\\}. and that the volatility is given by v(\\omega):=\\begin{cases}h,&\\mbox{ if }\\omega=\\omega_{1},\\omega_{2}\\\\ l,&\\mbox{ if }\\omega=\\omega_{3},\\omega_{4}\\end{cases} Here 0<l<h<1 and l stands for low volatility whereas h stands for high volatility. The stock price S_{1} is then modeled by S_{1}(\\omega):=\\begin{cases}(1+v(\\omega))S_{0},&\\mbox{ if }\\omega=\\omega_{1},% \\omega_{3}\\\\ (1-v(\\omega))S_{0},&\\mbox{ if }\\omega=\\omega_{2},\\omega_{4}\\end{cases} where S_{0} denotes the initial stock price. The stock price can therefore jump up or down as in the first elementary single period market model from Section 1.1. The difference to that model is that the amount by which it jumps is itself random determined by the volatility. Finally, the money market account is modeled as before by B_{0}=1,\\qquad B_{1}=1+r. Let us now consider a digital call in this model, i.e. X=\\begin{cases}1,&\\mbox{ if }S_{1}>K\\\\ 0&\\mbox{ otherwise }\\end{cases} Assume that the strike price K satisfies (1+l)S_{0}<K<(1+h)S_{0}. Then a nonzero payoff is only possible if the volatility is high and the stock jumps up. This is the case if and only if the state of the world at time t=1 is given by \\omega=\\omega_{1} . The contingent claim X can therefore alternatively be written as X(\\omega)=\\begin{cases}1,&\\mbox{ if }\\omega=\\omega_{1}\\\\ 0&\\mbox{ if }\\omega=\\omega_{2},\\omega_{3},\\omega_{4}\\end{cases} Let us check if there exists a replicating strategy for this contingent claim, i.e. a trading strategy (x,\\phi) satisfying V_{1}(x,\\phi)=X. Using the definition of V_{1}(x,\\phi) and our vector notation for random variables, the last equation is equivalent to the following system of linear equations: (x-\\phi S_{0})\\cdot\\left(\\begin{array}[]{c}1+r\\\\ 1+r\\\\ 1+r\\\\ 1+r\\end{array}\\right)+\\phi\\cdot\\left(\\begin{array}[]{c}(1+h)S_{0}\\\\ (1-h)S_{0}\\\\ (1+l)S_{0}\\\\ (1-l)S_{0}\\end{array}\\right)=\\left(\\begin{array}[]{c}1\\\\ 0\\\\ 0\\\\ 0\\end{array}\\right) We rearrange the terms and write equivalently: x\\cdot\\left(\\begin{array}[]{c}1+r\\\\ 1+r\\\\ 1+r\\\\ 1+r\\end{array}\\right)+\\phi S_{0}\\cdot\\left(\\begin{array}[]{c}h-r\\\\ -(h+r)\\\\ l-r\\\\ -(l+r)\\end{array}\\right)=\\left(\\begin{array}[]{c}1\\\\ 0\\\\ 0\\\\ 0\\end{array}\\right) Solving the second equation (the second component) for x yields: x=\\frac{1}{1+r}\\phi S_{0}(h+r). On the other hand, solving the fourth equation (the fourth component) for x gives: x=\\frac{1}{1+r}\\phi S_{0}(l+r). Since S_{0}(h+r)\\neq S_{0}(l+r) , both equations can only hold together if \\phi=0 . This however implies that x=0 and so we get 0=1 in the first equation. This of course isn’t true. The conclusion is that there is no trading strategy (x,\\phi) which replicates X . The heuristic explanation is that there is a source of randomness in the volatility which cannot be hedged since the volatility is not tradeable. The mathematical explanation is just that the system of linear equations above has no solution. ∎ To take account of this difficulty we introduce the following definition. Definition 1.2.16. A contingent claim X is called attainable, if there exists a trading strategy (x,\\phi) which replicates X , i.e. satisfies V_{1}(x,\\phi)=X . For attainable contingent claims the replication principle applies and it is clear how to price them, namely by the total initial investment needed for a replicating strategy. There might be more than one replicating strategy, but it follows again from the no arbitrage principle, that the total initial investment for replicating strategies is unique. In equation (1.1.8) we established a way to use a risk neutral measure to compute the price of an option in the elementary single period market model. This approach works fine in the general single period market model as long as attainable contingent claims are considered. Proposition 1.2.17. Let X be an attainable contingent claim and \\tilde{\\mathbb{P}} be an arbitrary risk neutral measure. Then the price x of X at time t=0 defined via a replicating strategy can be computed by the formula \\boxed{x=\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\frac{1}{1+r}X\\right).} (1.2.13) Proof. Let (x,\\phi) be a replicating strategy of X , i.e. X=V_{1}(x,\\phi) . It follows from the equality \\hat{V}_{1}(x,\\phi)=\\frac{1}{1+r}V_{1}(x,\\phi) that \\frac{1}{1+r}X=\\hat{V}_{1}(x,\\phi) and from Definition 1.2.7 \\displaystyle\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\frac{1}{1+r}X\\right) \\displaystyle=\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\hat{V}_{1}(x,\\phi)\\right) \\displaystyle=\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(x+\\hat{G}_{1}(x,\\phi)\\right) \\displaystyle=x+\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\sum_{i=1}^{k}\\phi^{i}% \\Delta\\hat{S}^{i}\\right) \\displaystyle=x+\\sum_{i=1}^{k}\\phi^{i}\\underbrace{\\mathbb{E}_{\\tilde{\\mathbb{P% }}}\\left(\\Delta\\hat{S}^{i}\\right)}_{=0} \\displaystyle=x. ∎ Remark 1.2.18. Proposition 1.2.17 tells us, in particular, that for all risk neutral measures for the model we get the same value when computing the expectation in equation (1.2.13). The following example shows that the situation changes dramatically if the contingent claim is not attainable. Example 1.2.19. Let us compute the set of risk neutral measures for our stochastic volatility model from Example 1.2.15. For simplicity we assume r=0 . In this case the discounted processes and the original processes coincide. We have \\Delta\\hat{S}(\\omega):=\\left\\{\\begin{array}[]{cc}v(\\omega)\\cdot S_{0},&\\mbox{ % if }\\omega=\\omega_{1},\\omega_{3}\\\\ -v(\\omega)\\cdot S_{0},&\\mbox{ if }\\omega=\\omega_{2},\\omega_{4}\\end{array}\\right. or in the vector notation \\Delta\\hat{S}=S_{0}\\cdot\\left(\\begin{array}[]{r}h\\\\ -h\\\\ l\\\\ -l\\end{array}\\right). For a trading strategy (x,\\phi) the discounted gains process is given by \\hat{G}(x,\\phi)=\\phi\\cdot\\Delta\\hat{S} and hence the vectorspace \\mathbb{W} is one dimensional, spanned by the vector \\Delta\\hat{S} , i.e. \\mathbb{W}=\\operatorname{span}\\left\\{\\left(\\begin{array}[]{r}h\\\\ -h\\\\ l\\\\ -l\\end{array}\\right)\\right\\}. The orthogonal complement of \\mathbb{W} is then given by \\mathbb{W}^{\\bot}=\\left\\{\\left.\\left(\\begin{array}[]{r}q_{1}\\\\ q_{2}\\\\ q_{3}\\\\ q_{4}\\end{array}\\right)\\right|\\left\\langle\\left(\\begin{array}[]{r}q_{1}\\\\ q_{2}\\\\ q_{3}\\\\ q_{4}\\end{array}\\right),\\left(\\begin{array}[]{r}h\\\\ -h\\\\ l\\\\ -l\\end{array}\\right)\\right\\rangle=0\\right\\}. On the other hand (q_{1},q_{2},q_{3},q_{4})^{\\top}\\in\\mathcal{P}^{+} if and only if q_{1}+q_{2}+q_{3}+q_{4}=1 and q_{1},q_{2},q_{3},q_{4}>0 . Since the set of risk neutral measures is given by \\mathbb{M}=\\mathbb{W}^{\\bot}\\cap\\mathcal{P}^{+} we find that \\left(\\begin{array}[]{r}q_{1}\\\\ q_{2}\\\\ q_{3}\\\\ q_{4}\\end{array}\\right)\\in\\mathbb{M}\\Leftrightarrow\\begin{aligned} &0<q_{1},q_% {2},q_{3},\\quad 0<q_{4}=1-(q_{1}+q_{2}+q_{3}),\\\\ &\\text{and }h(q_{1}-q_{2})+l(q_{3}-(1-(q_{1}+q_{2}+q_{3}))=0.\\end{aligned} The set of risk neutral measures in our stochastic volatility model is therefore given by: \\mathbb{M}=\\left\\{\\left.\\left(\\begin{array}[]{c}q_{1}\\\\ q_{2}\\\\ q_{3}\\\\ 1-(q_{1}+q_{2}+q_{3})\\end{array}\\right)\\right|\\begin{array}[]{c}q_{i}>0,\\quad q% _{1}+q_{2}+q_{3}<1\\\\ h(q_{1}-q_{2})=l(1-(q_{1}+q_{2}+2q_{3}))\\end{array}\\right\\} Clearly, this set is not empty when l<h and we can conclude that our stochastic volatility model is arbitrage free. In particular, as it is easy to verify, for every 0<q_{1}<1 there exists \\mathbb{Q}\\in\\mathbb{M} s.t.  \\mathbb{Q}(\\omega_{1})=q_{1} . Let us now compute the (discounted) expectation of a Digital call under a measure \\mathbb{Q}=(q_{1},q_{2},q_{3},q_{4})^{\\top}\\in\\mathbb{M} : \\mathbb{E}_{\\mathbb{Q}}(X)=q_{1}\\cdot 1+q_{2}\\cdot 0+q_{3}\\cdot 0+q_{4}\\cdot 0% =q_{1}. Since q_{1} is arbitrary, except that it has to lie between zero and one, we see that we obtain many different values as discounted expectation under a risk neutral measure, in fact every value x which satisfies 0<x<1 . The situation is therefore completely different than in Proposition 1.2.17 because as we showed in Example 1.2.15 the contingent claim X is not attainable. ∎ Let us now consider a general contingent claim X , attainable or not. Definition 1.2.20. We say that a price x for the contingent claim X complies with the no-arbitrage principle, if the extended model, which consists of the original stocks S^{1},...,S^{n} and an additional asset S^{n+1} whose prices satisfy S_{0}^{n+1}=x and S_{1}^{n+1}=X is arbitrage free. The additional asset S^{n+1} defined in the above proposition may not be interpreted as a stock, since it can take negative values if the contingent claim takes negative values. For the general arbitrage and pricing theory developed so far positiveness of asset prices was however not essential. In view of the previous example the following proposition might be surprising. It says that whenever one uses a risk neutral measure to price a contingent claim by formula (1.2.13) one obtains a price which complies with the no arbitrage principle. Even if prices differ when using different risk neutral measures. Proposition 1.2.21. Let X be a possibly unattainable contingent claim and \\tilde{\\mathbb{P}} a risk neutral measure for our general single period market model. Then x=\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\frac{1}{1+r}X\\right) (1.2.14) defines a price for the contingent claim at time t=0 which complies with the no-arbitrage principle. Proof. By the Fundamental Theorem of Asset Pricing (Theorem 1.2.8) it is enough to show that there exists a risk neutral measure for the corresponding model which is extended by the asset S^{n+1} as in Definition 1.2.20. By assumption \\tilde{\\mathbb{P}} is a risk neutral measure for the original model, consisting of the stocks S^{1},...,S^{n} , i.e. \\tilde{\\mathbb{P}} satisfies (1) and (2) in Definition 1.2.7 for i=1,...,n . For i=n+1 the second condition translates into \\displaystyle\\mathbb{E}_{\\tilde{\\mathbb{P}}}(\\Delta\\hat{S}^{n+1}) \\displaystyle= \\displaystyle\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\frac{1}{1+r}X-x\\right) \\displaystyle= \\displaystyle\\mathbb{E}_{\\tilde{\\mathbb{P}}}\\left(\\frac{1}{1+r}X\\right)-x \\displaystyle= \\displaystyle x-x=0 Hence \\tilde{\\mathbb{P}} is a risk neutral measure for the extended model. ∎ In the situation of Example 1.2.19 this proposition applied to the Digital call says that any price between zero and one is a price which does not allow arbitrage and can therefore be considered as fair. This non uniqueness of prices is a serious problem which has not been completely resolved until today. We will later discuss a few methods which try to address this issue. For now let us characterise the models, in which the problem of non uniqueness of prices does not occur: Previous page Next page"],[["index.html","Pt4.html"],"Lecture IV 22/10/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 22/10/2024 Lecture IV 22/10/2024 Definition 1.2.22. A financial market model is called complete, if for any contingent claim X there exists a replicating strategy (x,\\phi) . A model which is not complete is called incomplete. By Proposition 1.2.17 the issue of computing prices in complete market models is completely solved. But how to recognise complete models? The following proposition gives us a criterion for completeness. Proposition 1.2.23. Assume a general single period market model consisting of stocks S^{1},...,S^{n} and a money market account modeled on the state space \\Omega=\\{\\omega_{1},...,\\omega_{k}\\} is arbitrage free. Then this model is complete if and only if the k\\times(n+1) matrix A given by A=\\left(\\begin{array}[]{cccccc}1+r&S_{1}^{1}(\\omega_{1})&\\cdot&\\cdot&\\cdot&S_{% 1}^{n}(\\omega_{1})\\\\ 1+r&S_{1}^{1}(\\omega_{2})&\\cdot&\\cdot&\\cdot&S_{1}^{n}(\\omega_{2})\\\\ \\cdot&\\cdot&&&&\\cdot\\\\ \\cdot&\\cdot&&&&\\cdot\\\\ \\cdot&\\cdot&&&&\\cdot\\\\ 1+r&S_{1}^{1}(\\omega_{k})&\\cdot&\\cdot&\\cdot&S_{1}^{n}(\\omega_{k})\\end{array}\\right) has the rank k , i.e. rank(A)=k . Proof. The model is complete if one can find a replicating strategy (x,\\phi) for any claim X . In other words, the model is complete if for any X\\in\\mathbb{R}^{k} there exists a solution to the system of linear equations: \\left(\\begin{array}[]{cccccc}1+r&S_{1}^{1}(\\omega_{1})&\\cdot&\\cdot&\\cdot&S_{1}% ^{n}(\\omega_{1})\\\\ 1+r&S_{1}^{1}(\\omega_{2})&\\cdot&\\cdot&\\cdot&S_{1}^{n}(\\omega_{2})\\\\ \\cdot&\\cdot&&&&\\cdot\\\\ \\cdot&\\cdot&&&&\\cdot\\\\ \\cdot&\\cdot&&&&\\cdot\\\\ 1+r&S_{1}^{1}(\\omega_{k})&\\cdot&\\cdot&\\cdot&S_{1}^{n}(\\omega_{k})\\end{array}% \\right)\\ \\left(\\begin{array}[]{c}x-\\sum_{i=1}^{n}\\phi^{i}S_{0}^{i}\\\\ \\phi^{1}\\\\ \\cdot\\\\ \\cdot\\\\ \\cdot\\\\ \\phi^{n}\\end{array}\\right)=\\left(\\begin{array}[]{c}V_{1}(x,\\phi)(\\omega_{1})\\\\ V_{1}(x,\\phi)(\\omega_{2})\\\\ \\cdot\\\\ \\cdot\\\\ \\cdot\\\\ V_{1}(x,\\phi)(\\omega_{k})\\end{array}\\right). This shows that computation of a replicating strategy for the contingent claim X is equivalent to solving the equation AZ=X , where Z is an n+1 dimentional vector: Z=\\left(\\begin{array}[]{c}x-\\sum_{i=1}^{n}\\phi^{i}S_{0}^{i}\\\\ \\phi^{1}\\\\ \\cdot\\\\ \\cdot\\\\ \\cdot\\\\ \\phi^{n}\\end{array}\\right). By standard linear algebra the matrix A has the rank k if and only if for every X\\in\\mathbb{R}^{k} the equation AZ=X has a solution Z\\in\\mathbb{R}^{n+1} . Hence the statement of the proposition follows immediately. ∎ Example 1.2.24. We have already seen that the stochastic volatility model discussed in Examples 1.2.15 and 1.2.19 is not complete. Another way to see this is by using Proposition 1.2.23. The matrix A in this case has the form A=\\left(\\begin{array}[]{cc}1+r&(1+h)S_{0}\\\\ 1+r&(1-h)S_{0}\\\\ 1+r&(1+l)S_{0}\\\\ 1+r&(1-l)S_{0}\\end{array}\\right) The rank of this matrix is 2 which is not equal to k=4 . Hence it doesn’t have full rank, and the model is incomplete. ∎ Proposition 1.2.23 presents a method to determine whether a model is complete without computing replicating strategies. Now, if the model is incomplete, is there a method to determine whether a specific contingent claim is attainable without trying to compute the replicating strategy? Yes, there is. The following proposition shows how. Proposition 1.2.25. The contingent claim X is attainable if and only if \\mathbb{E}_{\\mathbb{Q}}\\left(\\frac{1}{1+r}X\\right) takes the same value for all \\mathbb{Q}\\in\\mathbb{M} . The proof of this result can be found in Pliska ([1], page 23). We omit the proof here. An important consequence of this proposition is the following theorem: Theorem 1.2.26. Under the assumption that the model is arbitrage free, it is complete if and only if \\mathbb{M} consists of only one element, i.e. there is only one risk neutral measure. Proof. Since the model is arbitrage free, it follows from Theorem 1.2.8 that there is at least one risk neutral measure, i.e. \\mathbb{M}\\neq\\emptyset . Assume first that there is only one risk neutral measure. Then the condition in Proposition 1.2.25 is trivially satisfied for all contingent claims X and so the market model is complete. Assume now the market model is complete and there are two risk neutral measures \\mathbb{Q}_{1} and \\mathbb{Q}_{2} in \\mathbb{M} . For each i=1,..,k consider the contingent claim X^{i} given by X^{i}(\\omega)=\\left\\{\\begin{array}[]{cl}1+r,&\\mbox{ if }\\omega=\\omega_{i}\\\\ 0,&\\mbox{ otherwise }\\end{array}\\right. Since the model is complete, X^{i} is an attainable contingent claim. It follows from Remark 1.2.18 that \\mathbb{E}_{\\mathbb{Q}_{1}}\\left(\\frac{1}{1+r}X^{i}\\right)=\\mathbb{E}_{\\mathbb% {Q}_{2}}\\left(\\frac{1}{1+r}X^{i}\\right). But clearly, \\mathbb{Q}_{1}(\\omega_{i})=\\mathbb{E}_{\\mathbb{Q}_{1}}\\left(\\frac{1}{1+r}X^{i}% \\right),\\qquad\\mathbb{Q}_{2}(\\omega_{i})=\\mathbb{E}_{\\mathbb{Q}_{2}}\\left(% \\frac{1}{1+r}X^{i}\\right), which together implies that \\mathbb{Q}_{1}(\\omega_{i})=\\mathbb{Q}_{2}(\\omega_{i}) . Therefore \\mathbb{Q}_{1}=\\mathbb{Q}_{2} and we have hence shown, that \\mathbb{M} consists of only one risk neutral measure. ∎ 2. Multi-Period Market Models 2.1. General Model Specifications The two most important new features of multi period market models as compared to single period market models are: •​Agents can buy and sell assets not only at the beginning of the trading period, but at any time t out of a discrete set of trading times t\\in\\{0,1,2,...,T\\} . t=0 is the beginning of the trading period, t=T is the end. •​Agents can gather information over time, since they can observe prices. For example they can make their investments at time t=1 dependent on the prices of the asset at time 1 . These are unknown at time t=0 and couldn’t be used in order to choose the investment at time t=0 . These two aspects need special attention. We have to model trading as a dynamic process as opposed to the static trading approach in single period market models, and we have to take care about how the level of information evolves over time. The second aspect leads to the probabilistic concept of \\sigma -algebras and filtrations. We still assume that we work on a finite state space \\Omega on which a probability measure \\mathbb{P} is defined. Definition 2.1.1. A collection \\mathcal{F} of subsets of the state space \\Omega is called a \\sigma -algebra if the following conditions hold: (1)​ \\Omega\\in\\mathcal{F} (2)​If F\\in\\mathcal{F} then F^{c}=\\Omega\\setminus F\\in\\mathcal{F} (3)​If F_{i}\\in\\mathcal{F} for i\\in\\mathbb{N} , then \\bigcup_{i=1}^{\\infty}F_{i}\\in\\mathcal{F} . In our case, where the state space is finite, the third condition can be relaxed to condition (3’)​If F,G\\in\\mathcal{F} , then F\\cup G\\in\\mathcal{F} . There are a few properties that can be easily derived from the above definition: •​ \\emptyset\\in\\mathcal{F} , •​If F,G\\in\\mathcal{F} , then F\\cap G\\in\\mathcal{F} . To see the first one, notice that by 1. A=\\Omega\\in\\mathcal{F} . By virtue of 2. one gets A^{c}\\in\\mathcal{F} , but the compliment of the full space is an empty set, so \\emptyset=A^{c}\\in\\mathcal{F} . Take now F,G\\in\\mathcal{F} . It can be easily checked that F\\cap G=(F^{c}\\cup G^{c})^{c}. This reformulation will be very useful. By (2) we obtain F^{c},G^{c}\\in\\mathcal{F} . Further, their sum F^{c}\\cup G^{c} is an element of \\mathcal{F} (see (3’)). Applying (2) once more, we have (F^{c}\\cup G^{c})^{c}\\in\\mathcal{F} , which completes the proof of the second statement. The idea is that a \\sigma -algebra models a certain level of information. The elements of a \\sigma -algebra \\mathcal{F} are subsets of the state space \\Omega . Given that \\mathcal{F} is chosen to model the level of information of an agent or an observer of any kind, then it is assumed that this agent can distinguish between two sets F and G which belong to \\mathcal{F} , but not between the actual elements of F or the actual elements of G . In a way one could say, that if the agent looks at the state space \\Omega his resolution is not high enough to recognise the actual states \\omega but only to see the sets belonging to the \\sigma -algebra \\mathcal{F} . One can think of the states \\omega as atoms, and as the sets contained in the \\sigma -algebra as molecules, which are built from the atoms. The agent can only see the molecules, but not the atoms. The larger the \\sigma -algebra, the higher the resolution is, the more information is in the \\sigma -algebra. A \\sigma -algebra on a finite state space can be decomposed into a so called partition: Definition 2.1.2. A partition of a \\sigma -algebra \\mathcal{F} is a collection of sets \\{A_{i}:i\\in I\\} , where I is some index set, such that: (1)​ A_{i}\\neq\\emptyset for i\\in I . (2)​ A_{i}\\in\\mathcal{F} for i\\in I . (3)​Every set F\\in\\mathcal{F} can be written as a union of some of the A_{i} ’s, i.e. F=\\bigcup_{j\\in J}A_{j} with J\\subset I . (4)​Sets A_{i} are pairwise disjoint, i.e. A_{i}\\cap A_{j}=\\emptyset whenever i\\neq j . The set I can be thought of as a set of integers 1,2,\\ldots,N for some N . Therefore, a partition is a collection of sets A_{1},A_{2},\\ldots,A_{N} satisfying conditions (1)-(4) of Definition 2.1.2. It can be easily deduced that all sets A_{i} in a partition satisfy a certain minimality condition: if A\\in\\mathcal{F} and A\\subset A_{j} for some j , then A=A_{j} , since otherwise it could not be written as a union of some of the A_{i} ’s (a contradiction with (3)). It is not hard to show that given a \\sigma -algebra \\mathcal{F} , a partition for this \\sigma -algebra always exist and is in fact unique. Example 2.1.3. (1)​If \\Omega is a finite state space, then the power set \\mathcal{P}(\\Omega) is a \\sigma -algebra. This is the largest possible \\sigma -algebra on \\Omega , but beware: If \\Omega is not finite, then the power set of \\Omega is not a \\sigma -algebra! The partition of \\mathcal{F} consists of sets \\{\\omega\\} for all \\omega\\in\\Omega . (2)​The trivial \\sigma -algebra corresponding to a state space \\Omega is the \\sigma -algebra \\mathcal{F}=\\{\\emptyset,\\Omega\\} . This clearly satisfies the conditions in Definition 2.1.1. The trivial \\sigma -algebra is the smallest \\sigma -algebra on \\Omega . Here, the partition is composed from one set \\Omega . (3)​On a state space \\Omega=\\{\\omega_{1},\\omega_{2},\\omega_{3},\\omega_{4}\\} consisting of four elements, the following is a \\sigma -algebra: \\mathcal{F}=\\{\\emptyset,\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_{4}\\},% \\Omega\\}. This can be easily verified. A partition of this \\sigma -algebra, is given by the two sets A_{1}=\\{\\omega_{1},\\omega_{2}\\} and A_{2}=\\{\\omega_{3},\\omega_{4}\\} . (4)​For a collection F_{i}\\subset\\Omega for i\\in I , one can show that there is always the smallest \\sigma -algebra which contains the sets F_{i} . This \\sigma -algebra is denoted by \\sigma\\left(F_{i}:i\\in I\\right) and is called the \\sigma -algebra generated by the sets F_{i} . ∎ Let us now consider a random variable X:\\Omega\\to\\mathbb{R} (we can think of a contingent claim). It is \\mathcal{F} -measurable if its values depend only on information in \\mathcal{F} . This is a general mathematical definition: Definition 2.1.4. The random variable X:\\Omega\\to\\mathbb{R} is called \\mathcal{F} -measurable, if for every closed interval [a,b]\\subset\\mathbb{R} the preimage under X belongs to \\mathcal{F} , i.e. X^{-1}([a,b])\\in\\mathcal{F}. It is rather difficult to imagine and check. However, we can provide a simpler reformulation in our case of finite state space \\Omega . It is based on the observation that the set of values of X is finite. Proposition 2.1.5. Let X:\\Omega\\to\\mathbb{R} be a random variable and (A_{i})_{i\\in I} a partition of the \\sigma -algebra \\mathcal{F} . The random variable X is \\mathcal{F} -measurable, if and only if X is constant on each set of the partition, i.e. there exist c_{j}\\in\\mathbb{R} for all j\\in I such that X(\\omega)=c_{j}\\mbox{ for all }\\omega\\in A_{j}. Proof. Assume (A_{i})_{i\\in I} is a partition of the \\sigma -algebra \\mathcal{F} and that X is \\mathcal{F} -measurable. Let j\\in I be an index and \\omega\\in A_{j} be arbitrary. Define c_{j}:=X(\\omega) . Since X is \\mathcal{F} -measurable, we have X^{-1}(c_{j})\\in\\mathcal{F} and hence by remarks following the definition of a \\sigma -algebra, we have \\emptyset\\neq X^{-1}(c_{j})\\cap A_{j}\\in\\mathcal{F}. Since clearly X^{-1}(c_{j})\\cap A_{j}\\subset A_{j} , we have by the aforementioned minimality property of the sets contained in the partition that X^{-1}(c_{j})\\cap A_{j}=A_{j}. But this means nothing else than X(\\omega)=c_{j} for all \\omega\\in A_{j} and hence X is constant on A_{j} . By varying j we obtain such c_{j} ’s for all j\\in I . Now assume vice versa, that X:\\Omega\\to\\mathbb{R} is a function which is constant on all sets A_{j} belonging to the partition and that the c_{j} are given as in the statement of the proposition. Let [a,b] be a closed interval in \\mathbb{R} and define C:=\\{c_{j}|j\\in I\\mbox{ and }c_{j}\\in[a,b]\\}. Since \\bigcup_{i\\in I}A_{i}=\\Omega no other elements then the c_{j} occur as values of X . Therefore X^{-1}([a,b])=X^{-1}(C)=\\bigcup_{j|c_{j}\\in C}X^{-1}(c_{j})=\\bigcup_{j|c_{j}% \\in C}A_{j}. Finally, due to property 3. of a \\sigma -algebra we have \\bigcup_{j|c_{j}\\in C}A_{j}\\in\\mathcal{F}. ∎ In the proposition above, it is not assumed that the c_{j} ’s all have different values. In fact, some of them may coincide. Example 2.1.6. (1)​If \\Omega is a finite state space and \\mathcal{F}=\\mathcal{P}(\\Omega) is a power \\sigma -algebra, then every random variable X:\\Omega\\to\\mathbb{R} is \\mathcal{F} -measurable. (2)​A random variable that is measurable with respect to a trivial \\sigma -algebra is constant, i.e. its set of values consists of exactly one point. (3)​On a state space \\Omega=\\{\\omega_{1},\\omega_{2},\\omega_{3},\\omega_{4}\\} consider a \\sigma -algebra \\mathcal{F} given by the partition A_{1}=\\{\\omega_{1},\\omega_{2}\\} and A_{2}=\\{\\omega_{3},\\omega_{4}\\} . Then every random variable that is \\mathcal{F} -measurable satisfies X(\\omega_{1})=c_{1},\\quad X(\\omega_{2})=c_{1},\\quad X(\\omega_{3})=c_{2},\\quad X% (\\omega_{4})=c_{2}, for some numbers c_{1},c_{2} . (4)​On a finite state space \\Omega consider a random variable X:\\Omega\\to\\mathbb{R} . A \\sigma -algebra generated by X is given by a partition \\big{\\{}X^{-1}(c):\\text{ $c$ is a value of $X$}\\big{\\}}. This partition is finite, because X can only attain a finite number of values. Moreover, \\mathcal{F} is the smallest \\sigma -algebra with respect to which X is measurable (check it!). ∎ The main idea behind the notion of a filtration is to model the development of information in time. A filtration is a sequence of \\sigma -algebras. We assume that information can only increase in time, i.e. we never forget anything! Definition 2.1.7. A sequence (\\mathcal{F}_{t})_{0\\leq t\\leq T} of \\sigma -algebras on \\Omega is called a filtration, if \\mathcal{F}_{s}\\subset\\mathcal{F}_{t} whenever s<t . We interpret the \\sigma -algebra \\mathcal{F}_{t} as the information which is available to an agent or an observer at time t . In particular \\mathcal{F}_{0} represents the information which is available at the beginning of the period before anything else has started. This is, in a way, the initial information. Usually we know everything about the present state of the market, i.e. the prices of assets. Therefore, we will be assume that \\mathcal{F}_{0} is a trivial \\sigma -algebra \\mathcal{F}_{0}=\\{\\emptyset,\\Omega\\} . To model a dynamic random behaviour of some quantities (e.g. asset prices), we introduce the concept of stochastic processes, which are sequences of random variables in time. Definition 2.1.8. A family (X_{t}) , where 0\\leq t\\leq T , consisting of random variables is called a stochastic process. If (\\mathcal{F}_{t})_{0\\leq t\\leq T} is a filtration, the stochastic process (X_{t}) is called (\\mathcal{F}_{t}) -adapted if for all t we have that X_{t} is \\mathcal{F}_{t} -measurable. We shall often write “process” instead of stochastic process. If it is clear from the context which filtration is meant, we shall also write “adapted” instead of (\\mathcal{F}_{t}) -adapted. The stochastic process (X_{t}) is therefore adapted, if and only if its time t component X_{t} depends only on the information which is available at time t , i.e. \\mathcal{F}_{t} . Example 2.1.9. An ideal example of a stochastic process is the evolution of stock prices. We denote the stock price at times 0\\leq t\\leq T with S_{t} . Since these prices are not known at time 0 , based on the initial information, S_{t} are assumed to be random variables for t\\geq 1 : S_{t}:\\Omega\\to\\mathbb{R}_{+}. At time t however we know the price of S_{t} (i.e. it is a part of the information available to us) and we therefore assume that S_{t} is \\mathcal{F}_{t} -measurable. We therefore model the stock price evolution as an adapted process (S_{t}) , where the filtration (\\mathcal{F}_{t}) is otherwise specified. ∎ In the above example we discussed the requirements for the price process so that is complies with the information structure we have. It is usually assumed that the only information we get comes from the prices themselves. Below, we present a general method how to obtain a filtration, such that the process in question is measurable with respect to this filtration, and the filtration represents the information flow which is induced by observing the stochastic process. Definition 2.1.10. Let (X_{t})_{0\\leq t\\leq T} be a stochastic process on (\\Omega,\\mathbb{P}) . Define \\boxed{\\mathcal{F}_{t}^{X}:=\\sigma\\left(X_{u}^{-1}([a,b]):0\\leq u\\leq t,a\\leq b% \\in\\mathbb{R}\\right)} (2.1.1) This is the smallest \\sigma -algebra which contains all the sets X_{u}^{-1}([a,b]) where 0\\leq u\\leq t and a\\leq b . Clearly \\mathcal{F}_{s}^{X}\\subset\\mathcal{F}_{t}^{X} and (\\mathcal{F}_{t}^{X})_{0\\leq t\\leq T} is a filtration. It follows immediately from the definition that (X_{t})_{0\\leq t\\leq T} is (\\mathcal{F}_{t}^{X})_{0\\leq t\\leq T} -adapted. (\\mathcal{F}_{t}^{X})_{0\\leq t\\leq T} is called the filtration generated by the process X . Let us make the above definition more understandable. First, (2.1.1) reads as \\mathcal{F}^{X}_{t}=\\{\\text{the information generated by $X_{0},X_{1},\\ldots,X% _{t}$}\\}. We know how to extract the information carried by one random variable (see Example 2.1.6). Here, we have t+1 random variables. Let \\mathcal{G}_{i} be the \\sigma -algebra generated by X_{i} , i=0,1,\\ldots,t . Then \\mathcal{F}^{X}_{t} is the smallest \\sigma -algebra containing \\mathcal{G}_{0},\\mathcal{G}_{1},\\ldots,\\mathcal{G}_{t} . It means that we put all sets from collections \\mathcal{G}_{0},\\ldots,\\mathcal{G}_{t} into one bag called \\mathcal{G} and look for a smallest collection of sets (A_{i})_{i\\in I} , for some set of indexes I , that satisfies (1)​ A_{i}\\neq\\emptyset for i\\in I . (2)​Every set G\\in\\mathcal{G} can be written as a union of some of the A_{i} ’s, i.e. G=\\bigcup_{j\\in J}A_{j} with J\\subset I . (3)​Sets A_{i} are pairwise disjoint, i.e. A_{i}\\cap A_{j}=\\emptyset whenever i\\neq j . Actually, we can put into \\mathcal{G} solely the partitions of \\mathcal{G}_{0},\\ldots,\\mathcal{G}_{t} . Notice that above conditions resemble those from Definition 2.1.2. Indeed, it is true that \\mathcal{F}^{X}_{t} is the \\sigma -algebra whose partition is given by (A_{i})_{i\\in I} . Let us illustrate these concepts in the following example which models the stock price evolution over two periods. Example 2.1.11. The following diagram describes the evolution of a single stock over the period of two time steps: The underlying probability space is given by \\Omega=\\{\\omega_{1},\\omega_{2},\\omega_{3},\\omega_{4}\\} . The numbers at the arrows indicate the probabilities by which this move happens. At time t=0 the stock price is known, and there is only one possible value S_{0}=5 . The \\sigma -algebra \\mathcal{F}_{0}^{S} is therefore the trivial \\sigma -algebra. At time t=1 the stock can take two possible values. The following is easy to verify: \\displaystyle S_{1}^{-1}([a,b])=\\left\\{\\begin{array}[]{cl}\\Omega&\\mbox{ if }a% \\leq 4\\mbox{ and }8\\leq b\\\\ \\{\\omega_{1},\\omega_{2}\\}&\\mbox{ if }4<a\\mbox{ and }8\\leq b\\\\ \\{\\omega_{3},\\omega_{4}\\}&\\mbox{ if }a\\leq 4\\mbox{ and }b<8\\\\ \\emptyset&\\mbox{ if }a<4\\mbox{ and }b<4.\\end{array}\\right. These are all cases which can occur, and therefore \\mathcal{F}_{1}^{S}=\\{\\emptyset,\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_% {4}\\},\\Omega\\}. The observing agent at time t=1 is therefore able to decide, whether the true state of the world belongs to the set \\{\\omega_{1},\\omega_{2}\\} or to the set \\{\\omega_{3},\\omega_{4}\\} , but in neither case is he able to decide, whether it is \\omega_{1} or \\omega_{2} in the first case, or \\omega_{3} or \\omega_{4} in the second case. However he learns the true state of the world at time t=2 . The reason for this is as follows: \\mathcal{F}_{2}^{S} must contain the sets F_{1}:=S_{2}^{-1}([9,10])=\\{\\omega_{1}\\} , F_{2}:=S_{2}^{-1}([6,9])=\\{\\omega_{1},\\omega_{2},\\omega_{3}\\} , F_{3}:=S_{2}^{-1}([5,6])=\\{\\omega_{2},\\omega_{3}\\} and F_{4}:=S_{1}^{-1}([6,9])=\\{\\omega_{1},\\omega_{2}\\} and since \\mathcal{F}_{2}^{S} is a \\sigma -algebra it must therefore also contain: \\{\\omega_{1}\\}=F_{4}\\cap F_{1},\\{\\omega_{2}\\}=F_{3}\\cap F_{4},\\{\\omega_{3}\\}=F% _{2}\\setminus F_{4} and \\{\\omega_{4}\\}=F_{2}^{c} . Let us now use the second method to obtain the above filtration. First, if t=0 , \\mathcal{F}^{S}_{0} is generated by S_{0} , so it is trivial. For t=1 denote by \\mathbb{G}_{0} a partition of the \\sigma -algebra generated by S_{0} , and by \\mathbb{G}_{1} a partition of the \\sigma -algebra generated by S_{1} : \\displaystyle\\mathbb{G}_{0} \\displaystyle=\\{\\Omega\\}, \\displaystyle\\mathbb{G}_{1} \\displaystyle=\\big{\\{}\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_{4}\\}\\big{% \\}}. Notice that the partition \\mathbb{G}_{1} is finer than the partition \\mathbb{G}_{0} (every set in the partition \\mathbb{G}_{0} can be obtained as a union of some sets from the partition \\mathbb{G}_{1} ). The partition of \\mathcal{F}^{S}_{1} is then equal to \\big{\\{}\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_{4}\\}\\big{\\}} and \\mathcal{F}_{1}^{S}=\\{\\emptyset,\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_% {4}\\},\\Omega\\}. Let \\mathbb{G}_{2} be a partition of the \\sigma -algebra generated by S_{2} : \\mathbb{G}_{2}=\\big{\\{}\\{\\omega_{1}\\},\\{\\omega_{2},\\omega_{3}\\},\\{\\omega_{4}\\}% \\big{\\}}. We cannot use the same argument as above: \\mathbb{G}_{2} is not finer than \\mathbb{G}_{1} . However, let us put into one bag all sets from \\mathbb{G}_{0} , \\mathbb{G}_{1} and \\mathbb{G}_{2} : \\big{\\{}\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_{4}\\},\\{\\omega_{1}\\},\\{% \\omega_{2},\\omega_{3}\\},\\{\\omega_{4}\\},\\Omega\\big{\\}}. Now, following the algorithm, we need to find the smallest collection of disjoint sets (A_{i}) such that every set above can be represented as a union of some of them. Obviously, this collection is given by \\big{\\{}\\{\\omega_{1}\\},\\{\\omega_{2}\\},\\{\\omega_{3}\\},\\{\\omega_{4}\\}\\big{\\}}, which implies that the partition of \\mathcal{F}^{S}_{2} is equal to \\big{\\{}\\{\\omega_{1}\\},\\{\\omega_{2}\\},\\{\\omega_{3}\\},\\{\\omega_{4}\\}\\big{\\}} and \\mathcal{F}^{S}_{2} is a power \\sigma -algebra. ∎ Remark 2.1.12 (Procedure to join partitions). In the previous example, after we observe that \\mathbb{G}_{2} is not finer than \\mathcal{F}_{1}^{S} (since, for example, \\{\\omega_{1},\\omega_{2}\\}\\in\\mathcal{F}_{1}^{S} cannot be written as a union of elements from \\mathbb{G}_{2} ), we might want to follow a “recipe” to determine what \\mathcal{F}_{2}^{S} has to be. One such procedure can be seen in Algorithm 1. Algorithm 1 Algorithm for joining two partitions. Let us now apply Algorithm 1 to the two partitions from Example 2.1.11. We will therefore use partition \\mathbb{G}_{2} and the partition of \\mathcal{F}^{S}_{1} (which in this case is precisely \\mathbb{G}_{1} ). We set A:=\\mathbb{G}_{1}\\cup\\mathbb{G}_{2}=\\{\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},% \\omega_{4}\\}\\}\\cup\\{\\{\\omega_{1}\\},\\{\\omega_{2},\\omega_{3}\\},\\{\\omega_{4}\\}\\} according to Line 1, which is equal to \\{\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_{4}\\},\\{\\omega_{1}\\},\\{\\omega_% {2},\\omega_{3}\\},\\{\\omega_{4}\\}\\}. Note that this union is not a partition anymore, since the sets are not disjoint! We now repeat the rest of the procedure, starting in Line 3, until A is left empty. (1)​We start by setting x\\leftarrow\\{\\omega_{1}\\} according to Line 4. Since P is currently empty, Line 5 does not apply. We compare x to the remaining sets of A . Since it is not disjoint from \\{\\omega_{1},\\omega_{2}\\}\\in A , the condition in Line 7 is also not satisfied, so we proceed to Line 11. According to Line 13, we first remove \\{\\omega_{1}\\} from A and by Line 14 check it against all other sets in A . Line 15 is satisfied for y\\leftarrow\\{\\omega_{1},\\omega_{2}\\} , so we first add \\{\\omega_{1},\\omega_{2}\\}\\backslash\\{\\omega_{1}\\}=\\{\\omega_{2}\\} and \\{\\omega_{1},\\omega_{2}\\}\\cap\\{\\omega_{1}\\}=\\{\\omega_{1}\\} to A (Line 16), before removing \\{\\omega_{1},\\omega_{2}\\} from A . Notice that we have removed and then added again \\{\\omega_{1}\\} to A . This is normal. At the end of the first iteration of the loop in Line 3, P is still empty and A=\\{\\{\\omega_{3},\\omega_{4}\\},\\{\\omega_{1}\\},\\{\\omega_{2},\\omega_{3}\\},\\{% \\omega_{4}\\},\\{\\omega_{2}\\}\\}. (2)​We restart the loop and set x\\leftarrow\\{\\omega_{1}\\} according to Line 4 again. This time the condition in Line 7 is satisfied, so we remove \\{\\omega_{1}\\} from A and add it to P . At this stage, P=\\{\\{\\omega_{1}\\}\\} and A=\\{\\{\\omega_{3},\\omega_{4}\\},\\{\\omega_{2},\\omega_{3}\\},\\{\\omega_{4}\\},\\{% \\omega_{2}\\}\\}. (3)​We restart the loop and set x\\leftarrow\\{\\omega_{2}\\} . As in Step (1), x is not disjoint from other sets still in A , so we perform the steps of the else statement from Line 11. This makes us remove \\{\\omega_{2}\\} from A , followed by removing \\{\\omega_{2},\\omega_{3}\\} from A , before adding \\{\\omega_{2}\\} again together with \\{\\omega_{3}\\} to A . P remains unchanged and A=\\{\\{\\omega_{3},\\omega_{4}\\},\\{\\omega_{4}\\},\\{\\omega_{2}\\},\\{\\omega_{3}\\}\\}. (4)​We restart the loop and set x\\leftarrow\\{\\omega_{2}\\} according to Line 4 again. As in Step (2), x is now disjoint from the rest of the sets in A , so according to Line 7 it is removed from A and added to P . P is now equal to \\{\\{\\omega_{1}\\},\\{\\omega_{2}\\}\\} and A=\\{\\{\\omega_{3},\\omega_{4}\\},\\{\\omega_{4}\\},\\{\\omega_{3}\\}\\}. (5)​We restart the loop again, picking x\\leftarrow\\{\\omega_{3}\\} . Using the same reasoning as before, this first results in A=\\{\\{\\omega_{4}\\},\\{\\omega_{3}\\}\\} , followed by moving \\{\\omega_{3}\\} from A to P according to Line 7. (6)​The procedure concludes by moving \\{\\omega_{4}\\} from A to P according to Line 7, which means that A is now empty and the while loop in Line 3 doesn’t repeat. If we had taken the elements of A in a different order, the intermediate stages of A and P could look different. The final state of A and P would however remain unchanged. Previous page Next page"],[["index.html","Pt5.html"],"Lecture V 29/10/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 29/10/2024 Lecture V 29/10/2024 In order to specify our market model, we still have to define what trading strategies the agents in our model are allowed to use in order to trade on the market. As in Chapter 1 we assume that the market consists of a money market account (e.g. a bond) denoted by B , which evolves deterministically as B_{t+k}=B_{t}(1+r)^{k} , where r is the interest rate (we can assume that B_{0}=1 without loss of generality), and n stocks S^{1},\\ldots,S^{n} , which are assumed to be stochastic processes on the underlying state space. A trading strategy is then given by an \\mathbb{R}^{n+1} valued stochastic process (\\phi_{t})_{t=0,\\ldots,T} whose components are denoted \\phi_{t}^{0},\\phi_{t}^{1},...,\\phi_{t}^{n} and where \\phi_{t}^{i} denotes the number of shares of the i -th stock hold at time t and \\phi_{t}^{0} the number of bonds at time t . Definition 2.1.13. The value process corresponding to the trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T-1} is the stochastic process \\big{(}V_{t}(\\phi)\\big{)}_{0\\leq t\\leq T} , where Vt⁢(ϕ)=ϕt0⁢Bt+∑i=1nϕti⁢Sti,t=0,…,T. It is unreasonable to allow all trading strategies. In particular, the choice of investment should be based on the available information and the capital in possession. Definition 2.1.14. A trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} is called (\\mathcal{F}_{t}) -adapted, if the stochastic process (\\phi_{t})_{0\\leq t\\leq T} is adapted to the filtration (\\mathcal{F}_{t})_{0\\leq t\\leq T} . Definition 2.1.15. A trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} is called self financing, if for all t=0,...,T-1 \\boxed{\\displaystyle\\phi_{t}^{0}B_{t+1}+\\sum_{i=1}^{n}\\phi_{t}^{i}S_{t+1}^{i}=% \\phi_{t+1}^{0}B_{t+1}+\\sum_{i=1}^{n}\\phi_{t+1}^{i}S_{t+1}^{i}.} (2.1.3) An agent who invests according to a self-financing portfolio, invests money into the strategy in time t=0 and in the following moments only rebalances his portfolio, neither withdrawing any money out of the market, nor investing new money into the market. The agent chooses his investments at time t and does not change his portfolio in the time interval [t,t+1) . The left-hand side of equation (2.1.3) represents the value of the agents portfolio immediately before time t+1 , whereas the right-hand side represents the value of his portfolio immediately after time t+1 , when rebalancing of his portfolio has taken place. The self financing assumption says that these two values must be equal, and this means that neither money is withdrawn nor new money is invested. We are now able to set up our general multi period market model: Definition 2.1.16. A general multi period market model is given by the following data: (1)​A probability space (\\Omega,\\mathbb{P}) with the filtration (\\mathcal{F}_{t})_{t=0,\\ldots,T} . (2)​A money market account (B_{t}) , which evolves according to B_{t}=(1+r)^{t} . (3)​A collection of n financial assets whose prices are given by stochastic processes \\big{(}(S_{t}^{1}),...,(S_{t}^{n})\\big{)}_{t=0,\\ldots,T}, which are assumed to be (\\mathcal{F}_{t}) -adapted. (4)​A set \\mathcal{T} of self financing and (\\mathcal{F}_{t}) -adapted trading strategies. In practical applications the filtration \\mathcal{F}_{t} is often taken to be generated by the prices of assets, so that it represents only the information that can be learnt from the market. Following Definition 2.1.10 we know how to construct such a filtration for one stochastic process ( n=1 ). If n>1 , it is easiest to consider the approach following Definition 2.1.10 and to make use of partitions. If the filtration (\\mathcal{F}_{t}) is generated by \\big{(}(S_{t}^{1}),...,(S_{t}^{n})\\big{)}_{t=0,\\ldots,T} , then \\mathcal{F}_{t}=\\{\\text{the information generated by $S^{i}_{j}$, $i=1,\\ldots,% n$, $j=0,\\ldots,t$}\\}. As before we put all sets from the partitions of \\sigma -algebras generated by S^{i}_{j} , i=1,\\ldots,n , j=0,\\ldots,t into one bag denoted by \\mathcal{G} . We find the smallest collection of sets (A_{i})_{i\\in I} , for some set of indexes I , that satisfies (1)​ A_{i}\\neq\\emptyset for i\\in I . (2)​Every set G\\in\\mathcal{G} can be written as a union of some of the A_{i} ’s, i.e. G=\\bigcup_{j\\in J}A_{j} with J\\subset I . (3)​Sets A_{i} are pairwise disjoint, i.e. A_{i}\\cap A_{j}=\\emptyset whenever i\\neq j . We claim that this collection is a partition for \\mathcal{F}_{t} (check it!). Example 2.1.17. Consider a diagram given in Example 2.1.11. The underlying probability space is \\Omega=\\{\\omega_{1},\\omega_{2},\\omega_{3},\\omega_{4}\\} . The physical measure is encoded in the diagram above the arrows: \\displaystyle\\mathbb{P}(\\omega_{1}) \\displaystyle=\\frac{2}{5}\\cdot\\frac{3}{4},\\qquad\\mathbb{P}(\\omega_{2})=\\frac{2% }{5}\\cdot\\frac{1}{4}, \\displaystyle\\mathbb{P}(\\omega_{3}) \\displaystyle=\\frac{3}{5}\\cdot\\frac{2}{7},\\qquad\\mathbb{P}(\\omega_{4})=\\frac{3% }{5}\\cdot\\frac{5}{7}. The filtration generated by the asset prices has been determined as \\begin{split}\\mathcal{F}_{0}&=\\{\\emptyset,\\Omega\\},\\\\ \\mathcal{F}_{1}&=\\{\\emptyset,\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_{4}% \\},\\Omega\\},\\\\ \\mathcal{F}_{2}&=\\big{\\{}\\emptyset,\\\\ &\\hskip 28.0pt\\{\\omega_{1}\\},\\{\\omega_{2}\\},\\{\\omega_{3}\\},\\{\\omega_{4}\\},\\\\ &\\hskip 28.0pt\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{1},\\omega_{3}\\},\\{\\omega_{1}% ,\\omega_{4}\\},\\{\\omega_{2},\\omega_{3}\\},\\{\\omega_{2},\\omega_{4}\\},\\{\\omega_{3}% ,\\omega_{4}\\},\\\\ &\\hskip 28.0pt\\{\\omega_{1},\\omega_{2},\\omega_{3}\\},\\{\\omega_{1},\\omega_{2},% \\omega_{4}\\},\\{\\omega_{1},\\omega_{3},\\omega_{4}\\},\\{\\omega_{2},\\omega_{3},% \\omega_{4}\\},\\\\ &\\qquad\\Omega\\big{\\}}.\\end{split} ∎ It is often useful to represent the self financing condition in terms of the (multi period) gains process. Definition 2.1.18. Assume we are given a general multi period market model as described in Definition 2.1.13. The increment process (\\Delta S_{t}^{i})_{1\\leq t\\leq T} corresponding to the i -th stock is defined by \\boxed{\\displaystyle\\Delta S_{t}^{i}:=S^{i}_{t}-S^{i}_{t-1},\\qquad t=1,...,T.} (2.1.4) The increments of the money market account are given by \\Delta B_{t}=B_{t}-B_{t-1}=(1+r)^{t-1}r=B_{t-1}r,\\qquad t=1,\\ldots,T. Given a trading strategy \\phi , the corresponding gains process (G_{t}(\\phi))_{0\\leq t\\leq T} is given by G_{0}(\\phi)=0 and \\boxed{\\displaystyle G_{t}(\\phi)=\\sum_{s=0}^{t-1}\\phi_{s}^{i}\\Delta B_{s+1}+% \\sum_{i=1}^{n}\\sum_{s=0}^{t-1}\\phi_{s}^{i}\\Delta S^{i}_{s+1},\\qquad t=1,\\ldots% ,T.} (2.1.5) As in the single period market models, it is worthwhile to consider discounted counterparts of the price process, gains process and value process: Definition 2.1.19. Given a general multi period market model, the discounted prices are given by \\boxed{\\displaystyle\\hat{S}_{t}^{i}=\\frac{S_{t}^{i}}{B_{t}},} (2.1.6) the discounted gains by \\boxed{\\displaystyle\\Delta\\hat{S}_{t}^{i}=\\hat{S}_{t}^{i}-\\hat{S}_{t-1}^{i},} (2.1.7) the discounted value process corresponding to a trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} by \\boxed{\\displaystyle\\hat{V}_{t}(\\phi)=\\frac{V_{t}(\\phi)}{B_{t}},} (2.1.8) and the discounted gains process corresponding to a trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} by \\hat{G}_{0}(\\phi)=0 and \\boxed{\\displaystyle\\hat{G}_{t}(\\phi)=\\sum_{i=1}^{n}\\sum_{s=0}^{t-1}\\phi_{s}^{% i}\\Delta\\hat{S}_{s+1}^{i},\\qquad t=1,\\ldots,T.} (2.1.9) The self financing condition (2.1.3) states that changes of the amount of capital invested are caused only by gains or losses incurred by investments in the market. Below is a formal statement of this intuition: Proposition 2.1.20. An adapted trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} is self financing, if and only if any of the two equivalent statements holds (1)​ V_{t}(\\phi)=V_{0}(\\phi)+G_{t}(\\phi), for all 0\\leq t\\leq T . (2)​ \\hat{V}_{t}(\\phi)=\\hat{V}_{0}(\\phi)+\\hat{G}_{t}(\\phi), for all 0\\leq t\\leq T . Proof. Exercise ! ∎ 2.2. Properties of the general multi period market model In this section we redefine the general concepts of financial mathematics, such as arbitrage, hedging etc. in the framework of multi period market models. This is also a good repetition. Definition 2.2.1. A trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} in a general multi period market model is called an arbitrage if (1)​ V_{0}(\\phi)=0 (2)​ V_{T}(\\phi)\\geq 0 (3)​ \\mathbb{E}(V_{T}(\\phi))>0 As in a single period market model condition 3. can be replaced by: (3’)​there exists \\omega\\in\\Omega such that V_{T}(\\phi)(\\omega)>0 . Furthermore one can use the discounted value process or the discounted gains process in order to express the arbitrage conditions. We come back to the notion of a contingent claim and a hedging (replicating) strategy: Definition 2.2.2. A contingent claim in a multi period market model is an \\mathcal{F}_{T} -measurable random variable X on \\Omega representing a payoff at the terminal time T . A hedging strategy for X is a trading strategy \\phi\\in\\mathcal{T} s.t. V_{T}(\\phi)=X, i.e. the terminal value of the trading strategy is equal to the payoff of the contingent claim. In a multi period market model it is reasonable to look for the price of a contingent claim in any time t<T . This certainly includes t=0 . Therefore, instead of of talking about a price of the contingent claim we shall talk about a price process of the contingent claim. We start with an application of the replication principle. If X is a contingent claim and \\phi is the hedge for X then V_{t}(\\phi) is a proper price process of X . We will see later (Proposition 2.4.5) that this is the only price that does not introduce arbitrage opportunities in the market. Example 2.2.3. Let us consider the two period model from Example 2.1.11: We assume that the interest rate is equal to zero, i.e. B_{t}=1 for t=0,1,2 . We consider a digital call in this model, which pays 1 , if the stock price at time t=2 is greater or equal than 8 , i.e. X(\\omega)=\\begin{cases}1,&S_{2}(\\omega)\\geq 8,\\\\ 0,&S_{2}(\\omega)<8.\\end{cases} In this model the contingent claim X pays off 1 if and only if the state of the world is \\omega_{1} : X(\\omega)=\\begin{cases}1,&\\omega=\\omega_{1},\\\\ 0,&\\text{otherwise.}\\end{cases} How can one find a self financing hedging strategy for X , i.e. a self financing strategy satisfying V_{2}(\\phi)(\\omega)=\\phi_{2}^{0}(\\omega)+\\phi_{2}^{1}(\\omega)S_{2}(\\omega)=X(% \\omega). Since there are four states of the world, these are four equations for the eight variables \\phi_{2}^{0}(\\omega_{i}) and \\phi_{2}^{1}(\\omega_{i}) . The solution may not be unique. However, because of the self financing condition, we have \\phi_{2}^{0}(\\omega)+\\phi_{2}^{1}(\\omega)S_{2}(\\omega)=\\phi_{1}^{0}(\\omega)+% \\phi_{1}^{1}(\\omega)S_{2}(\\omega) so the same equations hold for the \\phi_{1}^{0}(\\omega) ’s and \\phi_{1}^{1}(\\omega) ’s: \\phi_{1}^{0}(\\omega)+\\phi_{1}^{1}(\\omega)S_{2}(\\omega)=X(\\omega). Therefore if we use self financing trading strategies the terminal share holdings \\phi_{T} does not play any role: e.g. we can simply choose the \\phi_{2}^{0}(\\omega) ’s and \\phi_{2}^{1}(\\omega) ’s equal to the \\phi_{1}^{0}(\\omega) ’s and \\phi_{1}^{1}(\\omega) ’s. The trick now is to decompose the model into single period market models. In this case we have three, one starting at time t=0 going until time t=1 with price S_{0}=5 , one starting at time t=1 with price S_{1}=8 and one starting at time t=1 with price S_{1}=4 . Let us first solve the hedging problem in the t=1 model with S_{1}=8 : This model is in fact an elementary single period market model, as in Section 1.1 and therefore the Delta hedging formula (1.1.3) applies. Denoting the still unknown hedging strategy with \\phi=(\\phi_{t})_{0\\leq t\\leq 2} we find \\phi_{1}^{1}(\\omega)=\\frac{1-0}{9-6}=\\frac{1}{3},\\qquad\\text{for }\\omega=% \\omega_{1},\\omega_{2}. In this case, the rest of the money available at time t=1 , i.e. V_{1}(\\phi)-\\frac{1}{3}\\cdot 8 is invested in the money market account. Let us compute V_{1}(\\phi) . Since \\phi is a hedge, we have \\displaystyle\\left(V_{1}(\\phi)(\\omega_{1})-\\frac{1}{3}\\cdot 8\\right)+\\frac{1}{% 3}\\cdot 9 \\displaystyle= \\displaystyle 1 \\displaystyle\\left(V_{1}(\\phi)(\\omega_{2})-\\frac{1}{3}\\cdot 8\\right)+\\frac{1}{% 3}\\cdot 6 \\displaystyle= \\displaystyle 0. These equations are satisfied for V_{1}(\\phi)(\\omega_{1})=\\frac{2}{3}=(V_{1}(\\phi)(\\omega_{2}) . Equality of the value process under the two states \\omega_{1} and \\omega_{2} is no coincidence, it is a must, because V_{1}(\\phi) has to be \\mathcal{F}_{1}^{S} measurable (it results from Definition 2.1.13). We then have \\phi_{1}^{0}(\\omega)=\\frac{2}{3}-\\frac{1}{3}\\cdot 8=-2,\\qquad\\text{for }\\omega% =\\omega_{1},\\omega_{2}. Let us now come to the hedging problem at time t=1 when the stock price is S_{1}=4 : The state of the world is here either \\omega_{3} or \\omega_{4} . There is no chance that the digital call will pay off anything else than zero. The hedging strategy for this payoff is easy, invest zero in the money market account and invest zero in the stock. We therefore have \\phi_{1}^{0}(\\omega)=0=\\phi_{1}^{1}(\\omega),\\qquad\\text{for }\\omega=\\omega_{3}% ,\\omega_{4}. Let us now consider the hedging problem at time t=0 with price S_{0}=5 : Here we don’t have to hedge the digital call, since it pays off at time t=2 , but we have to find a hedge for the contingent claim that pays off V_{1}(\\phi) at t=1 : V_{1}(\\phi)=\\begin{cases}\\frac{2}{3},&\\mbox{ if }\\omega=\\omega_{1},\\omega_{2},% \\\\ 0,&\\mbox{ if }\\omega=\\omega_{3},\\omega_{4}.\\end{cases} The reason why we do this, is because if we hedge this contingent claim in the one period from time t=0 to time t=1 , and then follow the strategy we computed at time t=1 , we are done. Solving this hedging problem is easy again. We can apply the delta hedging formula once more in order to obtain \\phi_{0}^{1}(\\omega)=\\frac{\\frac{2}{3}-0}{8-4}=\\frac{1}{6},\\qquad\\omega=\\omega% _{1},\\omega_{2},\\omega_{3},\\omega_{4}. In order to hedge we must have \\displaystyle\\left(V_{0}(\\phi)(\\omega)-\\frac{1}{6}\\cdot 5\\right)+\\frac{1}{6}\\cdot 8 \\displaystyle= \\displaystyle\\frac{2}{3},\\quad\\omega=\\omega_{1},\\omega_{2} \\displaystyle\\left(V_{0}(\\phi)(\\omega)-\\frac{1}{6}\\cdot 5\\right)+\\frac{1}{6}\\cdot 4 \\displaystyle= \\displaystyle 0,\\quad\\omega=\\omega_{3},\\omega_{4}. Both equations are satisfied for V_{0}(\\phi)(\\omega)=\\frac{1}{6} for all \\omega\\in\\Omega . This yields \\phi_{0}^{0}(\\omega)=\\frac{1}{6}-\\frac{1}{6}\\cdot 5=-\\frac{4}{6},\\qquad\\omega=% \\omega_{1},\\omega_{2},\\omega_{3},\\omega_{4}. The price process of the digital call is given by V_{t}(\\phi) , t=0,1,2 , where \\phi is the above trading strategy. The price at t=0 is equal to \\frac{1}{6} . The price at t=1 depends on the state of the market. If S^{1}=8 , it is equal to \\frac{2}{3} . If S^{1}=4 , it is equal to 0 . The price at t=2 is simply equal to the payoff of the digital option under consideration. We can present the hedging strategy in a concise way in a table: t=0 t=1 \\omega_{1} \\omega_{2} \\omega_{3} \\omega_{4} \\phi^{0} -\\frac{4}{6} -2 -2 0 0 \\phi^{1} \\frac{1}{6} \\frac{1}{3} \\frac{1}{3} 0 0 It is now easy to check that this an adapted and self-financing trading strategy. ∎ Due to the replication principle (and above example) we know a method to price contingent claims for which there exists a hedging strategy. As in general single period market models there may be contingent claims for which there is no hedging strategy in \\mathcal{T} . We have then analogous definitions as in the single period case. Definition 2.2.4. A contingent claim X is called attainable in \\mathcal{T} , if there exists a trading strategy \\phi\\in\\mathcal{T} which replicates X , i.e. satisfies V_{T}(\\phi)=X . Definition 2.2.5. A general multi period market model is called complete, if and only if every contingent claim is attainable. A model that is not complete is called incomplete. Example 2.2.6. A multi period version of the stochastic volatility model in Example 1.2.15 is an incomplete multi period market model. ∎ 2.3. Conditional expectation In order to extend the notion of risk neutral probability measure to the multi period case, we need the concept of conditional expectation. This is due to the dynamic character of the multi period model. Definition 2.3.1. Let (\\Omega,\\mathbb{P}) be a finite probability space, X a random variable and \\mathcal{G} a \\sigma -algebra of sets of \\Omega . Denoting the unique partition of \\mathcal{G} with (A_{i})_{i\\in I} the conditional expectation \\mathbb{E}(X|\\mathcal{G}) of X with respect to \\mathcal{G} is defined as the random variable which satisfies \\boxed{\\mathbb{E}(X|\\mathcal{G})(\\omega)=\\sum_{x}x\\,\\mathbb{P}(X=x|A_{i}),% \\quad\\omega\\in A_{i}.} (2.3.1) Here \\mathbb{P}(X=x|A_{i})=\\frac{\\mathbb{P}(\\{X=x\\}\\cap A_{i})}{\\mathbb{P}(A_{i})} denotes the conditional probability of the event \\{\\omega|X(\\omega)=x\\} given the event A_{i} . It is worth to mention that \\mathbb{E}(X|\\mathcal{G}) is a random variable. It has the same value on each set of the partition, i.e. \\mathbb{E}(X|\\mathcal{G})(\\omega)=\\mathbb{E}(X|\\mathcal{G})(\\omega^{\\prime}) if there exists i\\in I such that \\omega,\\omega^{\\prime}\\in A_{i} . Notice, however, that for \\omega ’s in different sets of the partition values can be different. Until now it seems that the conditional expectation is a purely artificial construct. Not at all. The intuitive meaning is the following: the conditional expectation gives the average of values of X (weighted by their probabilities) on each set A_{i} of the partition. It is somehow ”the expected value” of X on each set of the partition of \\mathcal{G} . It follows from Proposition 2.1.5 that \\mathbb{E}(X|\\mathcal{G}) is a \\mathcal{G} -measurable random variable. The verification of the following identity is left as an exercise: for any G\\in\\mathcal{G} one has \\boxed{\\sum_{\\omega\\in G}X(\\omega)\\mathbb{P}(\\omega)=\\sum_{\\omega\\in G}\\mathbb% {E}(X|\\mathcal{G})(\\omega)\\mathbb{P}(\\omega).} (2.3.2) Example 2.3.2. In the context of Example 2.1.11, we want to compute \\mathbb{E}(S_{2}|\\mathcal{F}_{1}^{S}) , where, as we have already shown, \\mathcal{F}_{1}^{S}=\\{\\emptyset,\\{\\omega_{1},\\omega_{2}\\},\\{\\omega_{3},\\omega_% {4}\\},\\Omega\\}. Sets A_{1}=\\{\\omega_{1},\\omega_{2}\\} and A_{2}=\\{\\omega_{3},\\omega_{4}\\} form a partition of \\mathcal{F}_{1}^{S} . We have \\displaystyle\\mathbb{P}(S_{2}=9|A_{1}) \\displaystyle=\\frac{\\mathbb{P}(\\{\\omega\\in A_{1}\\mbox{ s.t. }S_{2}(\\omega)=9\\}% )}{\\mathbb{P}(A_{1})}=\\frac{\\mathbb{P}(\\omega_{1})}{\\mathbb{P}(\\{\\omega_{1},% \\omega_{2}\\})}=\\frac{\\frac{2}{5}\\cdot\\frac{3}{4}}{\\frac{2}{5}}=\\frac{3}{4} \\displaystyle\\mathbb{P}(S_{2}=6|A_{1}) \\displaystyle=\\frac{\\mathbb{P}(\\{\\omega\\in A_{1}\\mbox{ s.t. }S_{2}(\\omega)=6\\}% )}{\\mathbb{P}(A_{1})}=\\frac{\\mathbb{P}(\\omega_{2})}{\\mathbb{P}(\\{\\omega_{1},% \\omega_{2}\\})}=\\frac{\\frac{2}{5}\\cdot\\frac{1}{4}}{\\frac{2}{5}}=\\frac{1}{4} \\displaystyle\\mathbb{P}(S_{2}=3|A_{1}) \\displaystyle=\\frac{\\mathbb{P}(\\{\\omega\\in A_{1}\\mbox{ s.t. }S_{2}(\\omega)=3\\}% )}{\\mathbb{P}(A_{1})}=\\frac{\\mathbb{P}(\\emptyset)}{\\mathbb{P}(\\{\\omega_{1},% \\omega_{2}\\})}=0 \\displaystyle\\mathbb{P}(S_{2}=9|A_{2}) \\displaystyle=\\frac{\\mathbb{P}(\\{\\omega\\in A_{2}\\mbox{ s.t. }S_{2}(\\omega)=9\\}% )}{\\mathbb{P}(A_{2})}=\\frac{\\mathbb{P}(\\emptyset)}{\\mathbb{P}(\\{\\omega_{3},% \\omega_{4}\\})}=0 \\displaystyle\\mathbb{P}(S_{2}=6|A_{2}) \\displaystyle=\\frac{\\mathbb{P}(\\{\\omega\\in A_{2}\\mbox{ s.t. }S_{2}(\\omega)=6\\}% )}{\\mathbb{P}(A_{2})}=\\frac{\\mathbb{P}(\\omega_{3})}{\\mathbb{P}(\\{\\omega_{3},% \\omega_{4}\\})}=\\frac{\\frac{3}{5}\\cdot\\frac{2}{7}}{\\frac{3}{5}}=\\frac{2}{7} \\displaystyle\\mathbb{P}(S_{2}=3|A_{2}) \\displaystyle=\\frac{\\mathbb{P}(\\{\\omega\\in A_{2}\\mbox{ s.t. }S_{2}(\\omega)=3\\}% )}{\\mathbb{P}(A_{2})}=\\frac{\\mathbb{P}(\\omega_{4})}{\\mathbb{P}(\\{\\omega_{3},% \\omega_{4}\\})}=\\frac{\\frac{3}{5}\\cdot\\frac{5}{7}}{\\frac{3}{5}}=\\frac{5}{7}. A more concise way of writing the above equalities is the following: \\displaystyle\\mathbb{P}(S_{2}=9|A_{1}) \\displaystyle=\\frac{\\mathbb{P}(A_{1}\\cap\\{S_{2}=9\\})}{\\mathbb{P}(A_{1})}=\\frac% {\\mathbb{P}(\\omega_{1})}{\\mathbb{P}(\\{\\omega_{1},\\omega_{2}\\})}=\\frac{\\frac{2}% {5}\\cdot\\frac{3}{4}}{\\frac{2}{5}}=\\frac{3}{4} \\displaystyle\\vdots \\displaystyle\\mathbb{P}(S_{2}=3|A_{2}) \\displaystyle=\\frac{\\mathbb{P}(A_{2}\\cap\\{S_{2}=3\\})}{\\mathbb{P}(A_{2})}=\\frac% {\\mathbb{P}(\\omega_{4})}{\\mathbb{P}(\\{\\omega_{3},\\omega_{4}\\})}=\\frac{\\frac{3}% {5}\\cdot\\frac{5}{7}}{\\frac{3}{5}}=\\frac{5}{7}. It then follows from equation (2.3.1), that for \\omega\\in A_{1} \\mathbb{E}(S_{2}|\\mathcal{F}_{1}^{S})(\\omega)=9\\cdot\\frac{3}{4}+6\\cdot\\frac{1}% {4}+3\\cdot 0=\\frac{33}{4} and for \\omega\\in A_{2} \\mathbb{E}(S_{2}|\\mathcal{F}_{1}^{S})(\\omega)=9\\cdot 0+6\\cdot\\frac{2}{7}+3% \\cdot\\frac{5}{7}=\\frac{27}{7}. This is enough to define the conditional expectation \\mathbb{E}(S_{2}|\\mathcal{F}_{1}^{S})=\\begin{cases}\\frac{33}{4},&\\mbox{ if }% \\omega=\\omega_{1},\\omega_{2},\\\\ \\frac{27}{7},&\\mbox{ if }\\omega=\\omega_{3},\\omega_{4}.\\end{cases} ∎ The following properties of the conditional expectation are very important and useful. The proofs are omitted. Proposition 2.3.3. Assume we have a probability space (\\Omega,\\mathbb{P}) and \\sigma -algebras \\mathcal{G} , \\mathcal{G}_{1} and \\mathcal{G}_{2} of subsets of \\Omega . Assume furthermore that \\mathcal{G}_{2}\\subset\\mathcal{G}_{1} . Then (1)​If X:\\Omega\\to\\mathbb{R} is a random variable then \\boxed{\\mathbb{E}(X|\\mathcal{G}_{2})=\\mathbb{E}(\\mathbb{E}(X|\\mathcal{G}_{1})|% \\mathcal{G}_{2})} (2.3.3) (2)​If Y:\\Omega\\to\\mathbb{R} is a \\mathcal{G} -measurable random variable, then \\boxed{\\mathbb{E}(YX|\\mathcal{G})=Y\\,\\mathbb{E}(X|\\mathcal{G}).} (2.3.4) (3)​If \\mathcal{G}=\\{\\emptyset,\\Omega\\} is the trivial \\sigma -algebra, then \\boxed{\\mathbb{E}(X|\\mathcal{G})=\\mathbb{E}(X)} (2.3.5) Previous page Next page"],[["index.html","Pt6.html"],"Lecture VI 05/11/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 05/11/2024 Lecture VI 05/11/2024 2.4. Risk neutral probability measures: arbitrage and pricing Using the concept of conditional expectation, we can now define a risk neutral probability measure in the multi period framework. Definition 2.4.1. A measure \\mathbb{Q} on \\Omega is called a risk neutral probability measure for a general multi period market model if (1)​ \\mathbb{Q}(\\omega)>0 for all \\omega\\in\\Omega . (2)​ \\mathbb{E}_{\\mathbb{Q}}(\\Delta\\hat{S}_{t}^{i}|\\mathcal{F}_{t-1})=0 for i=1,..,n and for all 1\\leq t\\leq T . Another way of formulating the second condition is: \\boxed{\\displaystyle\\mathbb{E}_{\\mathbb{Q}}\\left.\\left(\\frac{1}{1+r}S_{t+1}^{i% }\\right|\\mathcal{F}_{t}\\right)=S_{t}^{i},\\quad 0\\leq t\\leq T-1.} The Fundamental Theorem of asset pricing is valid in the framework of multi period market models. The proof is similar to the one we presented for the single period market model. Here, we only prove the implication \"risk neutral measure \\Rightarrow no arbitrage\". The proof of the inverse implication relies on the separating hyperplane theorem as in the single period case, but one has to deal with some technicalities that do not really help with the intuition. Theorem 2.4.2. Fundamental Theorem of Asset Pricing. The following statements are equivalent in the framework of the multi period market model: (1)​There are no arbitrages in the set \\mathcal{T} of self-financing and adapted trading strategies. (2)​There exists a risk neutral probability measure. Proof. As we said, we shall only prove the implication: 2. \\implies 1. Assume that \\mathbb{Q} is a risk neutral measure for a general multi period market model. We shall prove that the model is arbitrage free by contradiction. Assume therefore that there exists an arbitrage strategy \\phi\\in\\mathcal{T} . Such a strategy satisfies: (1)​ \\hat{V}_{0}=0 . (2)​ \\hat{G}_{T}\\geq 0 . (3)​ \\mathbb{E}_{\\mathbb{Q}}(\\hat{G}_{T})>0 . On the other hand using the definition of the discounted gains process as well as property 2. of a risk neutral measure and properties 1., 2. and 3. of the conditional expectation we obtain \\displaystyle\\mathbb{E}_{\\mathbb{Q}}(\\hat{G}_{T}) \\displaystyle=\\mathbb{E}_{\\mathbb{Q}}\\left(\\sum_{i=1}^{n}\\sum_{s=0}^{T-1}\\phi_% {s}^{i}\\Delta\\hat{S}_{s+1}^{i}\\right) \\displaystyle=\\sum_{i=1}^{n}\\sum_{s=0}^{T-1}\\mathbb{E}_{\\mathbb{Q}}(\\phi_{s}^{% i}\\Delta\\hat{S}_{s+1}^{i}) \\displaystyle=\\sum_{i=1}^{n}\\sum_{s=0}^{T-1}\\mathbb{E}_{\\mathbb{Q}}(\\mathbb{E}% _{\\mathbb{Q}}(\\phi_{s}^{i}\\Delta\\hat{S}_{s+1}^{i}|\\mathcal{F}_{s})) \\displaystyle=\\sum_{i=1}^{n}\\sum_{s=0}^{T-1}\\mathbb{E}_{\\mathbb{Q}}\\phi_{s}^{i% }(\\underbrace{\\mathbb{E}_{\\mathbb{Q}}(\\Delta\\hat{S}_{s+1}^{i}|\\mathcal{F}_{s})% )}_{=0} \\displaystyle=0. This contradicts (3.), which implies that the market model is arbitrage free. ∎ Let us now come back to pricing of contingent claims. Recall that it is easy to find prices of attainable contingent claims using the replication principle. The following proposition gives a hint how to use risk neutral measures for this task (the proof is left as an exercise; it is practically shown in the proof of Theorem 2.4.2). Proposition 2.4.3. If \\phi is an adapted and self-financing trading strategy and \\mathbb{Q} is a risk neutral measure, then \\hat{V}_{s}(\\phi)=\\mathbb{E}_{\\mathbb{Q}}\\big{(}\\hat{V}_{t}(\\phi)|\\mathcal{F}_% {s}\\big{)},\\qquad 0\\leq s\\leq t\\leq T. In particular, V_{t}(\\phi)=B_{t}\\,\\mathbb{E}_{\\mathbb{Q}}\\bigg{(}\\frac{V_{T}(\\phi)}{B_{T}}% \\bigg{|}\\mathcal{F}_{t}\\bigg{)},\\qquad t=0,1,\\ldots,T. Let X be an attainable contingent claim. By virtue of Proposition 2.4.3 we can find the price process for X without computiation of the hedging (replicating) strategy. Indeed, the price ar t is equal to B_{t}\\,\\mathbb{E}_{\\mathbb{Q}}\\bigg{(}\\frac{X}{B_{T}}\\bigg{|}\\mathcal{F}_{t}% \\bigg{)}. Consider now a general contingent claim X , attainable or not. As in the single period market model we introduce the following definition: Definition 2.4.4. We say that an adapted stochastic process (X_{t})_{t=0,\\ldots,T-1} is a price process for the contingent claim X which complies with the no arbitrage principle, if there is no arbitrage strategy in the extended model, which consists of: •​the original stocks B_{t} and (S_{t}^{1}),...,(S^{n}_{t}) , and •​an additional asset given by S^{n+1}_{t}=X_{t} for 0\\leq t\\leq T-1 and S_{T}^{n+1}=X . Clearly, we can formulate a useful result whose proof is very easy and left as an exercise. Proposition 2.4.5. Let X be a contingent claim in a multi period market model. If \\phi\\in\\mathcal{T} be a hedging strategy for X , then the only price of X at time t which complies with the no arbitrage principle is V_{t}(\\phi) . In particular, the price at the beginning of the trading period at time t=0 is the total initial investment in the hedge. As in the single period market model, we can easily distinguish between complete and incomplete markets. However, the proof is rather difficult as we skip it. Theorem 2.4.6. Assume that the multi period market model is arbitrage free. Then it is complete if and only if there exists exactly one risk neutral probability measure. Due to Fundamental Theorem of Asset Pricing, the market model is arbitrage free if and only if there exists a risk neutral measure. If the set \\mathbb{M} of risk neutral measures consists of one element, then the model is complete. If the set \\mathbb{M} is bigger, then the model is incomplete, i.e. there exists an unattainable contingent claim. To sum it up, there are only three possibilities: •​ \\mathbb{M}=\\emptyset if and only if there is an arbitrage. •​ \\mathbb{M} has one element if and only if the model is arbitrage free and complete. •​ \\mathbb{M} is infinite if and only if the model is arbitrage free but incomplete. The set \\mathbb{M} cannot consist of more than one element and be finite (check it using convex combinations of risk neutral measures). Notice that in the definition of completeness we do not assume that the model is arbitrage free. So there is a big class of models that allow arbitrage and are complete or incomplete. Hence, we cannot use risk neutral measures to classify them. Fortunately, these models are of no interest to us during this lecture. Let us now move to incomplete models. If X is not attainable, we cannot use the replication principle. However, the arbitrage pricing concept is still in effect and yields Proposition 2.4.7. Let X be a possibly unattainable contingent claim and \\mathbb{Q} a risk neutral measure for a general multi period market model. Then \\boxed{X_{t}=B_{t}\\mathbb{E}_{\\mathbb{Q}}\\left.\\left(\\frac{1}{B_{T}}X\\right|% \\mathcal{F}_{t}\\right)} (2.4.1) defines a price process for the contingent claim X which complies with the no arbitrage principle. The proof of the above result is almost the same as the proof of Proposition 1.2.21. Example 2.4.8. Let us come back to Example 2.2.3 and consider again the digital call. As before we assume that the interest rate is equal to zero, i.e. r=0 . We already know that an arbitrage free price price is given by x=\\frac{1}{6} , and that this price is in fact unique, because the contingent claim can be hedged. However, alternatively, let us compute the price by using risk neutral measures. In order to do this, we first compute a set of risk neutral measures. Let \\mathbb{Q}=(q_{1},q_{2},q_{3},q_{4})^{\\top} be the risk neutral measure we are looking for. The following two conditions for the q_{i} are due to the fact that \\mathbb{Q} is a probability measure and satisfies condition 1. in Definition 2.4.1: q_{1}+q_{2}+q_{3}+q_{4}=1,\\quad q_{1},q_{2},q_{3},q_{4}>0. Note that since the interest rate is equal to zero prices agree with the discounted prices. Due to condition 2. of Definition 2.4.1 we obtain 5=\\mathbb{E}_{\\mathbb{Q}}(\\hat{S_{1}}|\\mathcal{F}_{0})=\\mathbb{E}_{\\mathbb{Q}}% (\\hat{S_{1}})=q_{1}\\cdot 8+q_{2}\\cdot 8+q_{3}\\cdot 4+q_{4}\\cdot 4. Substitution of q_{4}=1-q_{1}-q_{2}-q_{3} into this equation gives 5=4+4(q_{1}+q_{2}), which is equivalent to q_{1}+q_{2}=\\frac{1}{4}. (2.4.2) This also implies that q_{3}+q_{4}=\\frac{3}{4}. (2.4.3) Recall that the partition of \\mathcal{F}^{S}_{1} is given by two sets A_{1}=\\{\\omega_{1},\\omega_{2}\\} and A_{2}=\\{\\omega_{3},\\omega_{4}\\} . Using the definition of the conditional expectation, we see that for \\omega\\in A_{1} , we have 8=\\mathbb{E}_{\\mathbb{Q}}(\\hat{S}_{2}|\\mathcal{F}_{1}^{S})(\\omega)=9\\cdot\\frac% {q_{1}}{q_{1}+q_{2}}+6\\frac{q_{2}}{q_{1}+q_{2}}=36q_{1}+24q_{2}. This gives 9q_{1}+6q_{2}=2. (2.4.4) Furthermore for \\omega\\in A_{2} we have 4=\\mathbb{E}_{\\mathbb{Q}}(\\hat{S}_{2}|\\mathcal{F}_{1}^{S})(\\omega)=6\\cdot\\frac% {q_{3}}{q_{3}+q_{4}}+3\\frac{q_{4}}{q_{3}+q_{4}}=8q_{3}+4q_{4}. This gives 2q_{3}+q_{4}=1. (2.4.5) Now we have four linear equations (2.4.2),(2.4.3),(2.4.4), and (2.4.5), and four unknown variables q_{1},q_{2},q_{3} and q_{4} : 9q_{1}+6q_{2}=2,\\qquad 2q_{3}+q_{4}=1,\\qquad q_{3}+q_{4}=\\frac{3}{4},\\qquad q_% {1}+q_{2}=\\frac{1}{4}. The unique solution of this system is \\mathbb{Q}=(q_{1},q_{2},q_{3},q_{4})^{\\top}=\\left(\\frac{1}{6},\\frac{1}{12},% \\frac{1}{4},\\frac{1}{2}\\right)^{\\top}. (2.4.6) We check that this solution satisfies the inequalities: q_{1},q_{2},q_{3},q_{4}>0. We therefore see that the market model is arbitrage free. By virtue of Theorem 2.4.6 it is also complete. Let us now compute the risk neutral measure using the trick that we already benefited in Example 2.2.3, namely the decomposition of our multi period market model into single period market models. We have three embedded single period market models: one starting at time t=0 going until time t=1 with price S_{0}=5 , one starting at time t=1 with price S_{1}=8 and one starting at time t=1 with price S_{1}=4 . Let us first find a risk neutral measure (q^{*}_{1},1-q^{*}_{1})^{T} in the t=1 model with S_{1}=8 : This model is in fact an elementary single period market model, as in Section 1.1 and therefore the risk neutral measure is given by the formula (recall that r=0 ): q^{*}_{1}=\\frac{8\\cdot(1+0)-6}{9-6}=\\frac{2}{3}. The single period model at time t=1 when the stock price is S_{1}=4 is given by The risk neutral measure (q^{*}_{2},1-q^{*}_{2})^{T} is defined by the formula q^{*}_{2}=\\frac{4\\cdot(1+0)-3}{6-3}=\\frac{1}{3}. Similarly, at time t=0 with price S_{0}=5 we have where q^{*}_{0}=\\frac{5\\cdot(1+0)-4}{8-4}=\\frac{1}{4}. We put the computed values into the diagram (see Figure 2). Diagram with the risk neutral measure Figure 2. Diagram with the risk neutral measure \\mathbb{Q} . Let us compute the probabilities of \\omega ’s as in Example 2.1.17: \\displaystyle\\mathbb{Q}(\\omega_{1})=\\frac{1}{4}\\cdot\\frac{2}{3}=\\frac{1}{6},\\qquad \\displaystyle\\mathbb{Q}(\\omega_{2})=\\frac{1}{4}\\cdot\\frac{1}{3}=\\frac{1}{12}, \\displaystyle\\mathbb{Q}(\\omega_{3})=\\frac{3}{4}\\cdot\\frac{1}{3}=\\frac{1}{4},\\qquad \\displaystyle\\mathbb{Q}(\\omega_{4})=\\frac{3}{4}\\cdot\\frac{2}{3}=\\frac{1}{2}, which is exactly the result obtained in (2.4.6). Remember that after computations one always has to check whether all probabilities are greater than zero! In order to compute the price of the digital call X={\\bf 1}_{\\{S_{2}|\\geq 8\\}} we observe that X(\\omega) is 1 for \\omega=\\omega_{1} and 0 for all other \\omega ’s. The only price at time 0 that complies with the no arbitrage principle is equal to \\mathbb{E}_{\\mathbb{Q}}\\bigg{(}\\frac{X}{(1+r)^{2}}\\bigg{)}=q_{1}\\cdot 1+q_{2}% \\cdot 0+q_{3}\\cdot 0+q_{4}\\cdot 0=\\frac{1}{6}, since r=0 . ∎ 2.5. Exotic options The options we have considered so far, were of the type h(S_{T}) , where h is a pay off function depending on the terminal stock price S_{T} , but not on the stock prices at times strictly before T . Such options are called path independent. However there are also path dependent options. Here are some examples: (1)​Asian option: An Asian option is in a way a European call option on the average stock price. There are two kinds which are mainly traded: (a)​arithmetic average option: X=\\left(\\frac{1}{T+1}\\sum_{t=0}^{T}S_{t}-K\\right)^{+} (2.5.1) (b)​geometric average option: X=\\left(\\left(\\prod_{t=0}^{T}S_{t}\\right)^{\\frac{1}{T+1}}-K\\right)^{+} (2.5.2) (2)​Barrier options: Barrier options are options which are activated or deactivated if the stock price hits a certain barrier. As an example we consider so called \"knock out\" barrier options. There are two types of these: (a)​Down and Out call: X=(S_{T}-K_{1})^{+}\\cdot{\\bf 1}_{\\{\\min_{0\\leq t\\leq T}S_{t}>K_{2}\\}} (2.5.3) This option has the same payoff as a European call with strike K_{1} , but only if the stock price remains over the barrier level of K_{2} on the time interval [0,T] . Otherwise it pays off 0 . (b)​Down and In call: X=(S_{T}-K_{1})^{+}\\cdot{\\bf 1}_{\\{\\min_{0\\leq t\\leq T}S_{t}\\leq K_{2}\\}} (2.5.4) This option has the same payoff as a European call with strike K_{1} , but only if the stock price falls below the barrier level of K_{2} on the time interval [0,T] . Otherwise it pays off 0 . (3)​Look back option: A look back option is an option on a maximum or a minimum of the stock price on the interval [0,T] . As an example consider call options: (a)​Call option on maximum: X=\\left(\\max_{0\\leq t\\leq T}S_{t}-K\\right)^{+} (b)​Call option on minimum: X=\\left(\\min_{0\\leq t\\leq T}S_{t}-K\\right)^{+} The main difference of the path dependent options and a standard European options is that their payoff does not only depend on the terminal stock price S_{T} but on the whole path that the stock price has taken in the interval [0,T] . Notice that our pricing rules are ready to deal with path dependent options, because all contingent claims above depend on asset prices up to time T and hence they are \\mathcal{F}_{T} measurable. Therefore, one simply has to compute the expected value of \\frac{X}{B_{T}} under the risk neutral measure. Previous page Next page"],[["index.html","Pt7.html"],"Lecture VII 12/11/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 12/11/2024 Lecture VII 12/11/2024 2.6. The Binomial Asset Pricing Model The most important multi period discrete time market model is the binomial asset pricing model, which we discuss in this section. This model is often called the Cox-Ross-Rubinstein model and abbreviated to CRR model. The binomial market model is the concatenation of several elementary single period market models, as discussed in section 1.1. We assume here that we have one stock (S_{t}) and one money market account (B_{t}) , but a generalization to the case of more then one stock is possible. At each point in time when the stock price is S_{t} , there are two possible outcomes for the stock price in the next period: uS_{t} , or dS_{t} , u,d>0 . Typically u>1 and 0<d<1 . In order to guarantee that the model is arbitrage free we require that d<1+r<u . The probability of an up move (the probability at the arrow) is assumed to be the same 0<p<1 for each period, and is assumed to be independent of all previous stock price movements. A sample two period binomial model in presented in Figure 3. t Two period binomial asset pricing model Figure 3. Two period binomial asset pricing model Definition 2.6.1. A stochastic process (X_{t})_{1\\leq t\\leq T} on a probability space (\\Omega,\\mathbb{P}) is called a Bernoulli process with parameter p ( 0\\leq p\\leq 1 ), if the random variables X_{1},X_{2},X_{3},...,X_{T} are independent and \\boxed{\\mathbb{P}(X_{t}=1)=1-\\mathbb{P}(X_{t}=0)=p,\\qquad t=0,1,\\ldots,T.} The Bernoulli counting process (N_{t})_{1\\leq t\\leq T} is defined via \\boxed{N_{t}(\\omega):=X_{1}(\\omega)+X_{2}(\\omega)+...+X_{t}(\\omega),\\qquad% \\omega\\in\\Omega.} Using the Bernoulli counting process, the stock price process in the binomial model is defined via a deterministic initial value S_{0} and for 1\\leq t\\leq T \\boxed{S_{t}(\\omega):=S_{0}u^{N_{t}(\\omega)}d^{t-N_{t}(\\omega)},\\qquad\\omega% \\in\\Omega.} (2.6.1) The idea behind this construction is that the Bernoulli process (X_{t}) determines the up and down movements of the stock. The stock price moves up at time t if X_{t}(\\omega)=1 and moves down if X_{t}(\\omega)=0 . The Bernoulli counting process (N_{t}) counts the up movements. Before and including time t , the stock price has moved up N_{t} times, and it has moved down t-N_{t} times. Assuming that the stock price can only move up resp. down by the factors u resp. d we obtain equation (2.6.1). Why is this model called the binomial model? The reason is that for each t the random variable N_{t} has a binomial distribution with parameters (p,t) , i.e. \\boxed{\\mathbb{P}(N_{t}=k)=\\binom{t}{k}p^{k}(1-p)^{t-k}.} The distribution of the stock price at time t is then \\boxed{\\mathbb{P}(S_{t}=S_{0}u^{k}d^{t-k})=\\binom{t}{k}p^{k}(1-p)^{t-k},\\qquad k% =0,1,...,t.} (2.6.2) It can be shown, that the filtration (\\mathcal{F}_{t}^{S})_{0\\leq t\\leq T} generated by (S_{t}) is the same as the filtration (\\mathcal{F}_{t}^{X})_{0\\leq t\\leq T} generated by the Bernoulli process, where \\mathcal{F}_{0}^{X} is the trivial \\sigma -algebra by definition. The money market account (B_{t}) is as usual assumed to be defined via B_{0}=1 and \\boxed{B_{t}=(1+r)^{t}.} (2.6.3) Definition 2.6.2. The binomial market model with parameters p,u,d ( 0<p<1 , u\\geq d>0 ) and time horizon [0,T] on a probability space (\\Omega,\\mathbb{P}) is the multi period market model consisting of one stock and one money market account, where the stock price evolution is described by equation (2.6.1) and the money market account by (2.6.3). The filtration is assumed to be the filtration (\\mathcal{F}_{t}^{S})_{0\\leq t\\leq T} generated by (S_{t}) . Given a binomial market model, the constituting Bernoulli process (X_{t}) can be regained from the stock prices as follows: Clearly X_{t}=N_{t}-N_{t-1} . Then \\displaystyle\\frac{S_{t}}{S_{t-1}} \\displaystyle=\\frac{S_{0}u^{N_{t}}d^{t-N_{t}}}{S_{0}u^{N_{t-1}}d^{{t-1}-{N_{t-% 1}}}} \\displaystyle=u^{N_{t}-N_{t-1}}d^{1-(N_{t}-N_{t-1})} \\displaystyle=u^{X_{t}}d^{1-X_{t}} \\displaystyle=\\left\\{\\begin{array}[]{cc}u&\\mbox{ if }X_{t}(\\omega)=1\\\\ d&\\mbox{ if }X_{t}(\\omega)=0\\end{array}\\right.. Is the binomial market model arbitrage free? Proposition 2.6.3. The binomial market model is arbitrage free if and only if d<1+r<u . Moreover, if it is arbitrage free, then it is complete. The above proposition can be easily proved with the methods developed in Example 2.4.8. We can also use: Proposition 2.6.4. Under the assumption d<1+r<u a probability measure \\mathbb{Q} on \\Omega is a risk neutral measure for the binomial market model with parameters p,u,d and time horizon [0,T] if and only if the following three conditions hold: (1)​ X_{1},X_{2},X_{3},...,X_{T} are independent under the measure \\mathbb{Q} (2)​ 0<q:=\\mathbb{Q}\\left(X_{t}=1\\right)<1 for all 1\\leq t\\leq T (3)​ q\\left(\\frac{u-1-r}{1+r}\\right)+(1-q)\\left(\\frac{d-1-r}{1+r}\\right)=0 where (X_{t}) is the Bernoulli process corresponding to the model. Condition 3. here, is the same as in Section 1.1 and is equivalent to \\boxed{q=\\frac{1+r-d}{u-d}.} (2.6.4) Therefore under the assumption d<1+r<u the binomial model is arbitrage free: once we specify q and the measure \\mathbb{Q} is fully defined by conditions 1. and 2. of Proposition 2.6.4. As the value for q is also unique, we obtain from Theorem 2.4.6 that the binomial model is also complete. We will assume from now on that \\boxed{d<1+r<u.} It seems that the binomial model grows very large if the number of periods T is very large. In fact, in general one could obtain 2^{T} different leaves of the binomial tree. But is that true? Look at Figure 4. This representation is very useful for pricing of a certain type of contingent claims, namely path independent contingent claims. These are the claims whose payoffs depend only on the value of S_{T} , i.e. there are of the form h(S_{T}) for some function h . Perfect examples are: call and put options, binary call and put options. But beware! You cannot use the representation from Figure 4 to price path dependent options such as Asian, barrier or lookback options. Recombination of the binomial model Figure 4. Recombination of the binomial model In fact, we only have T+1 possible values for the stock price at time T . Let us now see how certain options can be evaluated using the binomial market model above. To simplify the computation we shall impose an assumption that is often used in practice: d=u^{-1}. (2.6.5) Then \\boxed{S_{t}=S_{0}u^{2N_{t}-t}.} (2.6.6) Consider a European call with the payoff: X=(S_{T}-K)^{+}. The price of this contingent claim at time t=0 can be computed via the formula V_{0}=\\mathbb{E}_{\\mathbb{Q}}\\left(\\frac{1}{(1+r)^{T}}X\\right). Using Proposition 2.6.4, this is the same as V_{0}=\\frac{1}{(1+r)^{T}}\\sum_{k=0}^{T}\\binom{T}{k}q^{k}(1-q)^{T-k}\\max(0,S_{0% }u^{k}d^{T-k}-K). We have that \\displaystyle S_{0}u^{k}d^{T-k}-K>0 \\displaystyle\\Leftrightarrow\\left(\\frac{u}{d}\\right)^{k}>\\frac{K}{S_{0}d^{T}} \\displaystyle\\Leftrightarrow k\\log\\left(\\frac{u}{d}\\right)>\\log\\left(\\frac{K}{% S_{0}d^{T}}\\right) \\displaystyle\\Leftrightarrow k>\\frac{\\log\\left(\\frac{K}{S_{0}d^{T}}\\right)}{% \\log\\left(\\frac{u}{d}\\right)}. We define \\hat{k} as the smallest integer k such that this inequality is satisfied. If there are less than \\hat{k} upward jumps, there is no chance that the option will pay off anything. We can therefore write \\displaystyle V_{0} \\displaystyle=\\frac{1}{(1+r)^{T}}\\sum_{k=0}^{\\hat{k}-1}\\binom{T}{k}q^{k}(1-q)^% {T-k}0 \\displaystyle\\hskip 16.0pt+\\frac{1}{(1+r)^{T}}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}% q^{k}(1-q)^{T-k}\\left(S_{0}u^{k}d^{T-k}-K\\right) \\displaystyle=\\frac{S_{0}}{(1+r)^{T}}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}q^{k}(1-q% )^{T-k}u^{k}d^{T-k} \\displaystyle\\hskip 16.0pt-\\frac{K}{(1+r)^{T}}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}% q^{k}(1-q)^{T-k} \\displaystyle=S_{0}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}\\left(\\frac{qu}{1+r}\\right)% ^{k}\\left(\\frac{(1-q)d}{1+r}\\right)^{T-k} \\displaystyle\\hskip 16.0pt-\\frac{K}{(1+r)^{T}}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}% q^{k}(1-q)^{T-k} \\displaystyle=S_{0}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}\\hat{q}^{k}(1-\\hat{q})^{T-k% }-\\frac{K}{(1+r)^{T}}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}q^{k}(1-q)^{T-k}, where \\hat{q}=\\frac{qu}{1+r} . We have therefore proved: Proposition 2.6.5. (CRR-option pricing formula) An arbitrage free price at time t=0 for the European call option X=(S_{T}-K)^{+} in the binomial market model with parameters u=d^{-1} , r , T is given by V_{0}=S_{0}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}\\hat{q}^{k}(1-\\hat{q})^{T-k}-\\frac{% K}{(1+r)^{T}}\\sum_{k=\\hat{k}}^{T}\\binom{T}{k}q^{k}(1-q)^{T-k} where q=\\frac{1+r-d}{u-d},\\qquad\\hat{q}=\\frac{qu}{1+r}, (2.6.7) and \\hat{k} is the smallest integer such that \\hat{k}>\\frac{\\log\\left(\\frac{K}{S_{0}d^{T}}\\right)}{\\log\\left(\\frac{u}{d}% \\right)}. Though simple by its construction, the binomial market model is very powerful. If one chooses the number of time periods very large and the units of time very small, then one can approximate trading in continuous time. The CRR-option pricing formula then approximates the Black-Scholes option pricing formula (details are given in Elliot, page 50-55) and in the Continuous Time Finance module, next semester. 3. Investment 3.1. Single Period Investment In this section we return to the study of the general single period market model which consists of one money market account and n stocks, based on the underlying state space \\Omega=\\{\\omega_{1},...,\\omega_{k}\\} and probability measure \\mathbb{P} . In the first chapter we were mainly interested in the construction of this model and the computation of prices of financial derivatives such as options and contingent claims. Now we want to study a different question, which is by no means less important: What is the optimal way to invest money into the market? The answer of this question naturally depends on the choice of the model, and in this section we will stick to our general single period market model from the last section of the first chapter. We will later consider the same question in multi-period models. Before we answer this question we have to specify what exactly we mean by optimality, i.e. what is our measure for the performance of a trading strategy. In order to define such a performance measure three fundamental characteristics of financial markets, or more precisely of the agents trading on the markets, have to be included: 1. Agents prefer higher payoffs to lower payoffs This idea is so innate to financial markets, that it does not need any discussion. However we cannot judge trading strategies purely by this characteristic. As we saw in the previous sections, the payoffs of financial assets are generally modeled as random variables. Assume now, we have two trading strategies, the performance of which we want to compare. It is then possible that in one state of the world the first trading strategy yields a higher payoff and in another state of the world the second trading strategy yields a higher payoff. In order to compare the performances of the two trading strategies, we must somehow take an average over the states of the world, but this is nothing else then taking expectations. 2. Agents assess trading strategies by average performance The second characteristic leads directly to the use of expected value, which fits in very well into our probabilistic models. There is however a third characteristic which has to be included. To illustrate this, consider the following simple example: Assume an agent is offered to choose between two alternatives. If he chooses the first one he will be paid 10 million pounds. If he chooses the second one, a fair coin will be tossed. If the coin shows head, he will be paid 20 million pounds instead of the 10 million, but if the coin shows tail, he will be paid nothing. What would the agent choose? If the agent is not yet a billionaire, he would probably go for the first alternative, which gives him 10 million for sure and financial safety for the rest of his life. Denoting the payoff of the first alternative with X^{1} and the payoff of the second alternative with X^{2} we see that if we simply judge the two payoffs by its expectation, the agent would be indifferent between the two alternatives: \\mathbb{E}(X^{1})=10\\mbox{ million }=\\frac{1}{2}\\cdot 0+\\frac{1}{2}\\cdot 20% \\mbox{ million }=\\mathbb{E}(X^{2}). The reason why the agent would prefer the first alternative is, that he is risk averse. His idea is, that 10 million will bring him financial safety and the possibility of an upper class lifestyle and that in fact for him 10 million or 20 million wouldn’t be such a big difference, but 10 million or nothing would make a huge difference. We therefore have found our third and last characteristic, which we want to include into our model. 3. Agents are risk averse The concept of risk aversion can be included in our model by the use of utility functions. Definition 3.1.1. A continuously differentiable function u:\\mathbb{R}_{+}\\to\\mathbb{R} is called a risk averse utility function if it has the following three properties: (1)​ \\lim_{x\\to 0}u^{\\prime}(x)=+\\infty and \\lim_{x\\to\\infty}u^{\\prime}(x)=0 (2)​ u is strictly increasing in the way that u^{\\prime}(x)>0 for all x\\in\\mathbb{R} (3)​ u is strictly concave in the way that u(\\lambda x+(1-\\lambda)y)>\\lambda u(x)+(1-\\lambda)u(y) . Third condition in Definition 3.1.1 is equivalent to u^{\\prime\\prime}(x)<0 for all x\\in\\mathbb{R}_{+} if the function if twice differentiable. Let us now consider a random variable X which is interpreted as a random payoff. Fixing a utility function u we will measure the performance of this payoff by \\boxed{\\mathbb{E}(u(X))=\\sum_{i=1}^{k}\\mathbb{P}(\\omega_{i})u(X(\\omega_{i})).} This way of measuring the performance of a payoff incorporates all three of the characteristics we have discussed above. The first one is reflected by the fact that the utility function is strictly increasing and the second one is reflected by usage of the expected value. The third characteristic is reflected by the concavity of the utility function. In our little example where the agent is offered to choose between the two alternatives, we have \\displaystyle\\mathbb{E}(u(X^{1})) \\displaystyle= \\displaystyle u(10\\mbox{ million })=u(\\frac{1}{2}\\cdot 0+\\frac{1}{2}\\cdot 20% \\mbox{ million }) \\displaystyle> \\displaystyle\\frac{1}{2}\\cdot u(0)+\\frac{1}{2}\\cdot u(20\\mbox{ million }))=% \\mathbb{E}(u(X^{2})). The investor would therefore decide for the first alternative. This an example of what is also called 2nd order stochastic dominance. It is important to note, that the expectation in our performance measure has to be taken under the original measure \\mathbb{P} which represents the traders beliefs, and not any risk neutral measure. The value \\mathbb{E}(u(X)) crucially depend on the choice of the utility function u . It is clear that whenever an agent wants to compare a set of payoffs, he has to use the same utility function for this evaluation. However this utility function is like a personal trait of the agent and different agents may have different utility functions, such as some agents are more risk averse than others. Here are some examples of risk averse utility functions: •​Logarithmic utility: u(x)=\\ln(x) •​Exponential utility*: u(x)=-e^{-\\lambda x} , \\lambda>0 . •​Power utility: u(x)=\\frac{1}{\\gamma}x^{\\gamma} , \\gamma\\in(0,1) . •​Square root utility: u(x)=\\sqrt{x} (it is an example of the power utility function). Some of the utility functions above, clearly do not satisfy the Definition 3.1.1 of a utility function in the strict sense. *Notice for example that the exponential utility function has a different range than the one we used in Definition 3.1.1. The limits in the first property of the same definition are different as well. However, utility functions are used to rank alternative investments and the actual value of the utility of a specific outcome is not meaningful on its own. For this reason, any utility function of the form \\alpha U(x)+\\beta would provide the same ranking of outcomes as U(x) and is called equivalent to U(x) . For example 1-e^{-\\lambda x} is equivalent to -e^{-\\lambda x} . Exponential utility functions are very often used by economists and are very useful in continuous time models. All the results proved in this section, are also valid for exponential utility functions with some appropriate simple modifications. Let us now try to formalise the risk-aversion property of a utility function. This is done by the Arrow-Pratt coefficients of risk aversion. Coefficient of Absolute Risk Aversion:⁢a⁢(x)=−U′′⁢(x)U′⁢(x) Notice that due to the last two properties of a risk averse utility function, the above coefficient is always positive. In fact the only reason for the presence of the first derivative in the coefficient is to ensure the same coefficient of absolute risk aversion for all equivalent utility functions. In an investment problem, absolute risk-aversion measures the actual amount in pounds that an investor will choose to hold in risky assets, given a certain wealth level x . Similarly the coefficient of relative risk aversion is defined. Coefficient of Relative Risk Aversion:⁢r⁢(x)=−x⁢U′′⁢(x)U′⁢(x) In financial terms, the coefficient of relative risk-aversion measures the percentage of wealth held in risky assets, for a given wealth level x . It is clear that different utility functions exhibit different risk aversion properties. For example, the exponential utility function has a Constant Absolute Risk Aversion coefficient (CARA) a(x)=\\lambda . It also has an Increasing Relative Risk Aversion (IRRA) r(x)=x\\lambda . On the other hand the logarithmic utility function has a Decreasing Absolute Risk Aversion (DARA) a(x)=1/x and a Constant Relative Risk Aversion (CRRA) coefficient r(x)=1 . Using the concept introduced above, the question of finding the optimal investment into our market now translates into the question of finding a trading strategy (x,\\phi) s.t. \\mathbb{E}(u(V_{1}(x,\\phi)) achieves an optimal value. This problem is called the optimal portfolio problem. The optimal value will naturally depend on the initial investment x . A higher initial investment will naturally result in a higher expected utility, so we have to take the initial investment as a parameter for our problem. Definition 3.1.2. A trading strategy (x,\\phi^{*}) is called a solution for the optimal portfolio problem with initial investment x and utility function u , if \\mathbb{E}(u(V_{1}(x,\\phi^{*}))=\\max_{\\phi}\\mathbb{E}\\big{(}u(V_{1}(x,\\phi))% \\big{)} (3.1.1) It is not clear whether a solution to the optimal portfolio problem exists. That depends in general on the particular model and the chosen utility function. An interesting relationship is the relationship between the existence of a solution to the optimal portfolio problem and the existence of an arbitrage. Assume for the moment, that there exists an arbitrage (0,\\psi) in our model. Then for every trading strategy (x,\\phi) we would have V_{1}(x,\\phi+\\psi)(\\omega)=V_{1}(x,\\phi)(\\omega)+V_{1}(0,\\psi)(\\omega)\\geq V_{% 1}(x,\\phi)(\\omega), where (x,\\phi+\\psi) is the trading strategy given by the sum of (x,\\phi) and (0,\\psi) , i.e. the trading strategy which buys \\phi^{i}+\\psi^{i} shares of the i -th stock. By the definition of an arbitrage, this strategy needs an initial investment of x . That the inequality above holds is also a result of (0,\\psi) being an arbitrage, but we can say even more, the inequality above is strict for at least one \\omega . Therefore for any risk averse utility function u we have \\mathbb{E}(u(V_{1}(x,\\phi+\\psi)))>\\mathbb{E}(u(V_{1}(x))). Hence in the presence of an arbitrage for every strategy (x,\\phi) there is another strategy with same initial investment which does perform strictly better. Consequently, if there is an arbitrage in the market then there is no solution to the optimal portfolio problem or in other words: Proposition 3.1.3. If there exists a solution to the optimal portfolio problem then there can not exist an arbitrage in the market. We already know by the fundamental theorem of asset pricing that the no arbitrage property is equivalent to the existence of a risk neutral measure. Such a risk neutral measure can be explicitly computed from a solution to the optimal portfolio problem as the following proposition shows. Proposition 3.1.4. Let (x,\\phi^{*}) be a solution to the optimal portfolio problem with initial wealth x and utility function u , then the measure \\mathbb{Q} defined by \\mathbb{Q}(\\omega)=\\frac{\\mathbb{P}(\\omega)u^{\\prime}(V_{1}(x,\\phi^{*})(\\omega% ))}{\\mathbb{E}(u^{\\prime}(V_{1}(x,\\phi^{*}))},\\quad\\omega\\in\\Omega, is a risk neutral probability measure. Proof. That \\mathbb{Q} is indeed a probability measure follows from \\mathbb{Q}(\\omega)>0 for all \\omega (recall that u^{\\prime}(x)>0 for all x ) and \\displaystyle\\sum_{i=1}^{k}\\mathbb{Q}(\\omega_{i}) \\displaystyle= \\displaystyle\\sum_{i=1}^{k}\\frac{\\mathbb{P}(\\omega_{i})u^{\\prime}(V_{1}(x,\\phi% ^{*})(\\omega_{i}))}{\\mathbb{E}(u^{\\prime}(V_{1}(x,\\phi^{*}))} \\displaystyle= \\displaystyle\\frac{1}{\\mathbb{E}(u^{\\prime}(V_{1}(x,\\phi^{*}))}\\sum_{i=1}^{k}% \\mathbb{P}(\\omega_{i})u^{\\prime}(V_{1}(x,\\phi^{*})(\\omega_{i})) \\displaystyle= \\displaystyle\\frac{1}{\\mathbb{E}(u^{\\prime}(V_{1}(x,\\phi^{*}))}\\mathbb{E}(u^{% \\prime}(V_{1}(x,\\phi^{*})) \\displaystyle= \\displaystyle 1. It remains to prove that \\mathbb{Q} satisfies condition 2. of Definition 1.2.7. We know that the function \\phi\\mapsto\\mathbb{E}(u(V_{1}(x,\\phi))),\\quad\\phi\\in\\mathbb{R}^{n}, is differentiable and attains its maximum at a point \\phi^{*}\\in\\mathbb{R}^{n} . Therefore all partial derivatives of this function must vanish at the point \\phi^{*} . This leads to the following equations: 0=\\left.\\frac{\\partial}{\\partial\\phi_{j}}\\mathbb{E}\\Big{(}u\\big{(}B_{1}(x+\\phi% ^{1}\\Delta\\hat{S}^{1}(\\omega_{i})+...+\\phi^{n}\\Delta\\hat{S}^{n}(\\omega_{i}))% \\big{)}\\Big{)}\\right|_{\\phi=\\phi^{*}},\\quad j=1,..n, (3.1.2) since using the well known identities V_{1}(x,\\phi)=B_{1}\\hat{V}_{1}(x,\\phi) and \\hat{V}_{1}(x,\\phi)=x+\\hat{G}(x,\\phi) we have \\mathbb{E}(u(V_{1}(x,\\phi)))=\\mathbb{E}(u(B_{1}(x+\\phi^{1}\\Delta\\hat{S}^{1}+..% .+\\phi^{n}\\Delta\\hat{S}^{n}))). (3.1.3) Computing derivatives in (3.1.2) gives: \\displaystyle 0 \\displaystyle=\\sum_{i=1}^{k}\\mathbb{P}(\\omega_{i})u^{\\prime}(B_{1}(x+\\phi^{*1}% \\Delta\\hat{S}^{1}(\\omega_{i})+...+\\phi^{*n}\\Delta\\hat{S}^{n}(\\omega_{i})))% \\cdot B_{1}\\cdot\\Delta\\hat{S}^{j}(\\omega_{i}) \\displaystyle=B_{1}\\cdot\\sum_{i=1}^{k}\\mathbb{P}(\\omega_{i})u^{\\prime}(V_{1}(x% ,\\phi^{*}))\\cdot\\Delta\\hat{S}^{j}(\\omega_{i}),\\qquad j=1,\\ldots,n. Since B_{1}=1+r>0 this is equivalent to 0=\\sum_{i=1}^{k}\\mathbb{P}(\\omega_{i})u^{\\prime}(V_{1}(x,\\phi^{*}))\\cdot\\Delta% \\hat{S}^{j}(\\omega_{i}),\\quad j=1,\\ldots,n. This implies that for j=1,\\ldots,n \\displaystyle\\mathbb{E}_{\\mathbb{Q}}(\\Delta\\hat{S}^{j}) \\displaystyle= \\displaystyle\\sum_{i=1}^{k}\\mathbb{Q}(\\omega_{i})\\Delta\\hat{S}^{j}(\\omega_{i}) \\displaystyle= \\displaystyle\\sum_{i=1}^{k}\\frac{\\mathbb{P}(\\omega_{i})u^{\\prime}(V_{1}(x,\\phi% ^{*})(\\omega_{i}))}{\\mathbb{E}(u^{\\prime}(V_{1}(x,\\phi^{*}))}\\cdot\\Delta\\hat{S% }^{j}(\\omega_{i}) \\displaystyle= \\displaystyle\\frac{1}{\\mathbb{E}(u^{\\prime}(V_{1}(x,\\phi^{*}))}\\sum_{i=1}^{k}% \\mathbb{P}(\\omega_{i})u^{\\prime}(V_{1}(x,\\phi^{*})(\\omega_{i}))\\cdot\\Delta\\hat% {S}^{j}(\\omega_{i}) \\displaystyle= \\displaystyle 0. ∎ Notice that risk neutral measures pop up both in pricing and replication, and in optimal portfolio selection. This hints that these problems are deeply interconnected. We will pursue this issue after the example which shows how optimal portfolios can be computed explicitly in our general single period market model. Previous page Next page"],[["index.html","Pt8.html"],"Lecture VIII 19/11/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 19/11/2024 Lecture VIII 19/11/2024 Example 3.1.5. Suppose that n=2 , k=3 , r=\\frac{1}{9} , \\hat{S}_{0}^{1}=6 , \\hat{S}_{0}^{2}=10 and that the discounted price process is given by the following table: \\omega_{1} \\omega_{2} \\omega_{3} \\hat{S}_{1}^{1} 6 8 4 \\hat{S}_{1}^{2} 13 9 8 We wish to use the exponential utility function with \\lambda=1 , i.e. u(x)=1-\\exp(-x) . Since additive constants does not play a role in our optimisation process we shall use an equivalent but simpler utility function u(x)=-\\exp(-x) . In order to compute the optimal trading strategy for an initial investment x , we have to compute the maximum of the function \\displaystyle U:\\mathbb{R}^{2} \\displaystyle\\to \\displaystyle\\mathbb{R} \\displaystyle(\\phi^{1},\\phi^{2}) \\displaystyle\\mapsto \\displaystyle\\mathbb{E}(-\\exp(-(V_{1}(x,(\\phi^{1},\\phi^{2}))))). Using equation (3.1.3), computing the expectation and setting the partial derivatives with respect to \\phi^{1} and \\phi^{2} equal to zero, we obtain the following two equations: \\displaystyle 0= \\displaystyle\\ \\mathbb{P}(\\omega_{1})\\exp\\left(-\\left(\\frac{10}{9}\\right)(x+0% \\phi^{1}+3\\phi^{2}\\right)\\cdot\\frac{10}{9}\\cdot 0 \\displaystyle+\\mathbb{P}(\\omega_{2})\\exp\\left(-\\left(\\frac{10}{9}\\right)(x+2% \\phi^{1}-\\phi^{2}\\right)\\cdot\\frac{10}{9}\\cdot 2 \\displaystyle+\\mathbb{P}(\\omega_{3})\\exp\\left(-\\left(\\frac{10}{9}\\right)(x-2% \\phi^{1}-2\\phi^{2}\\right)\\cdot\\frac{10}{9}\\cdot(-2), and \\displaystyle 0= \\displaystyle\\ \\mathbb{P}(\\omega_{1})\\exp\\left(-\\left(\\frac{10}{9}\\right)(x+0% \\phi^{1}+3\\phi^{2}\\right)\\cdot\\frac{10}{9}\\cdot 3 \\displaystyle+\\mathbb{P}(\\omega_{2})\\exp\\left(-\\left(\\frac{10}{9}\\right)(x+2% \\phi^{1}-\\phi^{2}\\right)\\cdot\\frac{10}{9}\\cdot(-1) \\displaystyle+\\mathbb{P}(\\omega_{3})\\exp\\left(-\\left(\\frac{10}{9}\\right)(x-2% \\phi^{1}-2\\phi^{2}\\right)\\cdot\\frac{10}{9}\\cdot(-2). These two equations have to be solved for \\phi^{1} and \\phi^{2} . Although numerically possible this may not be easy. We therefore propose another technique in the following. ∎ As you could see the naive technique to solve the optimal portfolio problem can be computationally difficult. There is however a more efficient technique to solve the problem. This technique involves risk neutral measures and the Lagrange multiplier method to find an optimum under constraints (Step 1 below). The idea of the technique is as follows: Decompose the optimal portfolio problem into two subproblems: Step 1: Compute the maximiser V_{1} of the function V\\mapsto\\mathbb{E}u(V) , where V is allowed to take values is a certain feasible set. Step 2: Compute a trading strategy which has the maximiser V_{1} computed in Step 1 as value at time t=1 . The trading strategy arising from the second step is then an optimal portfolio. Step 2 is in fact a replication or hedging problem and we know that such a problem poses certain difficulties in an incomplete market model. Therefore, let us assume first that our model is complete. In this case there is a unique risk neutral measure which we denote by \\mathbb{Q} (see Theorem 1.2.26). Definition 3.1.6. We define the set of attainable wealths from initial investment x>0 by \\boxed{\\mathbb{W}_{x}:=\\left\\{W\\in\\mathbb{R}^{k}\\middle|\\mathbb{E}_{\\mathbb{Q}% }\\left(\\frac{1}{1+r}W\\right)=x\\right\\}.} It follows from Propositions 1.2.25 and 1.2.17 that if W\\in\\mathbb{W}_{x} then there exists a trading strategy (x,\\phi) such that W=V_{1}(x,\\phi) and hence the name is justified. The first step of our optimisation process can be stated as the following constrained optimisation problem: maximise \\displaystyle\\mathbb{E}(u(W)) subject to \\displaystyle W\\in\\mathbb{W}_{x}. This problem can be solved by the Lagrange multiplier method. To do this we consider the Lagrange function \\boxed{\\mathcal{L}(W,\\lambda):=\\mathbb{E}(u(W))-\\lambda\\left(\\mathbb{E}_{% \\mathbb{Q}}\\left(\\frac{1}{1+r}W\\right)-x\\right).} (3.1.4) A solution of the above constrained optimisation problem may then be computed by setting all partial derivatives with respect to W_{i}=W(\\omega_{i}) and \\lambda equal to zero. In the definition of the Lagrange function in (3.1.4) we have to compute expectations with respect to two different measures \\mathbb{P} and \\mathbb{Q} . In order to avoid this, we introduce the so called state price density L(\\omega):=\\frac{\\mathbb{Q}(\\omega)}{\\mathbb{P}(\\omega)}. (3.1.5) Then for any random variable Y we have \\mathbb{E}_{\\mathbb{Q}}Y=\\mathbb{E}LY. Using the state price density we can write the Lagrange function as follows: \\mathcal{L}(W,\\lambda)=\\sum_{i=1}^{k}\\mathbb{P}(\\omega_{i})\\left[u(W(\\omega_{i% }))-\\lambda\\left(L(\\omega_{i})\\frac{1}{1+r}W(\\omega_{i})-x\\right)\\right] Computing the partial derivatives with respect to W_{i}=W(\\omega_{i}) and setting them equal to zero gives u^{\\prime}(W(\\omega_{i}))=\\lambda\\frac{L(\\omega_{i})}{1+r},\\quad i\\in\\{i,\\dots% ,k\\}. (3.1.6) Taking the expected value (i.e. multiplying with \\mathbb{P}(\\omega_{i}) and summing over i ) of both sides of the above equality we obtain: \\lambda=\\mathbb{E}((1+r)u^{\\prime}(W)). (3.1.7) Let us denote the inverse function of u^{\\prime}(x) with I(x) , i.e.  I(x) is the function s.t. u^{\\prime}(I(x))=x=I(u^{\\prime}(x)) . Such a function exists, since u^{\\prime}(x) is strictly decreasing by property 3. of a utility function. It is easy to check that (1)​ I is strictly decreasing, (2)​ \\lim_{x\\to 0}I(x)=\\infty , (3)​ \\lim_{x\\to\\infty}I(x)=0 . Applying I to equation (3.1.6) we obtain \\boxed{W(\\omega)=I\\left(\\lambda\\frac{L(\\omega)}{1+r}\\right).} (3.1.8) This last equation would give the solution of the constrained optimisation problem if we knew the correct value of \\lambda . Equation (3.1.7) does not help us in computation of \\lambda since it involves the so far still unknown W . We know however that W must satisfy \\mathbb{E}_{\\mathbb{Q}}\\left(\\frac{1}{1+r}W\\right)=x and substituting the expression from equation (3.1.8) into last equation we obtain \\boxed{\\mathbb{E}_{\\mathbb{Q}}\\left(\\frac{1}{1+r}I\\left(\\lambda\\frac{L}{1+r}% \\right)\\right)=x.} (3.1.9) If we solve this equation for \\lambda and plug the solution into (3.1.8), we get the solution of our constrained optimisation problem. Such a \\lambda always exists and is in fact uniquely determined by equation (3.1.9) because the function h(\\lambda):=\\mathbb{E}_{\\mathbb{Q}}\\left(\\frac{1}{1+r}I\\left(\\lambda\\frac{L(% \\omega)}{1+r}\\right)\\right) is strictly decreasing, continuous and satisfies \\lim_{\\lambda\\to 0}h(\\lambda)=\\infty and \\lim_{\\lambda\\to\\infty}h(\\lambda)=0 . Example 3.1.7. Suppose the utility function in the optimal portfolio problem is given by u(x)=\\ln(x) . In this case u^{\\prime}(x)=\\frac{1}{x} and therefore I(x)=\\frac{1}{x} as well. Hence, the optimal wealth in equation (3.1.8) is given by W=I\\Big{(}\\lambda\\frac{L}{1+r}\\Big{)}=\\frac{1+r}{\\lambda L}. (3.1.10) We remind ourselves that L>0 so the above expression is well defined. Equation (3.1.9) gets the following form: \\mathbb{E}_{\\mathbb{Q}}\\Bigg{(}\\frac{1}{1+r}I\\Big{(}\\lambda\\frac{L}{1+r}\\Big{)% }\\Bigg{)}=x. The solution can be easily computed and is given by \\lambda=\\frac{1}{x}. Substituting the last expression in equation (3.1.10) we obtain W=x\\frac{1+r}{L}. (3.1.11) This is the optimal wealth in the general complete single period market model where logarithmic utility of the form u(x)=\\ln(x) is used. In order to compute the optimal trading strategy we would now have to find a hedging strategy for W . This strategy depends on the specific model. We have discussed methods how to find replicating strategies in the previous sections. Let us now compute the optimal expected utility, i.e. the expected utility of the optimal wealth we have just calculated. Plugging the expression for the optimal wealth W from (3.1.11) into u(x) gives u(W)=\\ln(x)+\\ln\\frac{1+r}{L}. Computing the expectation yields \\mathbb{E}(u(W))=\\ln(x)+\\mathbb{E}\\left(\\ln\\frac{1+r}{L}\\right). Let us now consider the optimal portfolio problem for a market model which is incomplete. The crucial difference to the previous case where we studied a complete model is that one has to be more careful when defining the set of attainable wealths. In a complete market model every contingent claim is attainable and in defining the set of attainable wealths one has only to take the initial investment into account. Doing the same thing in an incomplete market it might be that the optimal wealth computed is not attainable at all. The remark concluding Definition 3.1.6 does not hold in the incomplete market case. We have therefore to modify Definition 3.1.6 in the way that \\mathbb{W}_{x} only contains wealths which are indeed attainable by trading strategies, which start with an initial investment of x . We know from Proposition 1.2.25 that a contingent claim X in a possibly incomplete market model is attainable if and only if the value of \\mathbb{E}_{\\mathbb{Q}}(\\frac{1}{1+r}X) is the same for all \\mathbb{Q}\\in\\mathbb{M} . The natural generalization of Definition 3.1.6 for the case of an incomplete single period market model is therefore: Definition 3.1.8. We define the set of attainable wealths from initial investment x>0 in a possibly incomplete market model by \\boxed{\\mathbb{W}_{x}:=\\left\\{W\\in\\mathbb{R}^{k}\\middle|\\mathbb{E}_{\\mathbb{Q}% }\\left(\\frac{1}{1+r}W\\right)=x\\mbox{ for all }\\mathbb{Q}\\in\\mathbb{M}\\right\\}.} The first step in the optimal portfolio problem is then formally the same as the first step in the complete market case: \\boxed{\\begin{split}\\mbox{maximise }&&\\mathbb{E}(u(W))\\\\ \\mbox{subject to }&&W\\in\\mathbb{W}_{x}.\\end{split}} The real problem lies here in the set of constraints determining the set \\mathbb{W}_{x} . We already know that in general in an incomplete market model there exists an infinite number of risk neutral measures leading to an infinite number of constraints. The Lagrange multiplier method which we used to solve the optimal portfolio problem before works only for a finite number of constraints. Therefore we have to reduce the number of constraints to a finite number. This is possible as the following lemma shows. Lemma 3.1.9. Consider a general single period, possibly incomplete, market model. Then there exist finitely many probability measures \\mathbb{Q}_{i}\\in\\overline{\\mathbb{M}} , i=1,...,l such that the space \\mathbb{W}_{x} from Definition 3.1.8 is given by \\boxed{\\mathbb{W}_{x}:=\\left\\{W\\in\\mathbb{R}^{k}\\middle|\\mathbb{E}_{\\mathbb{Q}% _{i}}\\left(\\frac{1}{1+r}W\\right)=x\\mbox{ for all }i=1,...,l\\right\\}.} Notice a mysterious bar over \\mathbb{M} in the statement of the lemma. It stands for the closure of \\mathbb{M} , i.e. the set \\mathbb{M} together with its boundary. If we characterise \\mathbb{M} by a system of equalities and inequalities, as we can always do, all the inequalities are strict. They are basically derived from the condition that the probability of each \\omega must be greater than 0 and smaller than 1 . Now, we obtain \\overline{\\mathbb{M}} by changing all the strict inequalities > and < to \\geq and \\leq . We omit the proof of this lemma. The main reason why this lemma holds is that the space \\mathbb{M} can be expressed as the intersection of the finite dimensional vectorspace \\mathbb{W}^{\\bot} and the set \\mathcal{P}^{+} and can therefore be written as a convex combination of a finite number of fixed risk neutral measures. The optimal portfolio problem above then translates into the problem \\boxed{\\begin{split}\\mbox{maximise }&&\\mathbb{E}(u(W))\\\\ \\mbox{subject to }&&\\mathbb{E}_{\\mathbb{Q}_{i}}\\left(\\frac{W}{1+r}\\right)=x,i=% 1,...,l.\\end{split}} This problem is a constrained optimisation problem with a finite number of constraints and can therefore be solved by the Lagrange multiplier method in the same way as before. Defining the Lagrange function \\mathcal{L} via \\mathcal{L}(W,\\lambda)=\\mathbb{E}(u(W))-\\sum_{i=1}^{l}\\lambda_{i}\\left(\\mathbb% {E}\\left(\\frac{L_{i}W}{1+r}\\right)-x\\right) with L_{i}(\\omega)=\\frac{\\mathbb{Q}_{i}(\\omega)}{\\mathbb{P}(\\omega)} and \\lambda=(\\lambda_{1},...,\\lambda_{l})^{T} we obtain as the solution of the first step in the optimal portfolio problem \\boxed{W(\\omega)=I\\left(\\sum_{i=1}^{l}\\lambda_{i}\\frac{L_{i}(\\omega)}{1+r}% \\right).} To obtain the unknown Lagrange multiplier one now has to solve the l equations \\boxed{\\mathbb{E}\\left(L_{i}I\\left(\\frac{\\lambda_{1}L_{1}+...+\\lambda_{l}L_{l}% }{1+r}\\right)\\right)=(1+r)x,\\quad i=1,\\ldots,l.} Solutions of this system of equations exist and are unique by the same reasons as in the complete case. 3.2. Returns This section acts as a introduction for the famous Capital Asset Pricing Model that will be discussed in the following section. We shall set up some notation regarding the returns of trading strategies and obtain a few key relations. As in the previous section we use the notation L for the state price density \\boxed{L(\\omega)=\\frac{\\mathbb{Q}(\\omega)}{\\mathbb{P}(\\omega)}.} Here \\mathbb{Q} is a fixed risk neutral measure. It is not important whether the model is complete or not, but in the case of incompleteness we choose one risk neutral measure \\mathbb{Q} for the rest of the section. The return of the i -th stock in our model is defined by the random variable \\boxed{R^{i}=\\frac{S^{i}_{1}-S^{i}_{0}}{S^{i}_{0}},\\qquad i=1,\\ldots,n.} The return of the money market account is given by the deterministic interest rate, i.e. \\boxed{R^{0}=\\frac{B_{1}-B_{0}}{B_{0}}=r.} Most computations in our single period market model can be done by using the returns instead of the actual stock prices. For example the gains process can be written as G(x,\\phi)=\\left(x-\\sum_{i=1}^{n}\\phi^{i}S^{i}_{0}\\right)R^{0}+\\sum_{i=1}^{n}% \\phi^{i}S^{i}_{0}R^{i}. (3.2.1) The verification of the last equation is left as an exercise. To simplify the notation in the following we denote the investment x-\\sum_{i=1}^{n}\\phi^{i}S^{i}_{0} in the money market account implemented by the trading strategy (x,\\phi) with \\phi^{0} . A trading strategy can then be represented by an n+1 -dimensional vector \\overline{\\phi}=(\\phi^{0},\\phi^{1},...,\\phi^{n}) . It follows from the second property in Definition 1.2.7 of a risk neutral measure that \\mathbb{E}_{\\mathbb{Q}}(R^{i})=r,\\qquad i=1,\\ldots,n. This can be seen as follows: \\displaystyle\\mathbb{E}_{\\mathbb{Q}}(R^{i})=\\mathbb{E}_{\\mathbb{Q}}\\bigg{(}% \\frac{S^{i}_{1}-S^{i}_{0}}{S^{i}_{0}}\\bigg{)}=\\frac{\\mathbb{E}_{\\mathbb{Q}}(S^% {i}_{1})-S^{i}_{0}}{S^{i}_{0}}=\\frac{S^{i}_{0}(1+r)-S^{i}_{0}}{S^{i}_{0}}=% \\frac{rS^{i}_{0}}{S^{i}_{0}}=r. Here we used the fact that S^{i}_{0} is a number (not a random variable). We denote the mean return of the i -th stock by \\overline{R}^{i}=\\mathbb{E}(R^{i}). Let us now consider the covariance of the returns with the state price density. We have \\displaystyle\\operatorname{Cov}(R^{i},L) \\displaystyle= \\displaystyle\\mathbb{E}(R^{i}L)-\\mathbb{E}(R^{i})\\mathbb{E}(L) \\displaystyle= \\displaystyle\\mathbb{E}_{\\mathbb{Q}}(R^{i})-\\mathbb{E}(R^{i}) \\displaystyle= \\displaystyle r-\\overline{R}^{i}. The difference \\overline{R}^{i}-r is called the risk premium. Normally this is positive, because investors insist that the expected returns of the risky securities are higher than the returns of riskless securities such as money market accounts. Let us now consider the return of a portfolio, or more precisely the return induced by the value of a trading strategy: R(x,\\phi)=\\frac{V_{1}(x,\\phi)-V_{0}(x,\\phi)}{V_{0}(x,\\phi)}. In the following we will omit the dependence of R(x,\\phi) and V(x,\\phi) on the trading strategy (x,\\phi) and just write R and V . Using the definition of V_{1} and (3.2.1) we obtain R=\\frac{\\phi^{0}}{V_{0}}r+\\sum_{i=1}^{n}\\frac{\\phi^{i}S^{i}_{0}}{V_{0}}R^{i}. It follows from the properties of the covariance and the previous discussion on the R^{i} that \\overline{R}-r=-\\operatorname{Cov}(R,L) (3.2.2) where \\overline{R}=\\mathbb{E}(R) is the expected return of the portfolio. We leave the details as an exercise. Let us now fix two scalars a and b with b\\neq 0 and assume that the contingent claim a+bL is attainable. This might seem like a very arbitrary assumption, but we will see later on in this section that it holds for so called minimum-variance portfolios. In this case there exists a trading strategy (x^{\\prime},\\phi^{\\prime}) such that the corresponding value process V_{t}^{\\prime}=V_{t}(x^{\\prime},\\phi^{\\prime}) for t=0,1 satisfies V_{1}^{\\prime}=a+bL. Denoting with R^{\\prime} the return corresponding to V^{\\prime} we obtain V_{0}^{\\prime}(1+R^{\\prime})=a+bL. Solving this equation for L gives L=\\frac{V_{0}^{\\prime}(1+R^{\\prime})-a}{b}. Using this form, we get from the linearity of covariance that \\operatorname{Cov}(R,L)=\\frac{V_{0}^{\\prime}}{b}\\operatorname{Cov}(R,R^{\\prime% }). (3.2.3) Here R still corresponds to an arbitrary trading strategy. We can therefore rewrite equation (3.2.2) as \\overline{R}-r=-\\frac{V_{0}^{\\prime}}{b}\\operatorname{Cov}(R,R^{\\prime}). For the particular case of R=R^{\\prime} we obtain \\overline{R}^{\\prime}-r=-\\frac{V_{0}^{\\prime}}{b}\\operatorname{Var}(R^{\\prime}). We can now use the last equality in order to substitute for \\frac{V_{0}^{\\prime}}{b} in (3.2.3), which gives \\boxed{\\overline{R}-r=\\frac{\\operatorname{Cov}(R,R^{\\prime})}{\\operatorname{% Var}(R^{\\prime})}(\\overline{R^{\\prime}}-r).} (3.2.4) Formula (3.2.4) holds whenever R^{\\prime} is the return process of the contingent claim a+bL and the latter is attainable. We will later see the importance of this formula in connection with the Capital Asset Pricing Model (CAPM). The ratio \\frac{\\operatorname{Cov}(R,R^{\\prime})}{\\operatorname{Var}(R^{\\prime})} is sometimes called the beta of the trading strategy corresponding to R with respect to the trading strategy corresponding to R^{\\prime} . The formula says, that the risk premium is proportional to its beta with respect to a linear transformation of the state price density. 3.3. Mean-Variance Analysis We now come to a central issue in single period market models, the so called Mean-Variance approach to portfolio analysis, which goes back mainly to Markowitz. Harry Max Markowitz (born August 24, 1927) was (passed away in summer 2023) an influential economist at the Rady School of Management at the University of California, San Diego. Formerly at the RAND Corporation, Markowitz won the Nobel Prize in 1990 while a professor of finance at Baruch College of the City University of New York. He is best known for his pioneering work in modern portfolio theory, studying the effects of asset risk, correlation and diversification on expected investment portfolio returns. The main idea of his results is that when agents are offered two financial assets having the same expected return they would choose the asset that has the lower variance , i.e. is less risky. A few paragraphs ago we have already written the portfolio return as a weighted sum of individual returns, namely we wrote R=\\frac{\\phi^{0}}{V_{0}}r+\\sum_{i=1}^{n}\\frac{\\phi^{i}S^{i}_{0}}{V_{0}}R^{i}. To that end, we now give these weights names w_{0}=\\frac{\\phi^{0}}{V_{0}(x,\\phi)} and w_{i}=\\frac{\\phi^{i}S_{0}}{V_{0}(x,\\phi)},\\quad i=1,\\dots,n, which we call the portfolio weights or portfolio fractions. With these weights, a portfolio return can then be written as a sum of individual asset returns R=w_{0}r+\\sum_{i=1}^{n}w_{i}R^{i}. Using this and what we have already learned before, we can restate some of the results we have already established in this new language. Proposition 3.3.1. Let the portfolio weights w_{0},\\dots,w_{n} be defined as above. Then, the weights and corresponding portfolio satisfy the following properties: •​ \\sum_{i=0}^{n}w_{i}=1 , •​the stock i is shorted if and only if w_{i}<0 , •​there are no short-sales of stocks in the portfolio if w_{1}\\geq 0,\\dots,w_{n}\\geq 0 , and •​there are no short-sales and no borrowing if w_{0}\\geq 0,\\dots,w_{n}\\geq 0 . We leave the simple proof of this proposition as an exercise and proceed to state some very simple properties of how a portfolio return relates to the individual asset returns. Proposition 3.3.2. Consider a portfolio with weights w_{0},\\dots,w_{n} and returns R^{0},R^{1},\\dots,R^{n} where R^{0} is the risk-free rate r . The portfolio return R=\\sum_{i=0}^{n}w_{i}R^{i} then has the following properties: •​the expected portfolio return is \\bar{R}=\\mathbb{E}(R)=\\sum_{i=0}^{n}\\mathbb{E}(R^{i})=\\sum_{i=0}^{n}\\bar{R}^{i}, •​the variance of the portfolio return is \\sigma^{2}=\\operatorname{Var}(R)=\\sum_{i,j=0}^{n}w_{i}w_{j}\\sigma_{ij}, where \\sigma_{ij}=\\operatorname{Cov}(R^{i},R^{j}) , and •​the standard deviation of the portfolio return is \\sigma=\\sqrt{\\operatorname{Var}(R)}=\\sqrt{\\sum_{i,j=0}^{n}w_{i}w_{j}\\sigma_{ij% }}. These properties follow directly from the linearity of expectation and the definition of variance and covariance and are left as an exercise. It is helpful to notice that since the return R^{0} isn’t actually random, all of the covariances involving it are always equal to 0 , that is \\sigma_{0i}=\\sigma_{i0}=0 for all i\\in\\{0,\\dots,n\\} . Example 3.3.3. Suppose our portfolio consists of two assets with returns \\bar{R}^{1}=0.12 and \\bar{R}^{2}=0.15 , standard deviations \\sigma_{1}=0.20 and \\sigma_{2}=0.18 and covariance \\sigma_{12}=0.01 . The weights of the two assets in our portfolio are w_{1}=0.25 and w_{2}=0.75 . We can calculate that the expected return of this portfolio is then \\bar{R}=w_{1}\\bar{R}^{1}+w_{2}\\bar{R}^{2}=0.25\\cdot 0.12+0.75\\cdot 0.15=0.1425 and its variance is \\displaystyle\\sigma^{2} \\displaystyle=w_{1}^{2}\\sigma_{1}^{2}+w_{1}w_{2}\\sigma_{12}+w_{2}w_{1}\\sigma_{% 21}+w_{2}^{2}\\sigma_{2}^{2} \\displaystyle=0.25^{2}\\cdot 0.20^{2}+0.25\\cdot 0.75\\cdot 0.01+0.75\\cdot 0.25% \\cdot 0.01+0.75^{2}\\cdot 0.18^{2} \\displaystyle=0.024475, so the standard deviation equals 0.1564 . Notice that this value is lower than both of the asset standard deviations, even though the two assets are nowhere near to being negatively correlated! Previous page Next page"],[["index.html","Pt9.html"],"Lecture IX 26/11/2024 ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. 26/11/2024 Lecture IX 26/11/2024 A useful way to look at portfolio returns and compare different portfolios to each other is the so-called mean-standard deviation diagram depicted in Figure 5. A mean-standard deviation diagram depicting 3 different assets. The horizontal position of each asset matches its standard deviation, whereas its vertical position matches its expected return. Assets higher up have higher expected returns, while assets further to the right have higher standard deviation. Figure 5. A mean-standard deviation diagram depicting 3 different assets. The horizontal position of each asset matches its standard deviation, whereas its vertical position matches its expected return. Assets higher up have higher expected returns, while assets further to the right have higher standard deviation. A naive look at the 3 assets in Figure 5 might lead us to think that an optimal portfolio consisting of a combination of assets 1 to 3 would focus entirely on asset 3, since it has both the highest expected return and smallest standard deviation, so it is by all reasonable measures the best performing asset. Somewhat counterintuitively, unless assets are perfectly correlated (which they never are), we might be able to construct a portfolio using all 3 assets that has the same (or even higher if short selling is allowed) return and a possibly lower standard deviation then a portfolio consisting of only asset 3. To help us understand how, we start by considering all portfolios consisting of only two assets and look at how the mean and standard deviation of a portfolio might look like, depending on the choices of the weights w_{1} and w_{2} and what the covariance of the two assets is. Let us for the moment assume that short selling is not allowed, so that w_{1}\\geq 0 and w_{2}\\geq 0 . Don’t forget that the portfolio weights represent the proportion of wealth that a given asset represents in the portfolio, so w_{1}+w_{2}=1 and therefore we can simply set w_{2}=1-w_{1} . A quick calculation immediately shows us that no matter what the standard deviations and covariance are, the expected return of the portfolio satisfies \\bar{R}=w_{1}\\bar{R}^{1}+(1-w_{1})\\bar{R}^{2}\\in[\\bar{R}^{1},\\bar{R}^{2}]. If we write \\rho:=\\frac{\\sigma_{12}}{\\sigma_{1}\\sigma_{2}} for the correlation between assets 1 and 2 we are interested in what the standard deviation of the portfolio with weights w_{1} and w_{2} is, depending on \\rho . Let us consider first the case where the two assets are perfectly correlated, that is when \\rho=1 . Using the formula to calculate the covariance of a portfolio, we get \\displaystyle\\operatorname{Var}(R) \\displaystyle=w_{1}^{2}\\sigma_{1}^{2}+2w_{1}w_{2}\\sigma_{12}+w_{2}^{2}\\sigma_{% 2}^{2} \\displaystyle=w_{1}^{2}\\sigma_{1}^{2}+2w_{1}w_{2}\\rho\\sigma_{1}\\sigma_{2}+w_{2% }^{2}\\sigma_{2}^{2} \\displaystyle=w_{1}^{2}\\sigma_{1}^{2}+2w_{1}w_{2}\\sigma_{1}\\sigma_{2}+w_{2}^{2% }\\sigma_{2}^{2} \\displaystyle=(w_{1}\\sigma_{1}+w_{2}\\sigma_{2})^{2}, and so the standard deviation of the portfolio \\sigma=\\sqrt{(w_{1}\\sigma_{1}+w_{2}\\sigma_{2})^{2}}=w_{1}\\sigma_{1}+(1-w_{1})% \\sigma_{2} is a convex combination of \\sigma_{1} and \\sigma_{2} and therefore lies between \\sigma_{1} and \\sigma_{2} as well. In fact, \\sigma is in this case just the weighted average of \\sigma_{1} and \\sigma_{2} with weights w_{1} and 1-w_{1} , which matches the weights in the calculation of \\bar{R} above. Consequently, each combination of the two assets lies on a straight line between the Asset 1 and Asset 2 in the mean-standard deviation diagram (see Figure 6). The other extreme is if the two assets are perfectly negatively correlated, that is if \\rho=-1 . Calculating as above we get that \\displaystyle\\sigma \\displaystyle=\\sqrt{(w_{1}\\sigma_{1}-(1-w_{1})\\sigma_{2})^{2}} \\displaystyle=|w_{1}(\\sigma_{1}+\\sigma_{2})-\\sigma_{2}| which is equal to w_{1}(\\sigma_{1}+\\sigma_{2})-\\sigma_{2} when w_{1}>\\frac{\\sigma_{2}}{\\sigma_{1}+\\sigma_{2}} and equal to \\sigma_{2}-w_{1}(\\sigma_{1}+\\sigma_{2}) when w_{1}<\\frac{\\sigma_{2}}{\\sigma_{1}+\\sigma_{2}} . Notice also that for w_{1}=\\frac{\\sigma_{2}}{\\sigma_{1}+\\sigma_{2}} , the standard deviation becomes \\sigma=0 . For \\rho\\in(-1,1) we cannot make any such simplification and are simply left with the expression \\sigma=\\sqrt{w_{1}^{2}\\sigma_{1}^{2}+2w_{1}(1-w_{1})\\rho\\sigma_{1}\\sigma_{2}+(% 1-w_{1})^{2}\\sigma_{2}^{2}} which makes \\sigma a parabola as a function of w_{1} . We do however know the bounds of this parabola, namely that it lies between the linear functions we have determined for \\rho=1 and \\rho=-1 . This relationship can be observed in Figure 6. The expected return and standard deviation of a portfolio consisting of assets 1 and 2, with weights Figure 6. The expected return and standard deviation of a portfolio consisting of assets 1 and 2, with weights w_{1},1-w_{1}\\geq 0 for various choices of the correlation \\rho . Note that no matter the choice of \\rho , the resulting mean-standard deviation curve lies within the triangle with corners in A, Asset 1 and Asset 2. The point A represents the portfolio with Asset 1 weight w_{1}=\\frac{\\sigma_{2}}{\\sigma_{1}+\\sigma_{2}} , which has return \\frac{\\sigma_{2}}{\\sigma_{1}+\\sigma_{2}}\\bar{R}_{1}+\\frac{\\sigma_{1}}{\\sigma_{% 1}+\\sigma_{2}}\\bar{R}_{2} . Notice that even without short-selling or using a riskless asset, we can build portfolios that have a lower standard deviation than either of the two assets on their own (unless \\rho\\sim 1 ). We now look at what happens if we still forbid short selling or using the money market account, but have n assets with which to build our portfolio, starting with n=3 . Using any pair from the 3 assets we can repeat the above construction to obtain an intermediate portfolio that lies on the mean-standard deviation curve between the two assets, with its own expected return and standard deviation, which we can then combine with the remaining 3rd asset. We have to be careful since the covariance between the 3rd asset and the intermediate portfolio depends on the covariance of the 3rd asset with both constituting assets of the intermediate portfolio, but we can easily compute its value by using the bi-linearity of covariance \\operatorname{Cov}(aX+bY,cZ)=ac\\operatorname{Cov}(X,Z)+bc\\operatorname{Cov}(Y,% Z). Using that any portfolio built like this still has to satisfy w_{1}+w_{2}+w_{3}=1 and w_{1},w_{2},w_{3}\\geq 0 , we get through considering all convex combinations of the 3 assets a solid 2 dimensional region, called the feasible set or feasible region. Looking at Figure 7 we can see why this region is indeed solid. Any combination of assets 1 and 2 will lie on the red curve. Treating this intermediate portfolio 1 as a new asset, we can repeat the analysis when combined with Asset 3 to sweep all values on the dashed black line. By making small changes to the composition of Portfolio 1, we can move it continuously along the entire red line, which makes the dotted line move continuously and results in a solid 2 dimensional region of expected returns and standard deviations. Figure 7. Any combination of assets 1 and 2 will lie on the red curve. Treating this intermediate portfolio 1 as a new asset, we can repeat the analysis when combined with Asset 3 to sweep all values on the dashed black line. By making small changes to the composition of Portfolio 1, we can move it continuously along the entire red line, which makes the dotted line move continuously and results in a solid 2 dimensional region of expected returns and standard deviations. In general, with n assets (and still no money market account) and short-selling not allowed, the feasible region will look as depicted in Figure 8. Two key properties that this region satisfies are: (1)​If there are at least 3 assets that are not perfectly correlated and have different means, the feasible region will be a solid two-dimensional region. (2)​The feasible region is convex to the left. In particular, this means that a straight line connecting any two points in the region does not cross the left boundary of the region. So far we did not allow short selling of assets to make the analysis easier to follow. We can however allow the asset weights w_{i} to be negative, as long as their sum still equals 1 (and we still do not allow the money market to be traded, so that w_{0}=0 ). Most of the analysis we did above still works and in particular both properties of the feasible region still hold also when short selling is allowed. Looking at Figure 8 we see that the feasible region with short selling contains the feasible region without short selling as a sub-region. Depending on the various variances and correlations of the assets, it is possible that the two regions share parts of the border on the left side of the picture (unlike our example in the figure where the two borders do not overlap). Left: The feasible region in black using Figure 8. Left: The feasible region in black using n different assets when no short selling is allowed. Right: The feasible region in grey using n different assets when short selling is allowed. Not that in both cases the combined weight of all assets equals 1 . This left boundary of the feasible region is called the minimum-variance set, since it represents portfolios that have, for a given mean rate of return, the smallest standard deviation and therefore also the smallest variance. Due to the convexity of the feasible region, a special point exists on this boundary, called the minimum-variance point which represents the portfolio consisting of a mix of the n different assets with the smallest possible variance. Let us consider now what kinds of portfolios from the feasible set a rational investor would choose. As we have seen in the previous section, such an investor would, given two portfolios with the same return, always choose the one with the smaller risk, that is with the smaller variance. In our current discussion, this is equivalent to saying that when choosing portfolios with the same expected return (same vertical position in the diagram), they would choose the left-most portfolio available, since that is precisely the portfolio with the smallest standard deviation. Consequently, rational investors would only build portfolios that lie on the minimum-variance set. We can also look at this problem from the other direction. If an investor had to choose between two portfolios that have the same variance, but different expected returns, it would make sense to choose the portfolio that has the larger of the returns (in technical terms, this property is called non-satiation, since the investor always “has room for more”). Consequently, rational investors will not only build portfolios that lie on the minimum-variance set, but will in fact restrict themselves to portfolios that lie above the minimum-variance point on this line. This set of portfolios has a special name and is referred to as the efficient frontier. Left: the minimum-variance set. Right: the efficient frontier. Figure 9. Left: the minimum-variance set. Right: the efficient frontier. 3.4. The Markowitz model We are now ready to formulate a mathematical problem that leads to minimum-variance portfolios. Remember that we are working with n assets that have expected returns \\bar{R}^{1},\\dots,\\bar{R}^{n} and covariances \\sigma_{ij} . A portfolio is still determined by the set of n weights w_{1},\\dots,w_{n} that sum up to 1. For the time being, we also still do not allow trading with the money-market account. Written like this, it is our task to find the portfolio with the smallest variance for a given desired expected return \\rho , or more concisely: \\boxed{\\begin{split}\\text{minimise}\\quad&\\operatorname{Var}(R)\\\\ \\text{subject to}\\quad&\\mathbb{E}(R)=\\rho\\\\ &R\\text{ is a portfolio return}.\\end{split}} Putting this into a more mathematical form, we are dealing with the problem minimise \\displaystyle\\frac{1}{2}\\sum_{i,j=1}^{n}w_{i}w_{j}\\sigma_{ij} subject to \\displaystyle\\sum_{i=1}^{n}w_{i}\\bar{R}^{i}=\\rho \\displaystyle\\sum_{i=1}^{n}w_{i}=1. A careful observer might wonder about the factor \\frac{1}{2} appearing in the minimisation statement; it is there for convenience only (it will cancel out a lot of terms in our calculation later) and it does not affect what choice of weights results in the smallest variance. The above problem is the famous Markowitz problem and we will now proceed to solve it. You might recognise that the Markowitz problem takes a similar form to the utility optimisation problem we have already tackled and so it should be no surprise that we will approach it in the same way, by using the method of Lagrange multipliers with two constraints. The Lagrangian will therefore take the form \\displaystyle\\mathcal{L}(w_{1},\\dots,w_{n},\\lambda_{1},\\lambda_{2}) \\displaystyle=\\frac{1}{2}\\sum_{i,j=1}^{n}w_{i}w_{j}\\sigma_{ij}-\\lambda_{1}(% \\sum_{i=1}^{n}w_{i}\\bar{R}^{i}-\\rho) \\displaystyle\\qquad\\qquad\\qquad\\qquad\\qquad-\\lambda_{2}(\\sum_{i=1}^{n}w_{i}-1). We now differentiate the Lagrangian with respect to each variable w_{i} and \\lambda_{1} and \\lambda_{2} and set this derivative to zero. We obtain a system of n+2 equations for n+2 unknowns that looks as follows: \\boxed{\\begin{split}\\sum_{i=j}^{n}\\sigma_{ij}w_{j}-\\lambda_{1}\\bar{R}^{i}-% \\lambda_{2}&=0,\\quad i=1,\\dots,n,\\\\ \\sum_{i=1}^{n}w_{i}\\bar{R}^{i}&=\\rho,\\\\ \\sum_{i=1}^{n}w_{i}&=1.\\end{split}} Example 3.4.1. Let us consider a model with two risky assets. The expected returns, variance and covariances of the risky assets are assumed to be \\displaystyle\\overline{R}^{1}=1,\\overline{R}^{2}=0.90, \\displaystyle Var(R^{1})=0.10, \\displaystyle Var(R^{2})=0.15, \\displaystyle Cov(R^{1},R^{2})=-0.1. Let us assume we want our portfolio to have a return of \\rho=0.956 . The Lagrangian for this problem therefore looks like \\mathcal{L}(w_{1},w_{2},\\lambda_{1},\\lambda_{2})=0.1w^{2}_{1}+0.15w_{2}^{2}-0.% 2w_{1}w_{2}-\\lambda_{1}(w_{1}+0.9w_{2}-0.956)-\\lambda_{2}(w_{1}+w_{2}-1). Setting the partial derivatives of \\mathcal{L} equal to zero we obtain \\displaystyle 0 \\displaystyle= \\displaystyle 0.2w_{1}-0.2w_{2}-\\lambda_{1}-\\lambda_{2} \\displaystyle 0 \\displaystyle= \\displaystyle 0.3w_{2}-0.2w_{1}-0.9\\lambda_{1}-\\lambda_{2} \\displaystyle 0 \\displaystyle= \\displaystyle w_{1}+0.9w_{2}-0.956 \\displaystyle 0 \\displaystyle= \\displaystyle w_{1}+w_{2}-1. Solving this system, we get w_{1}=0.56 and w_{2}=0.44 (we don’t really care about the values \\lambda_{1} and \\lambda_{2} beyond needing them to solve the system). This result is very interesting. From a naive point of view one would expect that all investments into the risky assets go into the first asset, since it has both a higher expected return and a lower variance. The reason why it is not so is that there is a negative correlation between the two assets. This is no cheating: the variance of this optimal portfolio is equal to: 0.1\\cdot(0.56)^{2}+0.15\\cdot(0.44)^{2}-0.2\\cdot 0.56\\cdot 0.44=0.0112 We now reintroduce the risk-free asset (money market account) to our discussion and allow our investor to build their portfolio using it as well. Recall that we write w_{0} for the weight of the risk-free asset and that \\bar{R}^{0}=r . We also still require that our portfolio weights add up to 1, including now also the weight w_{0} . At first glance you might think that adding the risk-free asset doesn’t really change anything, we can just add an additional asset into the mean-standard diagram and proceed as before. In principle this is true, but the risk-free asset has certain properties that are not shared with the remaining assets. First of all, its variance is 0 , so it lies on the very left side of the diagram. More importantly however, the risk-free asset has covariance 0 with all other assets, which follows from the simple property that \\mathbb{E}((R^{i}-\\bar{R}^{i})(R^{0}-\\bar{R}^{0}))=\\mathbb{E}((R^{i}-\\bar{R}^{% i})(r-r))=0. Suppose now that we try building a portfolio using only the i -th asset and the risk-free asset. A quick calculation tells us that the expected return of this portfolio equals \\bar{R}=w_{0}r+(1-w_{0})\\bar{R}^{i} and its standard deviation is (due to the variance and covariance including the asset 0 being 0 ) equal to \\sigma=(1-w_{0})\\sigma_{i}. These equations show that both the mean and the standard deviation of the portfolio change linearly with w_{0} . This means that on the mean-standard deviation diagram, the portfolio traces a straight line. This same observation is also true if instead of using a single risky asset we use a combination of them (as long as the weights add up to 1 ). This results in a drastic change to how the feasible region ends up looking, since any portfolio in the feasible region (that is, satisfying \\sum_{i=1}^{n}w_{i}=1 ) can be combined with the risk-free asset in this way, tracing a straight line between the risk-free asset and the portfolio. The resulting new feasible region can be seen in Figure 10. Left: If only lending of the risk-free asset is allowed ( Figure 10. Left: If only lending of the risk-free asset is allowed ( w_{0}\\geq 0 ), the region will have a triangular front end, but will curve for larger \\sigma . Right: If both borrowing and lending of the risk-free asset are allowed, a complete infinite triangular region is obtained. Just like before, a rational investor will only end up investing in portfolios that lie on the efficient frontier, which in this case is a straight line going through the point (r,0) and a very specific point on the efficient frontier that we would have obtained without the risk-free asset. This point represents a very specific portfolio called the market portfolio. How can we find this portfolio? We begin by first solving the optimal portfolio problem with a risk-free asset for some arbitrary desired return \\rho , which can be stated as \\boxed{\\begin{split}\\text{minimise}\\quad&\\frac{1}{2}\\sum_{i,j=1}^{n}w_{i}w_{j}% \\sigma_{ij}\\\\ \\text{subject to}\\quad&\\sum_{i=0}^{n}w_{i}\\bar{R}^{i}=\\rho\\\\ &\\sum_{i=0}^{n}w_{i}=1.\\end{split}} Notice that this is the same problem we have already seen before, with the only difference coming for the fact that the two sums in the condition start at i=0 instead of i=1 , so we know how to solve this by using the method of Lagrange multipliers. Just like before, after setting up the Lagrangian and taking the n+3 partial derivatives (we have added w_{0} , so there is one more variable to work with) we are left with n+3 equations for n+3 unknowns of the form \\boxed{\\begin{split}\\sum_{j=1}^{n}\\sigma_{ij}w_{j}-\\lambda_{1}\\bar{R}^{i}-% \\lambda_{2}&=0,\\quad i=0,\\dots,n,\\\\ \\sum_{i=0}^{n}w_{i}\\bar{R}^{i}&=\\rho,\\\\ \\sum_{i=0}^{n}w_{i}&=1.\\end{split}} where the additional equation corresponds to the first equation with i=0 . Notice that in that case, all of the \\sigma_{ij}=0 , so the equation simplifies to -\\lambda_{1}r-\\lambda_{2}=0 . We now return to the question of finding the market portfolio, that is the optimal portfolio that consists only of risky assets. To find it, the following lemma will be of use. Lemma 3.4.2. Let \\hat{R} be a solution to the mean variance problem with return \\rho>r . Now let \\tilde{\\rho} be a different value for the desired expected return. Then choosing \\boxed{\\gamma=\\frac{\\tilde{\\rho}-\\rho}{r-\\rho},} the portfolio return \\tilde{R}=\\gamma r+(1-\\gamma)\\hat{R} is a solution for the mean variance problem with return \\tilde{\\rho} . Proof. Consider the portfolio \\tilde{R}=\\gamma r+(1-\\gamma)\\hat{R} , that is a portfolio with weights \\tilde{w}_{i}=(1-\\gamma)w_{i} for i=1,\\dots,n and \\tilde{w}_{0}=\\gamma+(1-\\gamma)w_{0} . Since \\gamma\\in(0,1) , the weights of this new portfolio satisfy \\sum_{i=0}^{n}\\tilde{w}_{i} , which can be quickly checked by just adding them all together. It can also be quickly verified that the expected return of this new portfolio equals \\tilde{\\rho} , again by just using the value of \\gamma and that \\mathbb{E}(\\hat{R})=\\rho and \\mathbb{E}(R^{0})=r . It remains to verify that the new portfolio still minimises the variance among all portfolios satisfying the above two conditions. This however follows directly from the observation that \\displaystyle\\operatorname{Var}(\\tilde{R}) \\displaystyle=\\operatorname{Var}(\\gamma r+(1-\\gamma)\\hat{R}) \\displaystyle=(1-\\gamma)^{2}\\operatorname{Var}(\\hat{R}), and since \\hat{R} minimises the right-hand side, \\tilde{R} has to minimise the left-hand side. ∎ Using Lemma 3.4.2 we can now easily find the market portfolio. We do this by setting \\gamma in such a way that the resulting weight \\tilde{w}_{0} equals 0 . Since we have seen in the proof of the lemma that \\tilde{w}_{i}=(1-\\gamma)w_{i} , this means choosing \\gamma so that (1-\\gamma)\\sum_{i=1}^{n}w_{i}=1 or equivalently \\gamma=1-1/\\sum_{i=1}^{n}w_{i} . The important consequence of Lemma 3.4.2 is that one has to solve the mean variance portfolio problem only for one parameter \\rho and one gets solutions for all other parameters by investing according to a combination of the money market account and this fixed solution of the mean variance problem. This is the so-called the mutual fund principle. Proposition 3.4.3. (Mutual Fund Principle) Suppose we fix a portfolio whose return is a solution to the mean variance portfolio problem corresponding to some mean return \\rho . Then the solution to the mean variance problem for any other mean return is obtained by a portfolio consisting of investments in the riskless money market account and the fixed portfolio. The mutual-fund principle in action. Every minimum variance portfolio is a combination of the market portfolio and the riskless asset. Figure 11. The mutual-fund principle in action. Every minimum variance portfolio is a combination of the market portfolio and the riskless asset. The mutual fund principle has the following consequence. Suppose that everyone is a mean-variance optimiser as described above and that everyone agrees on the probabilistic structure, i.e. associates the same subjective probabilities to the states of the world (has the same objective measure \\mathbb{P} ). Then every agent can solve his individual mean-variance problem by investing in a single fixed asset, the mutual fund from above, and the money market account. The fraction of money invested/shorted in the mutual fund and the fraction of the money invested/borrowed in the money market account depend on the agents parameters, as in Lemma 3.4.2, but effectively, everyone buys the same fund. The question is, what is that fund? This question is easy to answer. It is clear that the total investment, i.e. the sum of all investments of all agents must add up to the market portfolio, that is the totality of all shares of all stocks traded on the market. Now if all agents invest into the same risky fund, then this risky fund can only be the market portfolio. Previous page Next page"],[["index.html","Ptx1.html"],"Extra reading (non-examinable) ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. Extra reading (non-examinable) Extra reading (non-examinable) 4. Investment in Multi-Period Market Models 4.1. Optimal Portfolios in a Multi-Period Market Model In this section we consider the problem of utility maximization as in Section 3.1, but this time the underlying model is a multi period model. We shall see that the ideas and methods to solve this problem resemble those from Section 3.1 to a great extent. We will however face difficulties imposed by the dynamic character of multi period investment. Let us first recall the problem: find a trading strategy that performs optimal under a performance measure which is built up by taking expected utility of terminal wealth. More mathematically: Definition 4.1.1. A trading strategy \\phi^{*}=(\\phi^{*}_{t})_{0\\leq t\\leq T}\\in\\mathcal{T} in a multi period market model with time horizon [0,T] is called a solution for the optimal portfolio problem with initial investment x and utility function u if (1)​ V_{0}(\\phi^{*})=x . (2)​ \\displaystyle\\mathbb{E}(u(V_{T}(\\phi^{*}))=\\max\\big{\\{}\\mathbb{E}(u(V_{T}(\\phi% )):\\phi\\in\\mathcal{T}\\text{ and }V_{0}(\\phi)=x\\big{\\}}. As in the single period market models, it is not clear whether a solution for the optimal portfolio problem in a specific model exists. However, the existence of a solution implies that the market is arbitrage free and a specific risk neutral measure can be obtained similar to Proposition 3.1.4. The computation of a solution of an optimal portfolio problem can be performed by generalization of each of two techniques considered in Section 3.1. Firstly, we can write maximise \\displaystyle\\mathbb{E}(u(V_{T}(\\phi)) subject to \\displaystyle V_{0}(\\phi)=x \\displaystyle\\phi\\in\\mathcal{T} Recall that \\mathcal{T} consists of all trading strategies that are self-financing and adapted. This constraint can be represented as a system of linear equalities, as well as the constraint V_{0}(\\phi)=x . Therefore, we can apply standard techniques from multidimensional calculus. This proved to be computationally difficult in the single period framework. Here, due to a great number of constraints, it is even less practical. Apparently, the two-step approach works far better: ​Step 1: Compute the maximiser V_{T} of the function V\\mapsto\\mathbb{E}u(V) defined for certain feasible random variables V ​Step 2: Compute a trading strategy \\phi\\in\\mathcal{T} which has the maximiser V_{T} computed in step 1 as value at time T , i.e. V_{T}(\\phi)=V_{T} . Step 2 is again a replication problem, which we can solved by methods developed in Example 2.2.3. Regarding the first step, by virtue of Proposition 2.4.3 for every self financing and adapted trading strategy \\phi=(\\phi_{t})_{0\\leq t\\leq T} and for every risk neutral measure \\mathbb{Q} we have V_{0}(\\phi)=\\hat{V}_{0}(\\phi)=\\mathbb{E}_{\\mathbb{Q}}(\\hat{V}_{T}(\\phi)). Assume that the multi period market model we are considering is complete. In this case there is only one risk neutral measure and the feasible set consists of all random variables W such that \\mathbb{E}_{\\mathcal{Q}}\\frac{W}{B_{T}}=x . Indeed, if W is in this set then there exists a trading strategy with the initial investment x that replicates W (Step 2 can be carried out). Therefore, first step in our optimal portfolio problem is to solve maximise \\displaystyle\\mathbb{E}(u(W)) subject to \\displaystyle\\mathbb{E}_{\\mathbb{Q}}\\left(\\frac{1}{B_{T}}W\\right)=x. If the market is not complete then in precisely the same way as in Section 3.1 one has to find a finite number of measures \\mathbb{Q}_{j} , j=1,\\ldots,J , which generate the feasible set of wealths by \\mathbb{E}_{\\mathbb{Q}_{j}}\\frac{W}{B_{T}}=x,\\qquad j=1,\\ldots,J. Next to these two methods, which are basically the same as in the single period market case, there is a third method to solve the optimal portfolio problem in a multi period market model. This method however does not work for itself, but depends on a technique to solve the optimal portfolio problem for a single period model, which could be either of the two techniques above. This new technique is called the dynamic programming principle. Its real strength will be particularly well visible in the continuous time framework, where the dynamic programming technique is used to set up a partial differential equation, which is used to compute a solution of the optimal portfolio problem by means of standard methods from partial differential equations. In the discrete time framework the dynamic programming principle can be formulated as follows: denote with U_{t}(x) the optimal expected utility from terminal wealth, which can be achieved, if the wealth at time t were equal to x , i.e. U_{t}(x)=\\max\\Big{\\{}\\mathbb{E}\\big{(}u(V_{T}(\\phi))\\big{)}:\\phi\\in\\mathcal{T}% \\mbox{ and }V_{t}(\\phi)=x\\Big{\\}}. Clearly, the value U_{t}(x) does not depend on anything which happened before time t , but only on the condition V_{t}(\\phi)=x . The problem of computing U_{t}(x) is, in fact, an optimal portfolio problem, which starts at time t instead of time 0 . U_{0}(x) is the value corresponding to our original problem and represents the value we actually want to compute. We compute this value by going backward from time t=T to time t=0 . Clearly we have U_{T}(x)=u(x)\\mbox{ for all }x. We now come to the point where the dynamic programming principle comes into action. Assume we know the optimal value U_{t}(V_{t}) at time t for all wealth levels V_{t} at time t , and we know the corresponding trading strategies leading to these optimal values. These trading strategies obviously depend on V_{t} , but nevertheless we know precisely how to optimally invest money in the market given that the wealth at time t is V_{t} . How about our investment at time t-1 ? These investments, starting with a wealth V_{t-1} then necessarily lead to some wealth V_{t} at time t and we would therefore be foolish, not to combine these investments with the optimal trading strategy starting at time t with the same V_{t} as its wealth. The step from t-1 to t is in fact nothing else than a single period model. Using the self financing condition, the wealth at time t induced by an investment \\phi_{t-1} corresponding to wealth V_{t-1} at time t-1 is given by \\displaystyle V_{t} \\displaystyle= \\displaystyle\\left(V_{t-1}-\\sum_{i=1}^{n}\\phi_{t-1}^{i}S_{t-1}^{i}\\right)(1+r)% +\\sum_{i=1}^{n}\\phi_{t-1}^{i}S_{t}^{i} \\displaystyle= \\displaystyle V_{t-1}(1+r)+\\sum_{i=1}^{n}\\phi_{t-1}^{i}\\Delta S_{t}^{i} We should therefore choose our investment \\phi_{t-1} at time t-1 in order to maximise the expected value of U_{t}(V_{t}) , and then follow the optimal strategy from time t starting with V_{t} . Mathematically this idea is expressed in the dynamic programming functional equation: \\boxed{\\displaystyle U_{t}(x)=\\max_{\\phi_{t}\\in\\mathcal{F}_{t}}\\mathbb{E}\\left% (U_{t+1}\\bigg{(}x(1+r)+\\sum_{i=1}^{n}\\phi_{t}^{i}\\Delta S_{t+1}^{i}\\bigg{)}% \\bigg{|}\\mathcal{F}_{t}\\right).} Here \\phi_{t}\\in\\mathcal{F}_{t} refers to the condition that the \\phi_{t} as an investment choice at time t must be \\mathcal{F}_{t} measurable. As already indicated the functional programming equation can now be used to compute the value U_{0}(x) backwards starting from U_{T}(x)=u(x) , where in each step t\\mapsto t-1 an optimal portfolio problem in a single period market model has to be solved. Previous page Next page"],[["index.html","Ptx2.html"],"Literature list ‣ Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. Literature list Literature list References [1] Pliska, S. R.: Introduction to Mathematical Finance - Discrete Time Models, Blackwell, 1997. [2] Shreve, S. E.: Stochastic Calculus for Finance I: The Binomial Asset Pricing Model, Springer, 2004. [3] Elliott R. J. and Kopp, P. E.: Mathematics of Financial Markets, Springer, 1999. [4] Luenberger D. G.: Investment Science, Oxford University Press, 1998. Previous page"],[["index.html"],"Lecture notes: Discrete Time Finance (MATH5320M)","Skip to content. Lecture notes: Discrete Time Finance (MATH5320M) Lecture notes: Discrete Time Finance (MATH5320M) Peter Gracar, School of Mathematics, University of Leeds Date: December 3, 2024 Abstract. Financial investments such as stocks, options and futures are risky: their prices can go down as well as up. This module will develop the necessary mathematical tools and models of financial markets to enable investors to value such assets. After completing the module, the student will know how to calculate the right discount rate to compensate for the risk of a financial instrument. To participate in live polls, contribute questions and view live results access Vevox from your web browser https://vevox.app. Session ID: 158-802-413. Next page"]]