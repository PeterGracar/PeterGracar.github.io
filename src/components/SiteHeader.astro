---
import { navigation } from '@data/navigation';

interface Props {
  pathname: string;
}

const { pathname } = Astro.props;

const normalizePath = (value: string) => {
  const withoutTrailing = value.replace(/\/$/, '');
  const withoutIndex = withoutTrailing.replace(/\/index\.html$/, '');
  const withoutHtml = withoutIndex.replace(/\.html$/, '');
  return withoutHtml === '' ? '/' : withoutHtml;
};

const currentPath = normalizePath(pathname);
---

<header class="site-header">
  <div class="banner" role="presentation">
    <div class="banner__inner content-shell">
      <p class="banner__name">Peter Gracar</p>
      <p class="banner__subtitle">Probability, random graphs, and percolation theory</p>
    </div>
  </div>
  <nav class="site-nav" aria-label="Primary">
    <ul class="site-nav__list content-shell">
      {
        navigation.map((item) => {
          const itemPath = normalizePath(item.href);
          const isActive = itemPath === '/' ? currentPath === '/' : currentPath === itemPath;

          return (
            <li>
              <a href={item.href} aria-current={isActive ? 'page' : undefined}>
                {item.label}
              </a>
            </li>
          );
        })
      }
    </ul>
  </nav>
</header>
